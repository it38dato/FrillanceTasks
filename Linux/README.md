<p>Services:<br># Администрирование локальных серверов.<br># Администрирование Веб-серверов.<br># Администрирование баз данных.<br># Interview.<br><strong>Task:</strong><br>Принцип работы SElinux<br># Interview.<br><strong>Decision:</strong><br>SELinux расширяет возможности стандартной системы безопасности (на основе прав доступа к файлам). Она позволяет ограничить доступ процессу, который запускается от имени пользователя, у которого прав больше, чем нужно данному процессу. Чтобы понять наглядно принцип работы SELinux, рассмотрим контекст безопасности — сочетание сущности, роли, домена и категории (не обязательно).<br><strong>Task:</strong><br>Чем приватный отличается от публичного ключа?<br># Interview.<br><strong>Decision:</strong><br>Мы можем сгенерировать два ключа - приватный и публичный. После чего закинуть публичный ключ на все свои сервера и подключаться к ним без пароля, используя приватный ключ. Это говорит о том, что приватный ключ нужно беречь.<br>Админ закидывает публичный ключ на сервера, в домашнюю директорию пользователей, к которым будет подключаться. И при следующем подключении демон ssh увидит наличие подходящего ключа у пользователя и аутентифицирует его.<br><strong>Task:</strong><br>Как сгенерировать ssh ключа?<br># Interview.<br><strong>Decision:</strong><br>Для начала нужно сгенерировать ключи, это делается на стороне клиента, т.е. у администратора. Для генерации ключей используется команда ssh-keygen. По умолчанию ключи и в целом настройки клиента ssh хранятся в домашней директории пользователя, в скрытой директории .ssh. А ключи, по умолчанию, называются id_rsa. По хорошему, когда у нас много серверов, мы можем создать различные ключи и для подключения к разным серверам использовать разные ключи. Тут нажмём enter, чтобы использовать название по умолчанию. Дальше у нас спрашивается пароль для ключа. Так как ssh ключи позволяют заходить на сервера без пароля, они могут быть очень опасны, если попадут в руки злоумышленникам. Поэтому мы можем защитить приватные ключи паролем. При использовании ключа нам нужно будет вводить пароль от ключа, но, если у нас украдут этот ключ, без пароля хакеры ничего не сделают. Для нашего примера мы не будем использовать пароль, чтобы было нагляднее. Поэтому нажимаем два раза Enter и ключ создаётся. Мы видим, что создались два файла - id_rsa и id_rsa.pub - приватный и публичный ключ соответственно. Также внизу есть эдакая картинка, визуализирующая ключ. На самом деле это больше нужно для ключей хоста - вы можете настроить так, чтобы при подключении к серверам вы видели ключ хоста в таком виде. Если вдруг ключ хоста изменится или кто-то встанет посреди трафика, ключ будет другой и визуально вы сразу заметите разницу.<br>У нас есть ключи, теперь мы можем закинуть наш публичный ключ на какой-нибудь сервер и проверить. Используем эту же виртуалку и пользователя root. Самый простой способ закинуть ключ - команда ssh-copy-id.<br>Если не использовать никакие опции, она найдёт дефолтный ключ id_rsa.pub и закинет его. При этом, чтобы закинуть ключ, ssh подключается на этот сервер к пользователю, поэтому он попросит пароль пользователя. После чего добавит ключ и предложит нам проверить.<br>На этот раз никакого пароля не потребовалось, мы можем аутентифицироваться по ключу.<br>Посмотрим появившиеся файлы, для начала у клиента. В директории .ssh у нас 3 файла - два ключа и файл known_hosts.<br>Ключи представляют из себя текстовые файлы с непонятным набором символов. А в файле known_hosts указаны адреса, к которым мы подключались, а также отпечатки их ключей. Именно по этому файлу наш клиент будет понимать, изменились ли у сервера ключи или нет.<br>На сервере, в домашней директории пользователя, к которому я закинул ключ, также появилась директория .ssh с файлом authorized_keys<br>В этот файл будут попадать публичные ключи пользователей, т.е. это результат команды ssh-copy-id. На самом деле, хоть и не понятно в терминале, в этом файле сейчас одна строчка с одним ключом. Этот тот же id_rsa.pub. Если кто-то ещё добавит ключ, то он будет на второй строчке, т.е. один ключ - одна строчка.<br><strong>Task:</strong><br>Есть консольная программа для Linux, которая должна вывести результат работы в терминал. Но после запуска никакого вывода не происходит и вы снова видите системное приглашение консоли. Перечислите порядок действий для выявления причин и инструменты, которыми воспользуетесь для решения данной проблемы.<br># Interview.<br><strong>Decision:</strong><br>Если код закрыт, то надо перенаправить весь вывод на стандартный. перенаправление потока ошибок stderr на стандартный вывод stdout.<br>А если открыт, то уже смотреть по самому коду скрипта или исполняемого файла. Проверить штатность поведения - код возврата. если не 0, то посмотрел бы в dmesg на предмет segfault. Может оно просто тихо падает. Потом попробовал бы почитать man, запустил бы с ключом --help или -h. Исключив segfault, запустил бы её через strace, чтобы посмотреть, что она вообще пытается сделать.<br><strong>Task:</strong><br>выполнить подключение к удаленной БД с помощью инструмента администрирования<br># Администрирование баз данных.<br><strong>Decision:</strong><br>root@kvmubuntu:~# mysql -host=ubuntu-VirtualBox<br><strong>Task:</strong><br>Переименовать пользователя для корректного подключения с базой.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# usermod -l Tuser tuser<br>root@kvmubuntu:~# groupmod -n Tuser tuser<br><strong>Source:</strong><br># https://itsecforu.ru/2020/04/29/%F0%9F%90%A7-%D0%BA%D0%B0%D0%BA-%D0%BF%D0%B5%D1%80%D0%B5%D0%B8%D0%BC%D0%B5%D0%BD%D0%BE%D0%B2%D0%B0%D1%82%D1%8C-%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F-%D0%B2-linux/ - Изменить имя пользователя на Linux.<br><strong>Task:</strong><br>Установить dbeaver.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# wget https://dbeaver.io/files/dbeaver-ce_latest_amd64.deb<br>root@kvmubuntu:~# apt install ./dbeaver-ce_latest_amd64.deb<br><strong>Task:</strong><br>Рассмотрим легкий способ анонимной и конфиденциальной переписки на основе i2p + XMPP (протокол обмена сообщениями). Мы создаем свой XMPP сервер на нашем localhost и кинем все его хосты внутри сети i2p, который выделит нам криптографический адрес, по которому наш собеседник может вступить с нами в контакт.<br>- Всю реализацию буду делать внутри виртуальной машины. Cначала установим сервис i2p.<br>- Узнаем какой у нас будет криптографический адрес через браузер 127.0.0.1:7070. это и будет домен для вашего XMPP сервера, его надо будет сохранить.<br>- Устанавливаем сервер XMPP под cвою ОС.<br>- Устанавливаем lua библиотеку bit32.<br>Устанавливаем модуль mod_darknet в директорию модулей prosody.<br>- Замените xxx.b32.i2p на свой адрес, который мы сохраняли ранее.<br>- Генерируем сертификаты шифрования всталяя теже значения домена, которые мы сохраняли ранее<br>- Добавляем админский аккаунт<br>- Теперь мы можем законектиться к нашему серверу через pidgin-клиент. Если вы подключаетесь локально к серверу, то в настройках клиента указываем подключение к серверу 127.0.0.1 порт 5222. Если подключаетесь к серверу удаленно через I2P, то указывайте в настройках прокси Socks5 127.0.0.1:4447 При подключении нас предупредят, сертификаты шифрования самописные, так как мы сами их сгенерировали. Теперь мы можем подлючить второго собеседника через вторую виртуальную машину. Также на ней установим шлюз i2p, который будет являться нашим локальным прокси i2p.<br>- Вернемся в первую машину и создадим для нашего собеседника аккаунт на сервере<br>- Во второй машине проверяем - Указываем тут домен нашего сервера, порт 5222, укажем, что трафик должен идти через прокси типа SOCKS 5, который находится на localhost 127.0.0.1, порт - 4447. При подключении нас также предупредят,что сертификаты шифрования самописные, если все сделали правильно. Остается только запросить авторизацию наших собеседников для того, чтобы создать чат.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# add-apt-repository ppa:purplei2p/i2pd<br>root@kvmubuntu:~# apt-get update<br>root@kvmubuntu:~# apt-get install i2pd<br>[root@kvmcentos ~]# curl -s https://copr.fedorainfracloud.org/coprs/r4sas/miniupnpc/repo/epel-8/r4sas-miniupnpc-epel-8.repo -o /etc/yum.repos.d/miniupnpc-epel-8.repo<br>[root@kvmcentos ~]# curl -s https://copr.fedorainfracloud.org/coprs/supervillain/i2pd/repo/epel-8/supervillain-i2pd-epel-8.repo -o /etc/yum.repos.d/i2pd-epel-8.repo<br>[root@kvmcentos ~]# yum install epel-release -y<br>[root@kvmcentos ~]# yum install i2pd -y<br>[root@kvmcentos ~]# systemctl enable i2pd<br>[root@kvmcentos ~]# systemctl start i2pd<br>[root@kvmcentos ~]# find / -name tunnels.conf<br>&nbsp;&nbsp;  find: ‘/run/user/1000/gvfs’: Permission denied<br>&nbsp;&nbsp;  /etc/i2pd/tunnels.conf<br>&nbsp;&nbsp;  /usr/share/doc/i2pd/tunnels.conf<br>[root@kvmcentos ~]# cat /etc/i2pd/tunnels.conf<br>&nbsp;&nbsp;[IRC-IRC2P]<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;#[IRC-ILITA]<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;#[SMTP]<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;#[POP3]<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;# see more examples at https://i2pd.readthedocs.io/en/latest/user-guide/tunnels/<br>[root@kvmcentos ~]# vim /etc/i2pd/tunnels.conf<br>[root@kvmcentos ~]# cat /etc/i2pd/tunnels.conf<br>&nbsp;&nbsp;[IRC-IRC2P]<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;#[IRC-ILITA]<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;#[SMTP]<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;#[POP3]<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;# see more examples at https://i2pd.readthedocs.io/en/latest/user-guide/tunnels/<br>&nbsp;&nbsp;  [prosody-s2s]<br>&nbsp;&nbsp;  type=server<br>&nbsp;&nbsp;  host=127.0.0.1<br>&nbsp;&nbsp;  port=5269<br>&nbsp;&nbsp;  inport=5269<br>&nbsp;&nbsp;  keys=prosody.dat<br>&nbsp;&nbsp;  [prosody-c2s]<br>&nbsp;&nbsp;  type=server<br>&nbsp;&nbsp;  host=127.0.0.1<br>&nbsp;&nbsp;  port=5222<br>&nbsp;&nbsp;  inport=5222<br>&nbsp;&nbsp;  keys=prosody.dat<br>[root@kvmcentos ~]# systemctl restart i2pd<br>[root@kvmcentos ~]# yum list | grep prosody<br>&nbsp;&nbsp;  prosody.x86_64&nbsp;&nbsp;&nbsp;&nbsp; 0.11.5-1.el8&nbsp;&nbsp;   epel<br>[root@kvmcentos ~]# yum list | grep lua-fi<br>&nbsp;&nbsp;  lua-fifo.noarch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   0.2-2.el8&nbsp;&nbsp;&nbsp;&nbsp;   epel<br>[root@kvmcentos ~]# rpm -i http://mirror.C.org/C/8/PowerTools/x86_64/os/Packages/lua-filesystem-1.6.3-7.el8.x86_64.rpm<br>[root@kvmcentos ~]# yum list | grep lua-fi<br>&nbsp;&nbsp;  lua-filesystem.x86_64&nbsp;&nbsp;&nbsp;&nbsp; 1.6.3-7.el8&nbsp;&nbsp;&nbsp;&nbsp; @System&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>&nbsp;&nbsp;  lua-fifo.noarch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   0.2-2.el8&nbsp;&nbsp;&nbsp;&nbsp;   epel<br>[root@kvmcentos ~]# yum install prosody -y<br>[root@kvmcentos ~]# yum list | grep lua<br>&nbsp;&nbsp;&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;&nbsp;&nbsp;  lua5.1-basexx.noarch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.4.0-2.el8 epel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;  lua5.1-binaryheap.noarch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.4-1.el8 epel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;  lua5.1-bitop.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  1.0.2-5.el8 epel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;  lua5.1-compat53.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   0.7-3.el8 epel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;  lua5.1-cqueues.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20190813-3.el8 epel<br>&nbsp;&nbsp;&nbsp;&nbsp;  lua5.1-fifo.noarch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   0.2-2.el8 epel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;  lua5.1-http.noarch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   0.3-5.el8 epel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;  lua5.1-lpeg.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   1.0.2-1.el8 epel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;  lua5.1-lpeg-patterns.noarch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  0.5-4.el8 epel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;  lua5.1-luaossl.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20190731-1.el8 epel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  lua5.1-luv.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.36.0.0-1.el8 epel<br>&nbsp;&nbsp;&nbsp;&nbsp;  lua5.1-luv-devel.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  1.36.0.0-1.el8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;epel<br>&nbsp;&nbsp;&nbsp;&nbsp;  lua5.1-mmdb.noarch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   0.2-2.el8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; epel&nbsp;&nbsp;lua5.1-mpack.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  1.0.8-3.el8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   epel   <br>&nbsp;&nbsp;&nbsp;&nbsp;  ...<br>[root@kvmcentos ~]# yum install lua5.1-basexx lua5.1-binaryheap lua5.1-compat53 lua5.1-bitop lua5.1-cqueues lua5.1-fifo lua5.1-http lua5.1-lpeg lua5.1-lpeg-patterns lua5.1-luaossl lua5.1-luv lua5.1-luv-devel lua5.1-mmdb lua5.1-mpack -y<br>[root@kvmcentos ~]# find / -name modules<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  /usr/lib64/prosody/modules<br>&nbsp;&nbsp;  ...<br>[root@kvmcentos ~]# cd /usr/lib64/prosody/modules<br>[root@kvmcentos ~]# wget https://raw.githubusercontent.com/majestrate/mod_darknet/master/mod_darknet.lua<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  -rw-r--r--. 1 root root 8478 июн 6 02:57 mod_darknet.lua<br>&nbsp;&nbsp;  ...<br>[root@kvmcentos ~]# vim /etc/prosody/prosody.cfg.lua<br>[root@kvmcentos ~]# cat /etc/prosody/prosody.cfg.lua<br>&nbsp;&nbsp;  interfaces = { "127.0.0.1" };<br>&nbsp;&nbsp;  admins = { "admin@xxx.b32.i2p" };<br>&nbsp;&nbsp;  modules_enabled = {<br>&nbsp;&nbsp;&nbsp;&nbsp;  "roster"; "saslauth"; "tls"; "dialback"; "disco"; "posix"; "private"; "vcard";  "ping";  "register"; "admin_adhoc"; "darknet";<br>&nbsp;&nbsp;  };<br>&nbsp;&nbsp;  modules_disabled = {};<br>&nbsp;&nbsp;  allow_registration = false;<br>&nbsp;&nbsp;  darknet_only = true;<br>&nbsp;&nbsp;  c2s_require_encryption = true;<br>&nbsp;&nbsp;  s2s_secure_auth = false;<br>&nbsp;&nbsp;  authentication = "internal_plain";<br>&nbsp;&nbsp;  -- On Debian/Ubuntu<br>&nbsp;&nbsp;  daemonize = true;<br>&nbsp;&nbsp;  pidfile = "/var/run/prosody/prosody.pid";<br>&nbsp;&nbsp;  log = {<br>&nbsp;&nbsp;&nbsp;&nbsp;  error = "/var/log/prosody/prosody.err";<br>&nbsp;&nbsp;&nbsp;&nbsp;  "*syslog";<br>&nbsp;&nbsp;  }<br>&nbsp;&nbsp;  certificates = "certs";<br>&nbsp;&nbsp;  VirtualHost "xxx.b32.i2p";<br>&nbsp;&nbsp;  ssl = {<br>&nbsp;&nbsp;&nbsp;&nbsp;  key = "/etc/prosody/certs/xxx.b32.i2p.key";<br>&nbsp;&nbsp;&nbsp;&nbsp;  certificate = "/etc/prosody/certs/xxx.b32.i2p.crt";<br>&nbsp;&nbsp;  }<br>root@kvmubuntu:~# openssl genrsa -out /etc/prosody/certs/xxx.b32.i2p.key 2048<br>&nbsp;&nbsp;  Generating RSA private key, 2048 bit long modulus (2 primes)<br>&nbsp;&nbsp;  ......................+++++<br>&nbsp;&nbsp;  ....+++++<br>&nbsp;&nbsp;  e is 65537 (0x010001)<br>root@kvmubuntu:~# openssl req -new -x509 -key /etc/prosody/certs/xxx.b32.i2p.key -out /etc/prosody/certs/xxx.b32.i2p.crt -days 3650<br>&nbsp;&nbsp;  You are about to be asked to enter information that will be incorporated<br>&nbsp;&nbsp;  into your certificate request.<br>&nbsp;&nbsp;  What you are about to enter is what is called a Distinguished Name or a DN.<br>&nbsp;&nbsp;  There are quite a few fields but you can leave some blank<br>&nbsp;&nbsp;  For some fields there will be a default value,<br>&nbsp;&nbsp;  If you enter '.', the field will be left blank.<br>&nbsp;&nbsp;  -----<br>&nbsp;&nbsp;  Country Name (2 letter code) [XX]:<br>&nbsp;&nbsp;  State or Province Name (full name) []:<br>&nbsp;&nbsp;  Locality Name (eg, city) [Default City]:<br>&nbsp;&nbsp;  Organization Name (eg, company) [Default Company Ltd]:<br>&nbsp;&nbsp;  Organizational Unit Name (eg, section) []:<br>&nbsp;&nbsp;  Common Name (eg, your name or your server's hostname) []:<br>&nbsp;&nbsp;  Email Address []:<br>root@kvmubuntu:~# chown root:prosody /etc/prosody/certs/*.b32.i2p.{key,crt}<br>root@kvmubuntu:~# chmod 640 /etc/prosody/certs/*.b32.i2p.{key,crt}<br>root@kvmubuntu:~# systemctl enable prosody<br>root@kvmubuntu:~# systemctl start prosody<br>root@kvmubuntu:~# prosodyctl adduser admin@xxx.b32.i2p<br>root@kvmubuntu:~# add-apt-repository ppa:purplei2p/i2pd<br>root@kvmubuntu:~#apt-get update<br>root@kvmubuntu:~# apt-get install -y i2pd<br>root@kvmubuntu:~## apt-get install -y pidgin<br>[root@kvmcentos ~]# prosodyctl adduser C@xxx.b32.i2p<br><strong>Source:</strong><br># https://www.youtube.com/playlist?list=PLLqKATfceKNsptsrNP63TukGKETztvf1r<br><strong>Task:</strong><br>Система безопасности PAM. Конфигурационные файлы для различных программ находятся в /etc/pam.d/.<br>- выяснить, какие модули PAM присутствуют в системе.<br>- Запретим пользователю user1 с сервера с IP 192.168.0.20 подключаться по SSH к нашему серверу. В конце файла /etc/security/access.conf вписываем такую строку: - : user1 : 192.168.0.20. Узнать IP можно с помощью ifconfig.<br>- Теперь пользователь user1 не сможет подключиться к нашему серверу по SSH. В файле access.conf также есть много других примеров, которые можно использовать в своей ситуации. проверить подключение на другом компе.  Чтобы разрешить это, можно просто закомментить строку в файле.<br>- С помощью pam_limits.so для пользователя user1 сделаем следующие ограничения: максимальный размер файла – 20 Мб; приоритет для пользовательских процессов – 15. Строки в конце файла /etc/security/limits.conf: user1 hard fsize 20000; user1 hard priority 15.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# ls /etc/pam.d<br>&nbsp;&nbsp;  atd gdm-launch-environment polkit-1 sudo-i<br>&nbsp;&nbsp;  chfn gdm-password postlogin su-l<br>&nbsp;&nbsp;  chsh gdm-pin remote system-auth<br>&nbsp;&nbsp;  cockpit gdm-smartcard runuser systemd-user<br>&nbsp;&nbsp;  config-util liveinst runuser-l vlock<br>&nbsp;&nbsp;  crond login smartcard-auth vmtoolsd<br>&nbsp;&nbsp;  cups other sshd xserver<br>&nbsp;&nbsp;  fingerprint-auth passwd sssd-shadowutils<br>&nbsp;&nbsp;  gdm-autologin password-auth su<br>&nbsp;&nbsp;  gdm-fingerprint pluto sudo<br>[root@kvmcentos ~]# find / -name pam_*.so<br>&nbsp;&nbsp;  /usr/lib64/security/pam_cap.so<br>&nbsp;&nbsp;  /usr/lib64/security/pam_warn.so<br>&nbsp;&nbsp;  /usr/lib64/security/pam_pwquality.so<br>&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;  /usr/lib64/security/pam_gnome_keyring.so<br>&nbsp;&nbsp;  /usr/lib64/security/pam_gdm.so<br>&nbsp;&nbsp;  /opt/VBoxGuestAdditions-6.1.4/other/pam_vbox.so<br>[root@kvmcentos ~]# su - user1<br>[root@kvmcentos ~]# ifconfig<br>&nbsp;&nbsp;  enp0s3: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500<br>&nbsp;&nbsp;  inet 192.168.0.20 netmask 255.255.255.0 broadcast 192.168.0.255<br>&nbsp;&nbsp;  inet6 fe80::8d4f:7215:fad0:e632 prefixlen 64 scopeid 0x20&lt;link&gt;<br>&nbsp;&nbsp;  ether 08:00:27:77:a2:2c txqueuelen 1000 (Ethernet)<br>&nbsp;&nbsp;  RX packets 117668 bytes 171631130 (163.6 MiB)<br>&nbsp;&nbsp;  RX errors 0 dropped 0 overruns 0 frame 0<br>&nbsp;&nbsp;  TX packets 84899 bytes 6499625 (6.1 MiB)<br>&nbsp;&nbsp;  TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0<br>&nbsp;&nbsp;  ...<br>[root@kvmcentos ~]# exit<br>&nbsp;&nbsp;  logout<br>[root@kvmcentos ~]# vim /etc/security/access.conf<br>[root@kvmcentos ~]# cat /etc/security/access.conf<br>&nbsp;&nbsp;# Login access control table.<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;#-:ALL:ALL<br>&nbsp;&nbsp;  -:user1:192.168.0.20<br>[root@kvmcentos ~]# cat /etc/pam.d/sshd<br>&nbsp;&nbsp;#%PAM-1.0<br>&nbsp;&nbsp;  auth substack password-auth<br>&nbsp;&nbsp;  auth include postlogin<br>&nbsp;&nbsp;  account required pam_sepermit.so<br>&nbsp;&nbsp;  account required pam_nologin.so<br>&nbsp;&nbsp;  account include password-auth<br>&nbsp;&nbsp;  password include password-auth<br>&nbsp;&nbsp;# pam_selinux.so close should be the first session rule<br>&nbsp;&nbsp;  session required pam_selinux.so close<br>&nbsp;&nbsp;  session required pam_loginuid.so<br>&nbsp;&nbsp;# pam_selinux.so open should only be followed by sessions to be executed in the user context<br>&nbsp;&nbsp;  session required pam_selinux.so open env_params<br>&nbsp;&nbsp;  session required pam_namespace.so<br>&nbsp;&nbsp;  session optional pam_keyinit.so force revoke<br>&nbsp;&nbsp;  session optional pam_motd.so<br>&nbsp;&nbsp;  session include password-auth<br>&nbsp;&nbsp;  session include postlogin<br>[root@kvmcentos ~]# vim /etc/pam.d/sshd<br>[root@kvmcentos ~]# cat /etc/pam.d/sshd<br>&nbsp;&nbsp;#%PAM-1.0<br>&nbsp;&nbsp;  auth substack password-auth<br>&nbsp;&nbsp;  auth include postlogin<br>&nbsp;&nbsp;  account required pam_sepermit.so<br>&nbsp;&nbsp;  account required pam_nologin.so<br>&nbsp;&nbsp;  account required pam_access.so<br>&nbsp;&nbsp;  account include password-auth<br>&nbsp;&nbsp;  password include password-auth<br>&nbsp;&nbsp;# pam_selinux.so close should be the first session rule<br>&nbsp;&nbsp;  session required pam_selinux.so close<br>&nbsp;&nbsp;  session required pam_loginuid.so<br>&nbsp;&nbsp;# pam_selinux.so open should only be followed by sessions to be executed in the user context<br>&nbsp;&nbsp;  session required pam_selinux.so open env_params<br>&nbsp;&nbsp;  session required pam_namespace.so<br>&nbsp;&nbsp;  session optional pam_keyinit.so force revoke<br>&nbsp;&nbsp;  session optional pam_motd.so<br>&nbsp;&nbsp;  session include password-auth<br>&nbsp;&nbsp;  session include postlogin<br>[root@kvmcentos ~]# ssh user1@192.168.0.20<br>[root@kvmcentos ~]# vim /etc/security/access.conf<br>[root@kvmcentos ~]# cat /etc/security/access.conf<br>&nbsp;&nbsp;# Login access control table.<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;#-:ALL:ALL<br>&nbsp;&nbsp;#-:user1:192.168.0.20<br>[root@kvmcentos ~]# vim /etc/security/limits.conf<br>[root@kvmcentos ~]# cat /etc/security/limits.conf<br>&nbsp;&nbsp;# /etc/security/limits.conf<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;#@student - maxlogins 4<br>&nbsp;&nbsp;  user1 hard fsize 20000<br>&nbsp;&nbsp;  user1 hard priority 15<br>&nbsp;&nbsp;# End of file<br>[root@kvmcentos ~]# ssh user1@192.168.0.20<br>[root@kvmcentos ~]# ls -lh<br>&nbsp;&nbsp;  итого 0<br>[root@kvmcentos ~]# yes &gt; file.txt<br>&nbsp;&nbsp;  File size limit exceeded (стек памяти сброшен на диск)<br>[root@kvmcentos ~]# ls -lh<br>&nbsp;&nbsp;  итого 20M -rw-rw-r-- 1 user1 user1 20M мар 25 23:17 file.txt<br><strong>Task:</strong><br>Запускаем любой процесс, например, с помощью watch отслеживаем статистику программы free в реальном времени. С другой консоли посмотрим приоритет процесса watch.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# watch free<br>[root@kvmcentos ~]#ps -C watch -o ni=<br>&nbsp;&nbsp;  15<br><strong>Task:</strong><br>Шифрование gnupg.<br># Администрирование локальных серверов.<br> <strong>Decision:</strong><br>[root@kvmcentos ~]# yum list | grep gnupg<br>&nbsp;&nbsp;&nbsp;&nbsp;  gnupg2.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2.9-1.el8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   @anaconda<br>&nbsp;&nbsp;&nbsp;&nbsp;  gnupg2-smime.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  2.2.9-1.el8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   @anaconda<br>&nbsp;&nbsp;&nbsp;&nbsp;  qca-qt5-gnupg.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.2.1-1.el8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   epel  <br>[root@kvmcentos ~]# gpg --version<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg (GnuPG) 2.2.9<br>&nbsp;&nbsp;&nbsp;&nbsp;  libgcrypt 1.8.3<br>&nbsp;&nbsp;&nbsp;&nbsp;  Copyright (C) 2018 Free Software Foundation, Inc.<br>&nbsp;&nbsp;&nbsp;&nbsp;  License GPLv3+: GNU GPL version 3 or later &lt;https://gnu.org/licenses/gpl.html&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  This is free software: you are free to change and redistribute it.<br>&nbsp;&nbsp;&nbsp;&nbsp;  There is NO WARRANTY, to the extent permitted by law.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Home: /root/.gnupg<br>&nbsp;&nbsp;&nbsp;&nbsp;  Поддерживаются следующие алгоритмы:<br>&nbsp;&nbsp;&nbsp;&nbsp;  С открытым ключом: RSA, ELG, DSA, ECDH, ECDSA, EDDSA<br>&nbsp;&nbsp;&nbsp;&nbsp;  Симметричные шифры: IDEA, 3DES, CAST5, BLOWFISH,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  AES, AES192, AES256, TWOFISH, CAMELLIA128,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  CAMELLIA192, CAMELLIA256<br>&nbsp;&nbsp;&nbsp;&nbsp;  Хеш-функции: SHA1, RIPEMD160, SHA256, SHA384, SHA512,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   SHA224<br>&nbsp;&nbsp;&nbsp;&nbsp;  Алгоритмы сжатия: Без сжатия, ZIP, ZLIB,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BZIP2<br><strong>Task:</strong><br>Использование симметричного, асимметричного шифрования. Давайте зашифруем и расшифруем данные с помощью симметричного метода. Для этого выполним команду gpg с опцией -c, которая сообщает, что нужно использовать симметричный режим шифрования. Далее указываем файл, который необходимо зашифровать. По умолчанию применяется алгоритм CAST5, который можно изменить с помощью опции --cipher-algo. Посмотреть доступные алгоритмы можно в выводе команды gpg --version (строка Cipher:).<br>- У меня есть Другая система Убунту, перенесем туда файл. После передачи файла в удаленную/другую систему его необходимо расшифровать. Для этого в команде gpg с помощью опции -o указываем имя для файла, которое будет после расшифровки, а с помощью опции -d указываем зашифрованный файл, который будем расшифровывать.<br>- Проверим содержимое файла. Как видим, это действительно оригинальный файл с первой машины Centos.<br>- Использование асимметричного шифрования начинается с генерации пары ключей — открытого и секретного. Для этого используется команда gpg с опцией --gen-key<br>- Указываем идентификационный номер для ключа, по которому его можно будет отличить от других. Обычно это имя и e-mail адрес владельца ключа. Не всегда процесс генерации ключа идет гладко, чтобы это исправить нужно еще один консоль открыть и сделать активность в системе. Это для тех у кого консольная система. А если у вас графический интерфейс, можете просто мышкой потыкать. После этого должно пойти процесс генерации. После этого в каталоге ~/.gnupg/ будут созданы соответствующие файлы.<br>- Посмотреть ключи можно командой gpg с опцией --list-keys<br>- Перед использованием вашего публичного ключа другими пользователями его необходимо экспортировать. По умолчанию ключ экспортируется в бинарном формате, что не всегда удобно. С помощью опции --armor мы получим наш публичный ключ на консоль, откуда его можно скопировать и отправить по почте или выложить на свой сайт.<br>- В удаленной системе импортируем публичный ключ, чтобы мы его могли использовать. Для этого текст публичного ключа сохраняем в текстовый файл и передаем в качестве аргумента команде gpg. вставляем скопированный публичный ключ<br>- После импорта можно убедиться, что ключ действительно был импортирован. должен быть Dmitry и Eugeny. Для этого используется команда gpg --list-keys. A После импорта ключа его необходимо активировать, а для этого необходимо перейти в режим редактирования этого ключа. Вы попадете в специальный интерфейс.<br>- Для начала нужно вывести отпечаток ключа и сравнить его с отпечатком ключа из целевой системы. Можно позвонить к пользователю, попросить чтоб он сообщил отпечаток ключа и сравнить по телефону. F379 B9FC CC0E 825B 476E  E68B 6610 EC5A D37E 27AC - отпечаток ключа пользователя Eugeny. Если они совпадают, то все нормально, ключ можно верифицировать.<br>- На другом компьютере нужно будет проделать то же самое. Единственное отличие — имя ключа будет другим. получатель публикует ключ, копирует его.<br>- Зашифруем файл myfile для пользователя Dmitry. Зашифрованный файл получит имя myfile.gpg. r - кто получатель, e - ecrypt операция шифрования<br>- После этого зашифрованный файл можно свободно передавать по открытым каналам передачи данных. Файл сможет расшифровать только пользователь Dmitry с помощью своего секретного ключа. Передаем<br>- Расшифровать файл пользователь Dmitry сможет командой<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# vim myfile.txt<br>[root@kvmcentos ~]# cat myfile.txt<br>&nbsp;&nbsp;&nbsp;&nbsp;  --------SECRTET!!-------<br>&nbsp;&nbsp;&nbsp;&nbsp;  ---------=)------------<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp; 49 апр 15 22:42  myfile.txt<br>[root@kvmcentos ~]# gpg -c myfile.txt<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp; 49 апр 15 22:42  myfile.txt<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;103 апр 15 22:44  myfile.txt.gpg<br>[root@kvmcentos ~]# cat myfile.txt.gpg<br>&nbsp;&nbsp;&nbsp;&nbsp;  ��%��A���V�O��κQ��S��gj�Vyv��cƒ�]��$[)8�]l��S�w�Z���ȝ���&lt;�n�R��y�`W7'�F�⬚�m���<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rwxrwx--- 1 linux linux   103 апр 16 05:44  myfile.txt.gpg<br>[root@kvmcentos ~]# cat myfile.txt.gpg<br>&nbsp;&nbsp;&nbsp;&nbsp;  ��%��A���V�O��κQ��S��gj�Vyv��cƒ�]��$[)8�]l��S�w�Z���ȝ���&lt;�n�R��y�`W7'�F�⬚�m���<br>[root@kvmcentos ~]# gpg -o myfile -d myfile.txt.gpg<br>&nbsp;&nbsp;  gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'<br>&nbsp;&nbsp;  gpg: данные зашифрованы алгоритмом AES<br>&nbsp;&nbsp;  gpg: зашифровано одной фразой-паролем<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r-- 1 root  root&nbsp;&nbsp; 49 апр 16 06:04  myfile<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rwxrwx--- 1 linux linux   103 апр 16 05:44  myfile.txt.gpg<br>[root@kvmcentos ~]# cat myfile<br>&nbsp;&nbsp;&nbsp;&nbsp;  --------SECRTET!!-------<br>&nbsp;&nbsp;&nbsp;&nbsp;  ---------=)------------<br>[root@kvmcentos ~]# gpg --gen-key<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg (GnuPG) 2.2.9; Copyright (C) 2018 Free Software Foundation, Inc.<br>&nbsp;&nbsp;&nbsp;&nbsp;  This is free software: you are free to change and redistribute it.<br>&nbsp;&nbsp;&nbsp;&nbsp;  There is NO WARRANTY, to the extent permitted by law.<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: создан каталог '/root/.gnupg'<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: создан щит с ключами '/root/.gnupg/pubring.kbx'<br>&nbsp;&nbsp;&nbsp;&nbsp;  Замечание: "gpg --full-generate-key" вызывает полнофункциональный диалог создания ключа.<br>&nbsp;&nbsp;&nbsp;&nbsp;  GnuPG должен составить идентификатор пользователя для идентификации ключа.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Ваше полное имя: Admin3<br>&nbsp;&nbsp;&nbsp;&nbsp;  Адрес электронной почты: testAdmin3@mail.ru<br>&nbsp;&nbsp;&nbsp;&nbsp;  Вы выбрали следующий идентификатор пользователя:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  "Admin3 &lt;testAdmin3@mail.ru&gt;"<br>&nbsp;&nbsp;&nbsp;&nbsp;  Сменить (N)Имя, (E)Адрес; (O)Принять/(Q)Выход? o<br>&nbsp;&nbsp;&nbsp;&nbsp;  Необходимо получить много случайных чисел. Желательно, чтобы Вы<br>&nbsp;&nbsp;&nbsp;&nbsp;  в процессе генерации выполняли какие-то другие действия (печать<br>&nbsp;&nbsp;&nbsp;&nbsp;  на клавиатуре, движения мыши, обращения к дискам); это даст генератору<br>&nbsp;&nbsp;&nbsp;&nbsp;  случайных чисел больше возможностей получить достаточное количество энтропии.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Необходимо получить много случайных чисел. Желательно, чтобы Вы<br>&nbsp;&nbsp;&nbsp;&nbsp;  в процессе генерации выполняли какие-то другие действия (печать<br>&nbsp;&nbsp;&nbsp;&nbsp;  на клавиатуре, движения мыши, обращения к дискам); это даст генератору<br>&nbsp;&nbsp;&nbsp;&nbsp;  случайных чисел больше возможностей получить достаточное количество энтропии.<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: /root/.gnupg/trustdb.gpg: создана таблица доверия<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: ключ 8EAEFED2A8D76C1E помечен как абсолютно доверенный<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: создан каталог '/root/.gnupg/openpgp-revocs.d'<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: сертификат отзыва записан в '/root/.gnupg/openpgp-revocs.d/CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E.rev'.<br>&nbsp;&nbsp;&nbsp;&nbsp;  открытый и секретный ключи созданы и подписаны.<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa2048 2020-04-16 [SC] [   годен до: 2022-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Admin3 &lt;testAdmin3@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub   rsa2048 2020-04-16 [E] [   годен до: 2022-04-16]<br>[root@kvmcentos ~]# ls -liR /usr/<br>[root@kvmcentos ~]# ls -l ~/.gnupg/<br>[root@kvmcentos ~]# gpg --list-keys<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: проверка таблицы доверия<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: marginals needed: 3  completes needed: 1  trust model: pgp<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: глубина: 0  достоверных:   1  подписанных:   0  доверие: 0-, 0q, 0n, 0m, 0f, 1u<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: срок следующей проверки таблицы доверия 2022-04-16<br>&nbsp;&nbsp;&nbsp;&nbsp;  /root/.gnupg/pubring.kbx<br>&nbsp;&nbsp;&nbsp;&nbsp;  ------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa2048 2020-04-16 [SC] [   годен до: 2022-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid&nbsp;&nbsp;&nbsp;&nbsp; [  абсолютно ] Admin3 &lt;testAdmin3@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub   rsa2048 2020-04-16 [E] [   годен до: 2022-04-16]<br>[root@kvmcentos ~]# gpg --armor --export Admin3<br>&nbsp;&nbsp;&nbsp;&nbsp;  -----BEGIN PGP PUBLIC KEY BLOCK-----<br>&nbsp;&nbsp;&nbsp;&nbsp;  mQENBF6X83gBCACxdea4V0yruICk52BJ4/+i2h7iTLHSBINl4rDFWtFhYYDIjFAs<br>&nbsp;&nbsp;&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;&nbsp;&nbsp;  CYyxynbLeIxw29LYqLBWATEfJQTkr0jJjkjDSWUd82nSSp9iSdhCQiVN7ytHgbxR<br>&nbsp;&nbsp;&nbsp;&nbsp;  ms4UCJxlkE2uoZ/VNMKoxFCLWdEsK3mI+f8BtCr2SmQwObY=<br>&nbsp;&nbsp;&nbsp;&nbsp;  =ooVe<br>&nbsp;&nbsp;&nbsp;&nbsp;  -----END PGP PUBLIC KEY BLOCK-----<br>[root@kvmcentos ~]# vim box-key<br>[root@kvmcentos ~]# cat box-key<br>&nbsp;&nbsp;&nbsp;&nbsp;  -----BEGIN PGP PUBLIC KEY BLOCK-----<br>&nbsp;&nbsp;&nbsp;&nbsp;  mQENBF6X83gBCACxdea4V0yruICk52BJ4/+i2h7iTLHSBINl4rDFWtFhYYDIjFAs<br>&nbsp;&nbsp;&nbsp;&nbsp;  BbW3tVT5Pd+vXQyFUD/fedP4n36OY8IrJB44jFGWZysuWYy4+WAQ0gyJh3GbkW6D<br>&nbsp;&nbsp;&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;&nbsp;&nbsp;  CYyxynbLeIxw29LYqLBWATEfJQTkr0jJjkjDSWUd82nSSp9iSdhCQiVN7ytHgbxR<br>&nbsp;&nbsp;&nbsp;&nbsp;  ms4UCJxlkE2uoZ/VNMKoxFCLWdEsK3mI+f8BtCr2SmQwObY=<br>&nbsp;&nbsp;&nbsp;&nbsp;  =ooVe<br>&nbsp;&nbsp;&nbsp;&nbsp;  -----END PGP PUBLIC KEY BLOCK-----<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r-- 1 root  root   1753 апр 16 09:02  box-key<br>[root@kvmcentos ~]# gpg --gen-key<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg (GnuPG) 2.2.4; Copyright (C) 2017 Free Software Foundation, Inc.<br>&nbsp;&nbsp;&nbsp;&nbsp;  This is free software: you are free to change and redistribute it.<br>&nbsp;&nbsp;&nbsp;&nbsp;  There is NO WARRANTY, to the extent permitted by law.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Замечание: "gpg --full-generate-key" вызывает полнофункциональный диалог создания ключа.<br>&nbsp;&nbsp;&nbsp;&nbsp;  GnuPG должен составить идентификатор пользователя для идентификации ключа.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Ваше полное имя: Client1<br>&nbsp;&nbsp;&nbsp;&nbsp;  Адрес электронной почты: testClient1@mail.ru<br>&nbsp;&nbsp;&nbsp;&nbsp;  Вы выбрали следующий идентификатор пользователя:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  "Client1 &lt;testClient1@mail.ru&gt;"<br>&nbsp;&nbsp;&nbsp;&nbsp;  Сменить (N)Имя, (E)Адрес; (O)Принять/(Q)Выход? o<br>&nbsp;&nbsp;&nbsp;&nbsp;  Необходимо получить много случайных чисел. Желательно, чтобы Вы<br>&nbsp;&nbsp;&nbsp;&nbsp;  в процессе генерации выполняли какие-то другие действия (печать<br>&nbsp;&nbsp;&nbsp;&nbsp;  на клавиатуре, движения мыши, обращения к дискам); это даст генератору<br>&nbsp;&nbsp;&nbsp;&nbsp;  случайных чисел больше возможностей получить достаточное количество энтропии.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Необходимо получить много случайных чисел. Желательно, чтобы Вы<br>&nbsp;&nbsp;&nbsp;&nbsp;  в процессе генерации выполняли какие-то другие действия (печать<br>&nbsp;&nbsp;&nbsp;&nbsp;  на клавиатуре, движения мыши, обращения к дискам); это даст генератору<br>&nbsp;&nbsp;&nbsp;&nbsp;  случайных чисел больше возможностей получить достаточное количество энтропии.<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: ключ 05A2E96C7147C8B8 помечен как абсолютно доверенный<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: создан каталог '/home/linux/.gnupg/openpgp-revocs.d'<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: сертификат отзыва записан в '/home/linux/.gnupg/openpgp-revocs.d/C0A7FE019BB0D430C465CBCA05A2E96C7147C8B8.rev'.<br>&nbsp;&nbsp;&nbsp;&nbsp;  открытый и секретный ключи созданы и подписаны.<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa3072 2020-04-16 [SC] [годен до: 2022-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C0A7FE019BB0D430C465CBCA05A2E96C7147C8B8<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Client1 &lt;testClient1@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub   rsa3072 2020-04-16 [E] [годен до: 2022-04-16]<br>[root@kvmcentos ~]# gpg --import box-key<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: ключ 8EAEFED2A8D76C1E: импортирован открытый ключ "Admin3 &lt;testAdmin3@mail.ru&gt;"<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Всего обработано: 1<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   импортировано: 1<br>[root@kvmcentos ~]# gpg --list-keys<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: проверка таблицы доверия<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: marginals needed: 3  completes needed: 1  trust model: pgp<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: глубина: 0  достоверных:   1  подписанных:   0  доверие: 0-, 0q, 0n, 0m, 0f, 1u<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: срок следующей проверки таблицы доверия 2022-04-16<br>&nbsp;&nbsp;&nbsp;&nbsp;  /home/linux/.gnupg/pubring.kbx<br>&nbsp;&nbsp;&nbsp;&nbsp;  ------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa3072 2020-04-16 [SC] [годен до: 2022-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C0A7FE019BB0D430C465CBCA05A2E96C7147C8B8<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid&nbsp;&nbsp;&nbsp;&nbsp; [  абсолютно ] Client1 &lt;testClient1@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub   rsa3072 2020-04-16 [E] [годен до: 2022-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa2048 2020-04-16 [SC] [годен до: 2022-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid&nbsp;&nbsp;&nbsp;&nbsp; [ неизвестно ] Admin3 &lt;testAdmin3@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub   rsa2048 2020-04-16 [E] [годен до: 2022-04-16]<br>[root@kvmcentos ~]# gpg --edit-key Admin3<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg (GnuPG) 2.2.4; Copyright (C) 2017 Free Software Foundation, Inc.<br>&nbsp;&nbsp;&nbsp;&nbsp;  This is free software: you are free to change and redistribute it.<br>&nbsp;&nbsp;&nbsp;&nbsp;  There is NO WARRANTY, to the extent permitted by law.<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub  rsa2048/8EAEFED2A8D76C1E<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   создан: 2020-04-16  годен до: 2022-04-16  назначение: SC  <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   доверие: неизвестно достоверность: неизвестно<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub  rsa2048/764375B485FCFEAF<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   создан: 2020-04-16  годен до: 2022-04-16  назначение: E   <br>&nbsp;&nbsp;&nbsp;&nbsp;  [ неизвестно ] (1). Admin3 &lt;testAdmin3@mail.ru&gt;<br>gpg&gt; help<br>gpg&gt; fpr<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa2048/8EAEFED2A8D76C1E 2020-04-16 Admin3 &lt;testAdmin3@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;   Отпечаток первичного ключа: CDEA 2870 E05B F396 9EFC  7CA1 8EAE FED2 A8D7 6C1E<br>gpg&gt; sign<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub  rsa2048/8EAEFED2A8D76C1E<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   создан: 2020-04-16  годен до: 2022-04-16  назначение: SC  <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   доверие: неизвестно достоверность: неизвестно<br>&nbsp;&nbsp;&nbsp;&nbsp;   Отпечаток первичного ключа: CDEA 2870 E05B F396 9EFC  7CA1 8EAE FED2 A8D7 6C1E<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Admin3 &lt;testAdmin3@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  Срок действия данного ключа истекает 2022-04-16.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Вы уверены, что хотите подписать этот ключ<br>&nbsp;&nbsp;&nbsp;&nbsp;  своим ключом "Client1 &lt;testClient1@mail.ru&gt;" (05A2E96C7147C8B8)?<br>&nbsp;&nbsp;&nbsp;&nbsp;  Действительно подписать? (y/N) y<br>gpg&gt; check<br>[root@kvmcentos ~]# gpg --armor --export Client1<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'<br>&nbsp;&nbsp;&nbsp;&nbsp;  -----BEGIN PGP PUBLIC KEY BLOCK-----<br>&nbsp;&nbsp;&nbsp;&nbsp;  mQGNBF6X9VwBDADIWL7gvO1KUpGLzzBewGbkyaBJGEhO3dMAtrGvP1xRcWXRgphK<br>&nbsp;&nbsp;&nbsp;&nbsp;  AJfVu1t4wIjfWhumv1jo6uE9phk9BHQkqmzCVlPdEOSYsuyP6jNkWQnuc4sNAIqA<br>&nbsp;&nbsp;&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;&nbsp;&nbsp;  MsAz4P7xxX00TKcYTa2DWlOW4z2kF8qoYPs1nuXWHAvRVQ+QJ0pop3VRZKXN3ZBw<br>&nbsp;&nbsp;&nbsp;&nbsp;  9pGyrirzjqEqk/1aJTsEK6kgpHDlg71B1ajcZ2pYiMsICnjBowXh87Xgrb/7wTr1<br>&nbsp;&nbsp;&nbsp;&nbsp;  yKDnyVYRcd3IECbxciuHX49/YffC<br>&nbsp;&nbsp;&nbsp;&nbsp;  =NM6e<br>&nbsp;&nbsp;&nbsp;&nbsp;  -----END PGP PUBLIC KEY BLOCK-----<br>[root@kvmcentos ~]# vim box-key<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root   2448 апр 16 02:10  box-key<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp; 49 апр 15 22:42  myfile.txt<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;103 апр 15 22:44  myfile.txt.gpg<br>[root@kvmcentos ~]# gpg --import box-key<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: ключ 05A2E96C7147C8B8: импортирован открытый ключ "Client1 &lt;testClient1@mail.ru&gt;"<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Всего обработано: 1<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  импортировано: 1<br>[root@kvmcentos ~]# gpg --edit-key Client1<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg (GnuPG) 2.2.9; Copyright (C) 2018 Free Software Foundation, Inc.<br>&nbsp;&nbsp;&nbsp;&nbsp;  This is free software: you are free to change and redistribute it.<br>&nbsp;&nbsp;&nbsp;&nbsp;  There is NO WARRANTY, to the extent permitted by law.<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub  rsa3072/05A2E96C7147C8B8<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;создан: 2020-04-16&nbsp;&nbsp; годен до: 2022-04-16  назначение: SC  <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   доверие: неизвестно достоверность: неизвестно<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub  rsa3072/58859DC04AFB86B9<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;создан: 2020-04-16&nbsp;&nbsp; годен до: 2022-04-16  назначение: E   <br>&nbsp;&nbsp;&nbsp;&nbsp;  [ неизвестно ] (1). Client1 &lt;testClient1@mail.ru&gt;<br>gpg&gt; fpr<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa3072/05A2E96C7147C8B8 2020-04-16 Client1 &lt;testClient1@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;   Отпечаток первичного ключа: C0A7 FE01 9BB0 D430 C465  CBCA 05A2 E96C 7147 C8B8<br>gpg&gt; sign<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub  rsa3072/05A2E96C7147C8B8<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;создан: 2020-04-16&nbsp;&nbsp; годен до: 2022-04-16  назначение: SC  <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   доверие: неизвестно достоверность: неизвестно<br>&nbsp;&nbsp;&nbsp;&nbsp;   Отпечаток первичного ключа: C0A7 FE01 9BB0 D430 C465  CBCA 05A2 E96C 7147 C8B8<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Client1 &lt;testClient1@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  Срок действия данного ключа истекает 2022-04-16.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Вы уверены, что хотите подписать этот ключ<br>&nbsp;&nbsp;&nbsp;&nbsp;  своим ключом "Admin3 &lt;testAdmin3@mail.ru&gt;" (8EAEFED2A8D76C1E)?<br>&nbsp;&nbsp;&nbsp;&nbsp;  Действительно подписать? (y/N) y<br>gpg&gt; check<br>gpg&gt; quit<br>[root@kvmcentos ~]# vim myfile<br>[root@kvmcentos ~]# cat myfile<br>&nbsp;&nbsp;&nbsp;&nbsp;  ---secret---<br>[root@kvmcentos ~]# gpg -o myfilenew.gpg -e -r Client1 myfile<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: проверка таблицы доверия<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: marginals needed: 3  completes needed: 1  trust model: pgp<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: глубина: 0  достоверных:   1  подписанных:   1  доверие: 0-, 0q, 0n, 0m, 0f, 1u<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: глубина: 1  достоверных:   1  подписанных:   0  доверие: 1-, 0q, 0n, 0m, 0f, 0u<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: срок следующей проверки таблицы доверия 2022-04-16<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root   2448 апр 16 02:10  box-key<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp; 13 апр 16 02:15  myfile<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;478 апр 16 02:21  myfilenew.gpg<br>[root@kvmcentos ~]# cat myfilenew.gpg<br>&nbsp;&nbsp;&nbsp;&nbsp;  ��X���J���<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   �+��-$6ٌ�)r+9e��|&gt;N�&�21ʸX��HJMuS�=����o��_��oi�h��:J��Q��U�Y[���5I��`<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{�6U����y$�n��&nbsp;&nbsp;TS�&gt;����NJ�Tc%���5{��=FW�xv�Zr�����N*��9�ڻ��r(h�x��[ŀ(ў*��~�x��|Sր��u�{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ^���8YA���R&nI�����y�l9��!��yO/J�X�9���%u����q�2��ã%�k'u�i���؍�������g�X�v�bE5IP9�&lt;�"���'�?b]��x���_`Y�Ԡ��I��M�6�B�\�C�h���Q�B�4@�;O�xbԽ��e��x/8\L's����*��)EU��x~�ά��`ȟ�&nbsp;&nbsp;�BB���M� ,�&gt;�&gkb�ǻ�<br>&nbsp;&nbsp;&nbsp;&nbsp;  �N�Խ����s��b��-ɘ%�<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   F;.܍5��zD\����<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; �Kc|=O��:��s�<br>[root@kvmcentos ~]# scp myfilenew.gpg linux@tipCentos:/home/linux <br>&nbsp;&nbsp;&nbsp;&nbsp;  myfilenew.gpg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 100%  478   167.8KB/s   00:00<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  итого 112<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r-- 1 root  root   1753 апр 16 09:02  box-key<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r-- 1 linux linux   478 апр 16 09:55  myfilenew.gpg<br>[root@kvmcentos ~]# gpg -o myfile -d myfilenew.gpg<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: зашифровано 3072-битным ключом RSA с идентификатором 58859DC04AFB86B9, созданным 2020-04-16<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Client1 &lt;testClient1@mail.ru&gt;"<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  итого 116<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r-- 1 root  root   1753 апр 16 09:02  box-key<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r-- 1 root  root&nbsp;&nbsp; 13 апр 16 09:57  myfile<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r-- 1 linux linux   478 апр 16 09:55  myfilenew.gpg<br>[root@kvmcentos ~]# cat myfile<br>&nbsp;&nbsp;&nbsp;&nbsp;  ---secret---<br><strong>Task:</strong><br>Создание сертификата отзыва.  <br>- Посмотрим ID публичного ключа, который мы отправим на публичный сервер ключей.<br>- С помощью опции --keyserver указываем публичный сервер ключей, с помощью опции --send-key сообщаем, что ключ необходимо отправить на сервер.<br>- После этого любой желающий может получить ваш публичный ключ с сервера ключей, просто указав его ID. Для получения ключа с сервера используется опция --recv-keys. ID ключа также можно выяснить по e-mail адресу владельца или его имени.<br>- Представим ситуацию, что ваш секретный ключ скомпрометирован или просто потерян. Следовательно, больше нет смысла шифровать для вас данные публичным ключом из связки с этим личным ключом и его нужно отозвать. Генерируем сертификат отзыва. После выполнения команды будет создан файл eugeny.asc, это и есть сертификат отзыва.<br>- Далее сертификат отзыва необходимо импортировать в вашу базу данных ключей. Публичный ключ отозван (revoked).<br>- Загружаем отозванный ключ на публичный сервер ключей.<br>- В удаленной системе, в случае желания получить ваш публичный ключ, будет принят сертификат отзыва. Теперь отозванный ключ нельзя будет использовать для шифрования данных.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# gpg --list-keys<br>&nbsp;&nbsp;&nbsp;&nbsp;  /root/.gnupg/pubring.kbx<br>&nbsp;&nbsp;&nbsp;&nbsp;  ------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa2048 2020-04-16 [SC] [   годен до: 2022-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid&nbsp;&nbsp;&nbsp;&nbsp; [  абсолютно ] Admin3 &lt;testAdmin3@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub   rsa2048 2020-04-16 [E] [   годен до: 2022-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa3072 2020-04-16 [SC] [   годен до: 2022-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C0A7FE019BB0D430C465CBCA05A2E96C7147C8B8<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid&nbsp;&nbsp;&nbsp;&nbsp; [   полное   ] Client1 &lt;testClient1@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub   rsa3072 2020-04-16 [E] [   годен до: 2022-04-16]<br>[root@kvmcentos ~]# gpg --keyserver pgp.mit.edu --send-key CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: отправка ключа 8EAEFED2A8D76C1E на hkp://pgp.mit.edu<br>[root@kvmcentos ~]# gpg --keyserver pgp.mit.edu --recv-key CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: ключ 8EAEFED2A8D76C1E: "Admin3 &lt;testAdmin3@mail.ru&gt;" не изменен<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Всего обработано: 1<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  неизмененных: 1<br>[root@kvmcentos ~]# gpg --keyserver pgp.mit.edu --search-key testAdmin3@mail.ru<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: data source: http://pgp.mit.edu:11371<br>&nbsp;&nbsp;&nbsp;&nbsp;  (1)&nbsp;&nbsp;Admin3 &lt;testAdmin3@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2048 bit RSA key 8EAEFED2A8D76C1E,&nbsp;&nbsp;  создан: 2020-04-16,&nbsp;&nbsp;годен до: 2022-04-16<br>&nbsp;&nbsp;&nbsp;&nbsp;  Keys 1-1 of 1 for "testAdmin3@mail.ru".  Введите числа, N) Следующее; Q) Выход &gt; Q<br>[root@kvmcentos ~]# gpg -o Admin3.asc --gen-revoke Admin3<br>&nbsp;&nbsp;&nbsp;&nbsp;  sec  rsa2048/8EAEFED2A8D76C1E 2020-04-16 Admin3 &lt;testAdmin3@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  Создать сертификат отзыва данного ключа? (y/N) y<br>&nbsp;&nbsp;&nbsp;&nbsp;  Укажите причину отзыва:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 = Причина не указана<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 = Ключ был раскрыт<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 = Ключ заменен другим<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 = Ключ больше не используется<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q = Отмена<br>&nbsp;&nbsp;&nbsp;&nbsp;  (Скорее всего, Вы здесь выберете 1)<br>&nbsp;&nbsp;&nbsp;&nbsp;  Ваше Decision? 3<br>&nbsp;&nbsp;&nbsp;&nbsp;  Введите необязательное пояснение; завершите пустой строкой:<br>&nbsp;&nbsp;&nbsp;&nbsp;  &gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  Причина отзыва: Ключ больше не используется<br>&nbsp;&nbsp;&nbsp;&nbsp;  (Пояснения отсутствуют)<br>&nbsp;&nbsp;&nbsp;&nbsp;  Все правильно? (y/N) y<br>&nbsp;&nbsp;&nbsp;&nbsp;  Для вывода использован текстовый формат ASCII.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Сертификат отзыва создан.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Поместите его в надежное место; если посторонний получит доступ<br>&nbsp;&nbsp;&nbsp;&nbsp;  к данному сертификату, он может использовать его, чтобы сделать<br>&nbsp;&nbsp;&nbsp;&nbsp;  Ваш ключ непригодным к использованию. Можно распечатать данный<br>&nbsp;&nbsp;&nbsp;&nbsp;  сертификат и спрятать подальше на случай, если Ваш основной<br>&nbsp;&nbsp;&nbsp;&nbsp;  носитель будет поврежден, но будьте осторожны: система печати<br>&nbsp;&nbsp;&nbsp;&nbsp;  Вашей машины может сохранить данные и сделать их доступными для других!<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;478 апр 16 02:53  tipCentos<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-------. 1 root   root&nbsp;&nbsp;548 апр 16 03:16  Admin3.asc<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root   2448 апр 16 02:10  box-key<br>&nbsp;&nbsp;&nbsp;&nbsp;  drwxr-xr-x. 2 root   root&nbsp;&nbsp; 45 апр  9 21:40  docs<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp; 13 апр 16 02:15  myfile<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;478 апр 16 02:21  myfilenew.gpg<br>[root@kvmcentos ~]# gpg --import Admin3.asc<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: ключ 8EAEFED2A8D76C1E: сертификат отзыва "Admin3 &lt;testAdmin3@mail.ru&gt;" импортирован<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Всего обработано: 1<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg:&nbsp;&nbsp;&nbsp;&nbsp;   новых отзывов ключей: 1<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: marginals needed: 3  completes needed: 1  trust model: pgp<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: глубина: 0  достоверных:   1  подписанных:   0  доверие: 0-, 0q, 0n, 0m, 0f, 1u<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: срок следующей проверки таблицы доверия 2022-04-16<br>[root@kvmcentos ~]# gpg --list-keys<br>&nbsp;&nbsp;&nbsp;&nbsp;  /root/.gnupg/pubring.kbx<br>&nbsp;&nbsp;&nbsp;&nbsp;  ------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa2048 2020-04-16 [SC] [&nbsp;&nbsp;отозван: 2020-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid&nbsp;&nbsp;&nbsp;&nbsp; [   отозван  ] Admin3 &lt;testAdmin3@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa3072 2020-04-16 [SC] [   годен до: 2022-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C0A7FE019BB0D430C465CBCA05A2E96C7147C8B8<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid&nbsp;&nbsp;&nbsp;&nbsp; [ неизвестно ] Client1 &lt;testClient1@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub   rsa3072 2020-04-16 [E] [   годен до: 2022-04-16]<br>[root@kvmcentos ~]# gpg --keyserver pgp.mit.edu --send-key CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: отправка ключа 8EAEFED2A8D76C1E на hkp://pgp.mit.edu<br>[root@kvmcentos ~]# gpg --keyserver pgp.mit.edu --recv-key CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: ключ 8EAEFED2A8D76C1E: добавлен сертификат отзыва "Admin3 &lt;testAdmin3@mail.ru&gt;"<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: ключ 8EAEFED2A8D76C1E: "Admin3 &lt;testAdmin3@mail.ru&gt;" 1 новая подпись<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Всего обработано: 1<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg:&nbsp;&nbsp;&nbsp;&nbsp; новых подписей: 1<br>[root@kvmcentos ~]# gpg --list-keys<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: проверка таблицы доверия<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: marginals needed: 3  completes needed: 1  trust model: pgp<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: глубина: 0  достоверных:   1  подписанных:   0  доверие: 0-, 0q, 0n, 0m, 0f, 1u<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: срок следующей проверки таблицы доверия 2022-04-16<br>&nbsp;&nbsp;&nbsp;&nbsp;  /home/linux/.gnupg/pubring.kbx<br>&nbsp;&nbsp;&nbsp;&nbsp;  ------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa3072 2020-04-16 [SC] [годен до: 2022-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C0A7FE019BB0D430C465CBCA05A2E96C7147C8B8<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid&nbsp;&nbsp;&nbsp;&nbsp; [  абсолютно ] Client1 &lt;testClient1@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub   rsa3072 2020-04-16 [E] [годен до: 2022-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa2048 2020-04-16 [SC] [отозван: 2020-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEA2870E05BF3969EFC7CA18EAEFED2A8D76C1E<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid&nbsp;&nbsp;&nbsp;&nbsp; [   отозван  ] Admin3 &lt;testAdmin3@mail.ru&gt;<br>[root@kvmcentos ~]# gpg -o myfile.gpg -e -r Admin3 myfile<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Admin3: пропущено: Нет открытого ключа<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: myfile: encryption failed: Нет открытого ключа<br><strong>Task:</strong><br>Цифровая подпись файлов<br>- Подписать файл myfile можно командой, указанной ниже. Подписанный файл будет сохранен под именем myfile.sig<br>- Проверить подпись в удаленной системе можно с помощью команды gpg с опцией --verify<br>- Расшифровка файла myfile.sig<br>- подписать текстовые файлы, в этом случае подпись будет добавлена в конец файла. Файл получит расширение asc.<br>- Также есть возможность получить цифровую подпись в отдельный файл. Впоследствии файл с подписью и оригинальный файл будут использоваться для того, чтобы верифицировать подпись.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# gpg --gen-key<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg (GnuPG) 2.2.9; Copyright (C) 2018 Free Software Foundation, Inc.<br>&nbsp;&nbsp;&nbsp;&nbsp;  This is free software: you are free to change and redistribute it.<br>&nbsp;&nbsp;&nbsp;&nbsp;  There is NO WARRANTY, to the extent permitted by law.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Замечание: "gpg --full-generate-key" вызывает полнофункциональный диалог создания ключа.<br>&nbsp;&nbsp;&nbsp;&nbsp;  GnuPG должен составить идентификатор пользователя для идентификации ключа.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Ваше полное имя: Admin3<br>&nbsp;&nbsp;&nbsp;&nbsp;  Адрес электронной почты: testAdmin3@mail.ru<br>&nbsp;&nbsp;&nbsp;&nbsp;  Вы выбрали следующий идентификатор пользователя:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  "Admin3 &lt;testAdmin3@mail.ru&gt;"<br>&nbsp;&nbsp;&nbsp;&nbsp;  Сменить (N)Имя, (E)Адрес; (O)Принять/(Q)Выход? o<br>&nbsp;&nbsp;&nbsp;&nbsp;  Необходимо получить много случайных чисел. Желательно, чтобы Вы<br>&nbsp;&nbsp;&nbsp;&nbsp;  в процессе генерации выполняли какие-то другие действия (печать<br>&nbsp;&nbsp;&nbsp;&nbsp;  на клавиатуре, движения мыши, обращения к дискам); это даст генератору<br>&nbsp;&nbsp;&nbsp;&nbsp;  случайных чисел больше возможностей получить достаточное количество энтропии.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Необходимо получить много случайных чисел. Желательно, чтобы Вы<br>&nbsp;&nbsp;&nbsp;&nbsp;  в процессе генерации выполняли какие-то другие действия (печать<br>&nbsp;&nbsp;&nbsp;&nbsp;  на клавиатуре, движения мыши, обращения к дискам); это даст генератору<br>&nbsp;&nbsp;&nbsp;&nbsp;  случайных чисел больше возможностей получить достаточное количество энтропии.<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: ключ E2EF59C572C2FE68 помечен как абсолютно доверенный<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: сертификат отзыва записан в '/root/.gnupg/openpgp-revocs.d/4D651D448FC062BFFC7602DCE2EF59C572C2FE68.rev'.<br>&nbsp;&nbsp;&nbsp;&nbsp;  открытый и секретный ключи созданы и подписаны.<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub   rsa2048 2020-04-16 [SC] [   годен до: 2022-04-16]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4D651D448FC062BFFC7602DCE2EF59C572C2FE68<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Admin3 &lt;testAdmin3@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub   rsa2048 2020-04-16 [E] [   годен до: 2022-04-16]<br>[root@kvmcentos ~]# gpg -o myfile.sig -s myfile<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;478 апр 16 02:53  tipCentos<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-------. 1 root   root&nbsp;&nbsp;548 апр 16 03:16  Admin3.asc<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root   2448 апр 16 02:10  box-key<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp; 13 апр 16 02:15  myfile<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;478 апр 16 02:21  myfilenew.gpg<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;354 апр 16 03:38  myfile.sig<br>[root@kvmcentos ~]# gpg --verify myfile.sig<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Внимание: небезопасный владелец домашнего каталога '/home/linux/.gnupg'<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Подпись сделана Чт 16 апр 2020 10:38:31 MSK<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ключом RSA с идентификатором 4D651D448FC062BFFC7602DCE2EF59C572C2FE68<br>[root@kvmcentos ~]#  gpg -o myfile -d myfile.sig<br>[root@kvmcentos ~]# gpg --clearsign myfile<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r-- 1 root  root&nbsp;&nbsp;723 апр 16 10:50  myfile.asc<br>[root@kvmcentos ~]# cat myfile.asc<br>&nbsp;&nbsp;&nbsp;&nbsp;  -----BEGIN PGP SIGNED MESSAGE-----<br>&nbsp;&nbsp;&nbsp;&nbsp;  Hash: SHA512<br>&nbsp;&nbsp;&nbsp;&nbsp;  - ---secret---<br>&nbsp;&nbsp;&nbsp;&nbsp;  -----BEGIN PGP SIGNATURE-----<br>&nbsp;&nbsp;&nbsp;&nbsp;  iQGzBAEBCgAdFiEEwKf+AZuw1DDEZcvKBaLpbHFHyLgFAl6YDjIACgkQBaLpbHFH<br>&nbsp;&nbsp;&nbsp;&nbsp;  yLhfYgv/fUG4Uc1XWSqfdg39etdp5xIvVx1DUwxy+QNopHqd2MXps6Oe2+qJzLpk<br>&nbsp;&nbsp;&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;&nbsp;&nbsp;  liMFZaeNuL0XDKCbzNqFUTOgFbOo8vueZ1ob7Jq36V/VKz4lXhzOil20QCG8Mmrk<br>&nbsp;&nbsp;&nbsp;&nbsp;  3f/cM/KK6Oy2MWDEJyjVCHt2PhoiknES7mppvilFR1Plb4JSQPPMzXQ1WgsjAtoH<br>&nbsp;&nbsp;&nbsp;&nbsp;  RYFDq2Hc<br>&nbsp;&nbsp;&nbsp;&nbsp;  =YJ6J<br>&nbsp;&nbsp;&nbsp;&nbsp;  -----END PGP SIGNATURE-----<br>[root@kvmcentos ~]# gpg -o myfile.sig --detach-sig myfile<br>[root@kvmcentos ~]# gpg --verify myfile.sig myfile<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Подпись сделана Чт 16 апр 2020 03:53:06 EDT<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ключом RSA с идентификатором 4D651D448FC062BFFC7602DCE2EF59C572C2FE68<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg: Действительная подпись пользователя "Admin3 &lt;testAdmin3@mail.ru&gt;" [абсолютное]<br><strong>Task:</strong><br>Уровень доверия к владельцам ключа<br>- Уровень доверия показывает, насколько сильно вы доверяете владельцу указанного ключа. Изменить его можно, войдя в режим редактирования.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# gpg --edit-key Client1<br>&nbsp;&nbsp;&nbsp;&nbsp;  gpg (GnuPG) 2.2.9; Copyright (C) 2018 Free Software Foundation, Inc.<br>&nbsp;&nbsp;&nbsp;&nbsp;  This is free software: you are free to change and redistribute it.<br>&nbsp;&nbsp;&nbsp;&nbsp;  There is NO WARRANTY, to the extent permitted by law.<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub  rsa3072/05A2E96C7147C8B8<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;создан: 2020-04-16&nbsp;&nbsp; годен до: 2022-04-16  назначение: SC  <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   доверие: неизвестно достоверность: неизвестно<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub  rsa3072/58859DC04AFB86B9<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;создан: 2020-04-16&nbsp;&nbsp; годен до: 2022-04-16  назначение: E   <br>&nbsp;&nbsp;&nbsp;&nbsp;  [ неизвестно ] (1). Client1 &lt;testClient1@mail.ru&gt;<br>gpg&gt; trust<br>&nbsp;&nbsp;&nbsp;&nbsp;  pub  rsa3072/05A2E96C7147C8B8<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;создан: 2020-04-16&nbsp;&nbsp; годен до: 2022-04-16  назначение: SC  <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   доверие: неизвестно достоверность: неизвестно<br>&nbsp;&nbsp;&nbsp;&nbsp;  sub  rsa3072/58859DC04AFB86B9<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;создан: 2020-04-16&nbsp;&nbsp; годен до: 2022-04-16  назначение: E   <br>&nbsp;&nbsp;&nbsp;&nbsp;  [ неизвестно ] (1). Client1 &lt;testClient1@mail.ru&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;  Укажите, насколько Вы доверяете данному пользователю в вопросах проверки<br>&nbsp;&nbsp;&nbsp;&nbsp;  достоверности ключей других пользователей (проверяет паспорт,<br>&nbsp;&nbsp;&nbsp;&nbsp;  сверяет отпечатки ключей из разных источников и т.п.)<br>&nbsp;&nbsp;&nbsp;&nbsp;   1 = Не знаю или не буду отвечать<br>&nbsp;&nbsp;&nbsp;&nbsp;   2 = НЕ доверяю<br>&nbsp;&nbsp;&nbsp;&nbsp;   3 = Доверяю ограниченно<br>&nbsp;&nbsp;&nbsp;&nbsp;   4 = Полностью доверяю<br>&nbsp;&nbsp;&nbsp;&nbsp;   5 = Абсолютно доверяю<br>&nbsp;&nbsp;&nbsp;&nbsp;   m = вернуться в главное меню<br><strong>Task:</strong><br>Надежное удаление файлов<br>Для надежного удаления файлов используется программа shred, входящая в пакет coreutils. Потребность в удалении файла может возникнуть после создания его зашифрованной версии. Место на диске, где находится файл, перезаписывается в несколько проходов, и восстановить его практически невозможно.<br>Пример удаления файла. По умолчанию программа shred 25 раз перезаписывает то место, где находился файл.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# shred -u -v myfile<br>&nbsp;&nbsp;&nbsp;&nbsp;  shred: myfile: проход 1/3 (random)…<br>&nbsp;&nbsp;&nbsp;&nbsp;  shred: myfile: проход 2/3 (random)…<br>&nbsp;&nbsp;&nbsp;&nbsp;  shred: myfile: проход 3/3 (random)…<br>&nbsp;&nbsp;&nbsp;&nbsp;  shred: myfile: удаление<br>&nbsp;&nbsp;&nbsp;&nbsp;  shred: myfile: переименован в 000000<br>&nbsp;&nbsp;&nbsp;&nbsp;  shred: 000000: переименован в 00000<br>&nbsp;&nbsp;&nbsp;&nbsp;  shred: 00000: переименован в 0000<br>&nbsp;&nbsp;&nbsp;&nbsp;  shred: 0000: переименован в 000<br>&nbsp;&nbsp;&nbsp;&nbsp;  shred: 000: переименован в 00<br>&nbsp;&nbsp;&nbsp;&nbsp;  shred: 00: переименован в 0<br>&nbsp;&nbsp;&nbsp;&nbsp;  shred: myfile: удалён<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;478 апр 16 02:53  tipCentos<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-------. 1 root   root&nbsp;&nbsp;548 апр 16 03:16  Admin3.asc<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root   2448 апр 16 02:10  box-key<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp; 88 апр 16 02:17  myfile.gpg<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;478 апр 16 02:21  myfilenew.gpg<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;310 апр 16 03:53  myfile.sig<br><strong>Task:</strong><br>Работа с VIM<br>- Заменить все вхождения “old” на “new”<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>:%s/OldWords/NewWords/g<br><strong>Source:</strong><br># https://scabere.livejournal.com/62886.html?ysclid=lis5xg9t99308663826<br><strong>Task:</strong><br>Выполнение файла *.run в CentOS<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ./setup-training-8.3.23.1688-x86_64.run<br>  sudo: ./setup-training-8.3.23.1688-x86_64.run: command not found<br>root@kvmubuntu:~# chmod +x setup-training-8.3.23.1688-x86_64.run <br>root@kvmubuntu:~# ./setup-training-8.3.23.1688-x86_64.run<br><strong>Task:</strong><br>Исключить обновление определенного пакета<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# dnf update<br>&nbsp;&nbsp;  Последняя проверка окончания срока действия метаданных: 0:33:32 назад, Пн 21 фев 2022 12:18:38.<br>&nbsp;&nbsp;  Зависимости разрешены.<br>&nbsp;&nbsp;  ================================================================================<br>&nbsp;&nbsp;   Пакет&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Архитектура&nbsp;&nbsp;Версия&nbsp;&nbsp;&nbsp;&nbsp;  Репозиторий&nbsp;&nbsp;&nbsp;&nbsp;  Размер<br>&nbsp;&nbsp;  ================================================================================<br>&nbsp;&nbsp;  Обновление:<br>&nbsp;&nbsp;   sublime-text&nbsp;&nbsp;&nbsp;&nbsp; x86_64&nbsp;&nbsp;&nbsp;&nbsp; 4126-1&nbsp;&nbsp;&nbsp;&nbsp;  sublime-text&nbsp;&nbsp;&nbsp;&nbsp;  20 M<br>&nbsp;&nbsp;  Результат транзакции<br>&nbsp;&nbsp;  ================================================================================<br>&nbsp;&nbsp;  Обновление  1 Пакет<br>&nbsp;&nbsp;  Объем загрузки: 20 M<br>&nbsp;&nbsp;  Продолжить? [д/Н]: n<br>&nbsp;&nbsp;  Операция отменена.<br>[root@kvmcentos ~]# cat /etc/dnf/dnf.conf<br>  [main]<br>  gpgcheck=1<br>  installonly_limit=3<br>  clean_requirements_on_remove=True<br>  best=True<br>  skip_if_unavailable=False<br>[root@kvmcentos ~]# vim /etc/dnf/dnf.conf<br>[root@kvmcentos ~]# cat /etc/dnf/dnf.conf<br>  [main]<br>  gpgcheck=1<br>  installonly_limit=3<br>  clean_requirements_on_remove=True<br>  best=True<br>  skip_if_unavailable=False<br>  ## Exclude following Packages Updates ##<br>  exclude=sublime-text<br>[root@kvmcentos ~]# dnf update<br>&nbsp;&nbsp;  Последняя проверка окончания срока действия метаданных: 0:33:57 назад, Пн 21 фев 2022 12:18:38.<br>&nbsp;&nbsp;  Зависимости разрешены.<br>&nbsp;&nbsp;  Отсутствуют действия для выполнения.<br>&nbsp;&nbsp;  Выполнено!<br><strong>Task:</strong><br>Включение и настройка квот<br>Активировать квоты в файловой системе состоит из нескольких шагов.<br>- Отредактировать файл /etc/fstab, включив в него поддержку квот для нужных файловых систем. Для включения квот в файле /etc/fstab для нужных файловых систем, после defaults, через запятую, мы добавляем опцию usrquota, если хотим включить квоты для пользователей, и grpquota, если хотим включить квоты для групп.  Для файловых систем XFS и не XFS (например, ext) эти опции различаются: Для XFS — uquota (для пользователей) и/или gquota (для групп), Для ext и других — usrquota (для пользователей)и/или grpquota (для групп). В примере ниже квоты включаются для файловой системы /home как для пользователей, так и для групп.<br>- Перемонтировать нужные файловые системы.<br>- Создать базу данных квот.<br>- Назначить квоты пользователям и группам.<br>- Статистика по квотам. Зададим 8 дней для квот на дисковое пространство и 9 дней — на количество файлов.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# cat /etc/fstab<br>&nbsp;&nbsp;&nbsp;&nbsp;  #<br>&nbsp;&nbsp;&nbsp;&nbsp;  # /etc/fstab<br>&nbsp;&nbsp;&nbsp;&nbsp;  # Created by anaconda on Wed Mar 11 22:00:21 2020<br>&nbsp;&nbsp;&nbsp;&nbsp;  #<br>&nbsp;&nbsp;&nbsp;&nbsp;  # Accessible filesystems, by reference, are maintained under '/dev/disk/'.<br>&nbsp;&nbsp;&nbsp;&nbsp;  # See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.<br>&nbsp;&nbsp;&nbsp;&nbsp;  #<br>&nbsp;&nbsp;&nbsp;&nbsp;  # After editing this file, run 'systemctl daemon-reload' to update systemd<br>&nbsp;&nbsp;&nbsp;&nbsp;  # units generated from this file.<br>&nbsp;&nbsp;&nbsp;&nbsp;  #<br>&nbsp;&nbsp;&nbsp;&nbsp;  /dev/mapper/cl-root&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   xfs&nbsp;&nbsp; defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>&nbsp;&nbsp;&nbsp;&nbsp;  UUID=4df72e4b-4c08-4a34-bc25-d54c30527016 /boot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   ext4&nbsp;&nbsp;defaults&nbsp;&nbsp;&nbsp;&nbsp;1 2<br>&nbsp;&nbsp;&nbsp;&nbsp;  /dev/mapper/cl-swap&nbsp;&nbsp; swap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap&nbsp;&nbsp;defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>[root@kvmcentos ~]# vim /etc/fstab<br>[root@kvmcentos ~]# cat /etc/fstab<br>&nbsp;&nbsp;&nbsp;&nbsp;  #<br>&nbsp;&nbsp;&nbsp;&nbsp;  # /etc/fstab<br>&nbsp;&nbsp;&nbsp;&nbsp;  # Created by anaconda on Wed Mar 11 22:00:21 2020<br>&nbsp;&nbsp;&nbsp;&nbsp;  #<br>&nbsp;&nbsp;&nbsp;&nbsp;  # Accessible filesystems, by reference, are maintained under '/dev/disk/'.<br>&nbsp;&nbsp;&nbsp;&nbsp;  # See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.<br>&nbsp;&nbsp;&nbsp;&nbsp;  #<br>&nbsp;&nbsp;&nbsp;&nbsp;  # After editing this file, run 'systemctl daemon-reload' to update systemd<br>&nbsp;&nbsp;&nbsp;&nbsp;  # units generated from this file.<br>&nbsp;&nbsp;&nbsp;&nbsp;  #<br>&nbsp;&nbsp;&nbsp;&nbsp;  /dev/mapper/cl-root&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   xfs&nbsp;&nbsp; defaults,uquota,gquota&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>&nbsp;&nbsp;&nbsp;&nbsp;  UUID=4df72e4b-4c08-4a34-bc25-d54c30527016 /boot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   ext4&nbsp;&nbsp;defaults&nbsp;&nbsp;&nbsp;&nbsp;1 2<br>&nbsp;&nbsp;&nbsp;&nbsp;  /dev/mapper/cl-swap&nbsp;&nbsp; swap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap&nbsp;&nbsp;defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>[root@kvmcentos ~]# mount -o remount /<br>[root@kvmcentos ~]# ls -la /<br>&nbsp;&nbsp;&nbsp;&nbsp;  итого 2636<br>&nbsp;&nbsp;&nbsp;&nbsp;  dr-xr-xr-x.  18 root root&nbsp;&nbsp; 271 апр  9 21:36 .<br>&nbsp;&nbsp;&nbsp;&nbsp;  dr-xr-xr-x.  18 root root&nbsp;&nbsp; 271 апр  9 21:36 ..<br>&nbsp;&nbsp;&nbsp;&nbsp;  lrwxrwxrwx.   1 root root&nbsp;&nbsp;   7 мая 10  2019 bin -&gt; usr/bin<br>&nbsp;&nbsp;&nbsp;&nbsp;  dr-xr-xr-x.   6 root root&nbsp;&nbsp;4096 апр 16 08:32 boot<br>&nbsp;&nbsp;&nbsp;&nbsp;  drwxr-xr-x.  20 root root&nbsp;&nbsp;3200 апр 17 19:49 dev<br>&nbsp;&nbsp;&nbsp;&nbsp;  drwxr-xr-x. 144 root root&nbsp;&nbsp;8192 апр 17 21:29 etc<br>&nbsp;&nbsp;&nbsp;&nbsp;  drwxr-xr-x.   4 root root&nbsp;&nbsp;  36 апр 10 00:34 home<br>&nbsp;&nbsp;&nbsp;&nbsp;  lrwxrwxrwx.   1 root root&nbsp;&nbsp;   7 мая 10  2019 lib -&gt; usr/lib<br>&nbsp;&nbsp;&nbsp;&nbsp;  lrwxrwxrwx.   1 root root&nbsp;&nbsp;   9 мая 10  2019 lib64 -&gt; usr/lib64<br>&nbsp;&nbsp;&nbsp;&nbsp;  drwxr-xr-x.   3 root root&nbsp;&nbsp;  18 мар 12 02:00 media<br>&nbsp;&nbsp;&nbsp;&nbsp;  drwxr-xr-x.   2 root root&nbsp;&nbsp;   6 мая 10  2019 mnt<br>&nbsp;&nbsp;&nbsp;&nbsp;  drwxr-xr-x.   3 root root&nbsp;&nbsp;  38 мар 12 02:07 opt<br>&nbsp;&nbsp;&nbsp;&nbsp;  dr-xr-xr-x. 271 root root&nbsp;&nbsp;   0 апр 17 19:48 proc<br>&nbsp;&nbsp;&nbsp;&nbsp;  dr-xr-x---.   8 root root&nbsp;&nbsp;4096 апр 17 21:29 root<br>&nbsp;&nbsp;&nbsp;&nbsp;  drwxr-xr-x.  43 root root&nbsp;&nbsp;1300 апр 17 19:54 run<br>&nbsp;&nbsp;&nbsp;&nbsp;  lrwxrwxrwx.   1 root root&nbsp;&nbsp;   8 мая 10  2019 sbin -&gt; usr/sbin<br>&nbsp;&nbsp;&nbsp;&nbsp;  drwxr-xr-x.   2 root root&nbsp;&nbsp;   6 мая 10  2019 srv<br>&nbsp;&nbsp;&nbsp;&nbsp;  drwxr-xr-x.   3 root root&nbsp;&nbsp;  20 апр  9 21:36 svn<br>&nbsp;&nbsp;&nbsp;&nbsp;  dr-xr-xr-x.  13 root root&nbsp;&nbsp;   0 апр 17 19:48 sys<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--.   1 root root 2670569 мар 12 02:28 @System.solv<br>&nbsp;&nbsp;&nbsp;&nbsp;  drwxrwxrwt.  20 root root&nbsp;&nbsp;4096 апр 17 21:30 tmp<br>&nbsp;&nbsp;&nbsp;&nbsp;  drwxr-xr-x.  12 root root&nbsp;&nbsp; 144 мар 11 22:13 usr<br>&nbsp;&nbsp;&nbsp;&nbsp;  drwxr-xr-x.  22 root root&nbsp;&nbsp;4096 апр 10 02:22 var<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-------.   1 root root&nbsp;&nbsp;   0 апр 17 19:50 VBox.log<br>[root@kvmcentos ~]# mount | grep quota<br>&nbsp;&nbsp;&nbsp;&nbsp;  /dev/mapper/cl-root on / type xfs (rw,relatime,seclabel,attr2,inode64,noquota)<br>[root@kvmcentos ~]# cat /etc/default/grub<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_TIMEOUT=5<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_DISTRIBUTOR="$(sed 's, release .*$,,g' /etc/system-release)"<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_DEFAULT=saved<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_DISABLE_SUBMENU=true<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_TERMINAL_OUTPUT="console"<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_CMDLINE_LINUX="crashkernel=auto resume=/dev/mapper/cl-swap rd.lvm.lv=cl/root rd.lvm.lv=cl/swap rhgb quiet"<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_DISABLE_RECOVERY="true"<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_ENABLE_BLSCFG=true<br>[root@kvmcentos ~]# vim /etc/default/grub<br>[root@kvmcentos ~]# cat /etc/default/grub<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_TIMEOUT=5<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_DISTRIBUTOR="$(sed 's, release .*$,,g' /etc/system-release)"<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_DEFAULT=saved<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_DISABLE_SUBMENU=true<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_TERMINAL_OUTPUT="console"<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_CMDLINE_LINUX="crashkernel=auto resume=/dev/mapper/cl-swap rd.lvm.lv=cl/root rd.lvm.lv=cl/swap rhgb quiet rootflags=uquota,gquota"<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_DISABLE_RECOVERY="true"<br>&nbsp;&nbsp;&nbsp;&nbsp;  GRUB_ENABLE_BLSCFG=true<br>[root@kvmcentos ~]# cp /boot/grub2/grub.cfg /boot/grub2/grub.cfg.backup<br>[root@kvmcentos ~]# grub2-mkconfig -o /boot/grub2/grub.cfg<br>&nbsp;&nbsp;&nbsp;&nbsp;  Generating grub configuration file ...<br>&nbsp;&nbsp;&nbsp;&nbsp;  done<br>[root@kvmcentos ~]# shutdown -r now<br>[root@kvmcentos ~]# mount | grep quota<br>&nbsp;&nbsp;&nbsp;&nbsp;  /dev/mapper/cl-root on / type xfs (rw,relatime,seclabel,attr2,inode64,usrquota,grpquota)<br>[root@kvmcentos ~]# quotacheck -cug<br>[root@kvmcentos ~]# ls -l /home/<br>&nbsp;&nbsp;&nbsp;&nbsp;  total 56<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw------- 1 root root 7168 Dec 10 16:28 aquota.group<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw------- 1 root root 7168 Dec 10 16:28 aquota.user<br>&nbsp;&nbsp;&nbsp;&nbsp;  …<br>[root@kvmcentos ~]# quotacheck -avug<br>&nbsp;&nbsp;&nbsp;&nbsp;  quotacheck: Scanning /dev/mapper/VolGroup00-LogVol02 [/home] done<br>&nbsp;&nbsp;&nbsp;&nbsp;  quotacheck: Checked 5 directories and 10 files<br>[root@kvmcentos ~]# xfs_quota -x<br>  xfs_quota&gt; state<br>&nbsp;&nbsp;&nbsp;&nbsp;  User quota state on / (/dev/mapper/cl-root)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accounting: ON<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Enforcement: ON<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Inode: #638160 (6 blocks, 6 extents)<br>&nbsp;&nbsp;&nbsp;&nbsp;  Group quota state on / (/dev/mapper/cl-root)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accounting: ON<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Enforcement: ON<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Inode: #638161 (7 blocks, 6 extents)<br>&nbsp;&nbsp;&nbsp;&nbsp;  Project quota state on / (/dev/mapper/cl-root)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accounting: OFF<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Enforcement: OFF<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Inode: N/A<br>&nbsp;&nbsp;&nbsp;&nbsp;  Blocks grace time: [7 days]<br>&nbsp;&nbsp;&nbsp;&nbsp;  Inodes grace time: [7 days]<br>&nbsp;&nbsp;&nbsp;&nbsp;  Realtime Blocks grace time: [7 days]<br>[root@kvmcentos ~]# useradd user1<br>[root@kvmcentos ~]# passwd user1<br>&nbsp;&nbsp;&nbsp;&nbsp;  Изменение пароля пользователя user1.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Новый пароль :<br>&nbsp;&nbsp;&nbsp;&nbsp;  Повторите ввод нового пароля :<br>&nbsp;&nbsp;&nbsp;&nbsp;  passwd: данные аутентификации успешно обновлены.<br>[root@kvmcentos ~]# cat /etc/group<br>&nbsp;&nbsp;&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;&nbsp;&nbsp;  user1:x:1002:<br>[root@kvmcentos ~]# edquota user1<br>&nbsp;&nbsp;&nbsp;&nbsp;  Disk quotas for user user1 (uid 1002):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filesystem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   blocks&nbsp;&nbsp;   soft&nbsp;&nbsp;   hard&nbsp;&nbsp; inodes&nbsp;&nbsp; soft&nbsp;&nbsp; hard<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/dev/mapper/cl-root&nbsp;&nbsp;&nbsp;&nbsp;   15284&nbsp;&nbsp;&nbsp;&nbsp;  0&nbsp;&nbsp;&nbsp;&nbsp;  0&nbsp;&nbsp;&nbsp;&nbsp;167&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;0<br>[root@kvmcentos ~]# edquota user1<br>&nbsp;&nbsp;&nbsp;&nbsp;  Disk quotas for user user1 (uid 1002):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filesystem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   blocks&nbsp;&nbsp;   soft&nbsp;&nbsp;   hard&nbsp;&nbsp; inodes&nbsp;&nbsp; soft&nbsp;&nbsp; hard<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/dev/mapper/cl-root&nbsp;&nbsp;&nbsp;&nbsp;   15284&nbsp;&nbsp; 100000&nbsp;&nbsp; 100000&nbsp;&nbsp;&nbsp;&nbsp;167&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;0<br>[root@kvmcentos ~]# su - user1<br>[user1@linux ~]$ rm -rf *<br>[user1@linux ~]$ yes &gt; text.txt<br>&nbsp;&nbsp;  ^C<br>[user1@linux ~]$ ls -lh<br>&nbsp;&nbsp;&nbsp;&nbsp;  total 1.6G<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-rw-r--. 1 user1 user1 1.6G Apr 17 23:44 text.txt<br>[user1@linux ~]$ rm -rf text.txt<br>[user1@linux ~]$ ls -lh<br>&nbsp;&nbsp;&nbsp;&nbsp;  total 0<br>[user1@linux ~]$ exit<br>[root@kvmcentos ~]# quotaon /<br>&nbsp;&nbsp;&nbsp;&nbsp;  quotaon: Enable XFS project quota accounting during mount<br>[root@kvmcentos ~]# su - user1<br>[user1@linux ~]$ rm -rf text.txt<br>[user1@linux ~]$ yes &gt; text.txt<br>&nbsp;&nbsp;&nbsp;&nbsp;  yes: standard output: Disk quota exceeded<br>[user1@linux ~]$ ls -lh<br>&nbsp;&nbsp;&nbsp;&nbsp;  total 87M<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-rw-r--. 1 user1 user1 87M Apr 17 23:47 text.txt<br>[root@kvmcentos ~]# repquota -a<br>&nbsp;&nbsp;&nbsp;&nbsp;  *** Report for user quotas on device /dev/mapper/cl-root<br>&nbsp;&nbsp;&nbsp;&nbsp;  Block grace time: 7days; Inode grace time: 7days<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Block limits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File limits<br>&nbsp;&nbsp;&nbsp;&nbsp;  User&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;used&nbsp;&nbsp;soft&nbsp;&nbsp;hard  grace&nbsp;&nbsp;used  soft  hard  grace<br>&nbsp;&nbsp;&nbsp;&nbsp;  ----------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;  root&nbsp;&nbsp;  -- 7098892&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp; 185318&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  lp&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  1&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  tss&nbsp;&nbsp;   --&nbsp;&nbsp;   8&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  2&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  polkitd   --&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  2&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  geoclue   --&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  1&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  unbound   --&nbsp;&nbsp;   4&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  2&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  qemu&nbsp;&nbsp;  --&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  9&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  rpc&nbsp;&nbsp;   --&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  2&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  chrony&nbsp;&nbsp;--&nbsp;&nbsp;   4&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  3&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  setroubleshoot --&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  3&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  sssd&nbsp;&nbsp;  --   73912&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 20&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  colord&nbsp;&nbsp;--&nbsp;&nbsp;  44&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  5&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  rpcuser   --&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  3&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  gdm&nbsp;&nbsp;   --&nbsp;&nbsp; 244&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 37&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  Centos&nbsp;&nbsp;--  386752&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;  11232&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  bestuser  --&nbsp;&nbsp;  16&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  9&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  dhcpd&nbsp;&nbsp; --&nbsp;&nbsp;   8&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  4&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  mysql&nbsp;&nbsp; --  147940&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;131&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  named&nbsp;&nbsp; --&nbsp;&nbsp;  48&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  user1&nbsp;&nbsp; --  100000  100000  100000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;160&nbsp;&nbsp; 0&nbsp;&nbsp; 0<br>[root@kvmcentos ~]# groupadd managers<br>[root@kvmcentos ~]# cat /etc/group<br>&nbsp;&nbsp;&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;&nbsp;&nbsp;  user1:x:1002:<br>&nbsp;&nbsp;&nbsp;&nbsp;  managers:x:1003:<br>[root@kvmcentos ~]# edquota -g managers<br>&nbsp;&nbsp;&nbsp;&nbsp;  Disk quotas for group managers (gid 1003):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filesystem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   blocks&nbsp;&nbsp;   soft&nbsp;&nbsp;   hard&nbsp;&nbsp; inodes&nbsp;&nbsp; soft&nbsp;&nbsp; hard<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/dev/mapper/cl-root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;  0&nbsp;&nbsp;&nbsp;&nbsp;  0&nbsp;&nbsp;&nbsp;&nbsp;  0&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;0<br>[root@kvmcentos ~]# edquota -g managers<br>&nbsp;&nbsp;&nbsp;&nbsp;  Disk quotas for group managers (gid 1003):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filesystem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   blocks&nbsp;&nbsp;   soft&nbsp;&nbsp;   hard&nbsp;&nbsp; inodes&nbsp;&nbsp; soft&nbsp;&nbsp; hard<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/dev/mapper/cl-root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   0&nbsp;&nbsp; 200000&nbsp;&nbsp; 200000&nbsp;&nbsp;&nbsp;&nbsp;  0&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;0<br>[root@kvmcentos ~]# useradd user3<br>[root@kvmcentos ~]# passwd user3<br>&nbsp;&nbsp;&nbsp;&nbsp;  Изменение пароля пользователя user3.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Новый пароль :<br>&nbsp;&nbsp;&nbsp;&nbsp;  Повторите ввод нового пароля :<br>&nbsp;&nbsp;&nbsp;&nbsp;  passwd: данные аутентификации успешно обновлены.<br>[root@kvmcentos ~]# id user3<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid=1003(user3) gid=1004(user3) группы=1004(user3)<br>[root@kvmcentos ~]# cat /etc/group<br>&nbsp;&nbsp;&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;&nbsp;&nbsp;  user1:x:1002:<br>&nbsp;&nbsp;&nbsp;&nbsp;  managers:x:1003:<br>&nbsp;&nbsp;&nbsp;&nbsp;  user3:x:1004:<br>[root@kvmcentos ~]# usermod -a -G managers user3<br>[root@kvmcentos ~]# cat /etc/group<br>&nbsp;&nbsp;&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;&nbsp;&nbsp;  user1:x:1002:<br>&nbsp;&nbsp;&nbsp;&nbsp;  managers:x:1003:user3<br>&nbsp;&nbsp;&nbsp;&nbsp;  user3:x:1004:<br>[root@kvmcentos ~]# id user3<br>&nbsp;&nbsp;&nbsp;&nbsp;  uid=1003(user3) gid=1004(user3) группы=1004(user3),1003(managers)<br>[root@kvmcentos ~]# chown -R user3:managers /home/user3<br>[root@kvmcentos ~]# quotaon /<br>&nbsp;&nbsp;&nbsp;&nbsp;  quotaon: Enforcing group quota already on /dev/mapper/cl-root<br>&nbsp;&nbsp;&nbsp;&nbsp;  quotaon: Enforcing user quota already on /dev/mapper/cl-root<br>&nbsp;&nbsp;&nbsp;&nbsp;  quotaon: Enable XFS project quota accounting during mount<br>[root@kvmcentos ~]# quota -g managers<br>&nbsp;&nbsp;&nbsp;&nbsp;  Disk quotas for group managers (gid 502):<br>&nbsp;&nbsp;&nbsp;&nbsp;  Filesystem blocks quota limit grace files quota limit grace<br>&nbsp;&nbsp;&nbsp;&nbsp;  /dev/mapper/VolGroup00-LogVol02<br>&nbsp;&nbsp;&nbsp;&nbsp;  40 200000 200000 5 0 0<br>[root@kvmcentos ~]# su - user3<br>[user3@linuxbox ~]$ groups<br>&nbsp;&nbsp;&nbsp;&nbsp;  managers<br>[user3@linuxbox ~]$ yes &gt; text.txt<br>&nbsp;&nbsp;&nbsp;&nbsp;  dm-1: write failed, group block limit reached.<br>&nbsp;&nbsp;&nbsp;&nbsp;  yes: standard output: Disk quota exceeded<br>&nbsp;&nbsp;&nbsp;&nbsp;  yes: write error<br>[user3@linuxbox ~]$ ls -lh<br>&nbsp;&nbsp;&nbsp;&nbsp;  total 196M<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r-- 1 user3 managers 196M Dec 10 18:48 text.txt<br>[root@kvmcentos ~]# useradd dmosk<br>[root@kvmcentos ~]# passwd dmosk<br>&nbsp;&nbsp;&nbsp;&nbsp;  Изменение пароля пользователя dmosk.<br>&nbsp;&nbsp;&nbsp;&nbsp;  Новый пароль :<br>&nbsp;&nbsp;&nbsp;&nbsp;  Повторите ввод нового пароля :<br>&nbsp;&nbsp;&nbsp;&nbsp;  passwd: данные аутентификации успешно обновлены.<br>[root@kvmcentos ~]# quota -p dmosk user1<br>&nbsp;&nbsp;&nbsp;&nbsp;  Disk quotas for user dmosk (uid 1004): none<br>&nbsp;&nbsp;&nbsp;&nbsp;  Disk quotas for user user1 (uid 1002):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Filesystem  blocks   quota   limit   grace   files   quota   limit   grace<br>&nbsp;&nbsp;&nbsp;&nbsp;  /dev/mapper/cl-root<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   100000* 100000  100000&nbsp;&nbsp;   0&nbsp;&nbsp; 160&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0<br>[root@kvmcentos ~]# su - dmosk<br>[dmosk@linux ~]$ dd if=/dev/zero of=/tmp/tmp_dmosk_file bs=1024000 count=100<br>&nbsp;&nbsp;&nbsp;&nbsp;  dd: ошибка записи «/tmp/tmp_dmosk_file»: Превышена дисковая квота<br>&nbsp;&nbsp;&nbsp;&nbsp;  11+0 записей получено<br>&nbsp;&nbsp;&nbsp;&nbsp;  10+0 записей отправлено<br>&nbsp;&nbsp;&nbsp;&nbsp;   скопировано 10240000 байт (10 MB), 0,223768 c, 45,8 MB/c<br>[root@kvmcentos ~]# repquota -a<br>&nbsp;&nbsp;&nbsp;&nbsp;  *** Report for user quotas on device /dev/mapper/cl-root<br>&nbsp;&nbsp;&nbsp;&nbsp;  Block grace time: 7days; Inode grace time: 7days<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Block limits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File limits<br>&nbsp;&nbsp;&nbsp;&nbsp;  User&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;used&nbsp;&nbsp;soft&nbsp;&nbsp;hard  grace&nbsp;&nbsp;used  soft  hard  grace<br>&nbsp;&nbsp;&nbsp;&nbsp;  ----------------------------------------------------------------------<br>&nbsp;&nbsp;&nbsp;&nbsp;  root&nbsp;&nbsp;  -- 7219432&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp; 186118&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  lp&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  1&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  tss&nbsp;&nbsp;   --&nbsp;&nbsp;   8&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  2&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  polkitd   --&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  2&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  geoclue   --&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  1&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  unbound   --&nbsp;&nbsp;   4&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  2&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  qemu&nbsp;&nbsp;  --&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  9&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  rpc&nbsp;&nbsp;   --&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  2&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  chrony&nbsp;&nbsp;--&nbsp;&nbsp;   4&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  3&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  setroubleshoot --&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  3&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  sssd&nbsp;&nbsp;  --  113020&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 25&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  colord&nbsp;&nbsp;--&nbsp;&nbsp;  44&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  5&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  rpcuser   --&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  3&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  gdm&nbsp;&nbsp;   --&nbsp;&nbsp; 244&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 37&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  Centos&nbsp;&nbsp;--  400168&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;  11741&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  bestuser  --&nbsp;&nbsp;  16&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  9&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  dhcpd&nbsp;&nbsp; --&nbsp;&nbsp;   8&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  4&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  mysql&nbsp;&nbsp; --  147940&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;131&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  named&nbsp;&nbsp; --&nbsp;&nbsp;  48&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  user1&nbsp;&nbsp; --  100000  100000  100000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;160&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp;   <br>&nbsp;&nbsp;&nbsp;&nbsp;  user3&nbsp;&nbsp; --&nbsp;&nbsp;  20&nbsp;&nbsp;   0&nbsp;&nbsp;   0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10&nbsp;&nbsp; 0&nbsp;&nbsp; 0  <br>[root@kvmcentos ~]# quota -g managers<br>&nbsp;&nbsp;&nbsp;&nbsp;  Disk quotas for group managers (gid 1003):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Filesystem  blocks   quota   limit   grace   files   quota   limit   grace<br>&nbsp;&nbsp;&nbsp;&nbsp;  /dev/mapper/cl-root<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   16   20000   20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   8&nbsp;&nbsp;   0&nbsp;&nbsp;   0   <br>[root@kvmcentos ~]# edquota -t<br>&nbsp;&nbsp;&nbsp;&nbsp;  Grace period before enforcing soft limits for users:<br>&nbsp;&nbsp;&nbsp;&nbsp;  Time units may be: days, hours, minutes, or seconds<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filesystem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Block grace period&nbsp;&nbsp; Inode grace period<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/dev/mapper/cl-root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  7days&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  7days<br>[root@kvmcentos ~]# edquota -t<br>&nbsp;&nbsp;&nbsp;&nbsp;  Grace period before enforcing soft limits for users:<br>&nbsp;&nbsp;&nbsp;&nbsp;  Time units may be: days, hours, minutes, or seconds<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filesystem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Block grace period&nbsp;&nbsp; Inode grace period<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/dev/mapper/cl-root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  8days&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  9days<br><strong>Source:</strong><br># https://www.youtube.com/watch?v=UbGpdwbQUU8&list=PL76C3E97EB0FDB323&index=17&t=0s<br># https://www.dmosk.ru/miniinstruktions.php?mini=quota-linux<br><strong>Task:</strong><br>Сетевая файловая система - NFS.<br>Скорее всего NFS уже есть в системе. Если же nfs в системе не обнаружен то ставим из репозитория.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# yum list | grep nfs<br>[root@kvmcentos ~]# yum -y install nfs-utils<br>[root@kvmcentos ~]# systemctl enable nfs-s.<br>[root@kvmcentos ~]# systemctl start nfs-s<br>[root@kvmcentos ~]# systemctl status nfs-s<br><strong>Task:</strong><br>В своей работе NFS использует RPC-вызовы, а значит работоспособность службы можно проверить с помощью portmapper (он тоже должен быть запущен на сервере где выполняются программы использующие RPC Calls).<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# rpcinfo -p localhost | grep nfs<br>  100003 3 tcp 2049 nfs<br>  100003 4 tcp 2049 nfs<br>  100227 3 tcp 2049 nfs_acl<br>[root@kvmcentos ~]# rpcinfo -p localhost<br>  program vers proto port service<br>  100000 4 tcp 111 portmapper<br>  100000 3 tcp 111 portmapper<br>  100000 2 tcp 111 portmapper<br>  100000 4 udp 111 portmapper<br>  100000 3 udp 111 portmapper<br>  100000 2 udp 111 portmapper<br>  100005 1 udp 20048 mountd<br>  100005 1 tcp 20048 mountd<br>  100005 2 udp 20048 mountd<br>  100005 2 tcp 20048 mountd<br>  100005 3 udp 20048 mountd<br>  100005 3 tcp 20048 mountd<br>  100024 1 udp 35314 status<br>  100024 1 tcp 45161 status<br>  100003 3 tcp 2049 nfs<br>  100003 4 tcp 2049 nfs<br>  100227 3 tcp 2049 nfs_acl<br>  100021 1 udp 48717 nlockmgr<br>  100021 3 udp 48717 nlockmgr<br>  100021 4 udp 48717 nlockmgr<br>  100021 1 tcp 35773 nlockmgr<br>  100021 3 tcp 35773 nlockmgr<br>  100021 4 tcp 35773 nlockmgr<br><strong>Task:</strong><br>Сделаем так чтобы при включении kvmubuntu автоматически монтировался. разрешим монтировать /home на сервере tipubuntu в режиме rw. То есть, что вы хотите отдавать(home), кому (tipubuntu), какие права (rw).<br>- Проверим список экспортированных файловая система.<br>- Перечитываем файл чтобы внесенные изменения начали действовать.<br>- Проверим список экспортированных файловая система<br>- на сервере tipubuntu попробуем примонтировать файловая система /home экспортированную на tipcentos. <br>- Создаем каталог куда будем монтировать.<br>- Монитруем<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ifconfig<br>...<br>tipubuntu<br>[root@kvmcentos ~]# vim /etc/exports<br>[root@kvmcentos ~]# cat /etc/exports<br>/home tipubuntu(rw,no_root_squash)<br>[root@kvmcentos ~]# exportfs<br>[root@kvmcentos ~]# exportfs -r<br>[root@kvmcentos ~]# exportfs<br>/home tipubuntu<br>root@kvmubuntu:~# mkdir /mnt/nfs<br>[root@kvmcentos ~]# ifconfig<br>...<br>tipcentos<br>...<br>[root@kvmcentos ~]# ls -l /home<br>итого 8<br>drwx------. 3 bestuser bestuser 92 апр 10 00:34 bestuser<br>drwx------. 18 Centos Centos 4096 апр 26 20:44 Centos<br>drwx------. 3 dmosk dmosk 113 апр 18 00:46 dmosk<br>drwx------. 4 sk sk 145 апр 20 22:50 sk<br>drwx------. 8 user1 user1 4096 апр 24 09:58 user1<br>drwx------. 3 user3 managers 113 апр 18 00:28 user3<br>drwx------. 4 webby webby 111 апр 24 09:58 webby<br>root@kvmubuntu:~# apt-get -y install nfs-common<br>root@kvmubuntu:~# nmap tipcentos<br>...<br>  PORT STATE SERVICE<br>  21/tcp open ftp<br>  22/tcp open ssh<br>  23/tcp open telnet<br>  25/tcp closed smtp<br>  53/tcp closed domain<br>  80/tcp closed http<br>  143/tcp closed imap<br>  443/tcp closed https<br>[root@kvmcentos ~]# cat /etc/sysconfig/iptables<br>Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>...<br>-A INPUT -i lo -j ACCEPT<br>-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT<br>-A INPUT -p tcp -m multiport --dports 21 -j ACCEPT<br>-A INPUT -p tcp -m multiport --dports 22 -j ACCEPT<br>-A INPUT -p tcp -m state --state NEW --dport 23 -j ACCEPT<br>-A INPUT -p tcp -m multiport --dports 25 -j ACCEPT<br>-A INPUT -p tcp -m multiport --dports 53 -j ACCEPT<br>-A INPUT -p tcp -m multiport --dports 80 -j ACCEPT<br>-A INPUT -p tcp -m multiport --dports 143 -j ACCEPT<br>-A INPUT -p tcp -m multiport --dports 443 -j ACCEPT<br>-A INPUT -p udp -m multiport --dports 53 -j ACCEPT<br>-A INPUT -p udp -m multiport --dports 21 -j ACCEPT<br>-A INPUT -p udp -m multiport --dports 20 -j ACCEPT<br>-A INPUT -p udp -m multiport --dports 69 -j ACCEPT<br>-A INPUT -p icmp -m icmp --icmp-type 0 -j ACCEPT<br>-A Сonclusion -o lo -j ACCEPT<br>-A Сonclusion -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT<br>COMMIT<br># Completed on Sun Apr 12 01:33:36 2020<br>[root@kvmcentos ~]# vim /etc/sysconfig/iptables<br>[root@kvmcentos ~]# cat /etc/sysconfig/iptables<br>...<br>-A INPUT -p tcp -m multiport --dports 2049 -j ACCEPT<br>[root@kvmcentos ~]# systemctl restart iptables.service<br>root@kvmubuntu:~# nmap tipcentos<br>...<br>  2049/tcp open nfs<br>root@kvmubuntu:~# mount -t nfs tipcentos:/home /mnt/nfs<br><strong>Task:</strong><br>Теперь проверим каталоги у двух систем. Посмотрим, что примонтированно в системе.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ls -l /mnt/nfs<br>  итого 8<br>  drwx------ 3 1001 1001 92 апр 10 07:34 bestuser<br>  drwx------ 18 linux linux 4096 апр 27 03:44 Centos<br>  drwx------ 3 1004 1005 113 апр 18 07:46 dmosk<br>  drwx------ 4 1006 1007 145 апр 21 05:50 sk<br>  drwx------ 8 1002 1002 4096 апр 24 16:58 user1<br>  drwx------ 3 1003 1003 113 апр 18 07:28 user3<br>  drwx------ 4 1007 1008 111 апр 24 16:58 webby<br>[root@kvmcentos ~]# ls -l /home<br>  итого 8<br>  drwx------. 3 bestuser bestuser 92 апр 10 00:34 bestuser<br>  drwx------. 18 Centos Centos 4096 апр 26 20:44 Centos<br>  drwx------. 3 dmosk dmosk 113 апр 18 00:46 dmosk<br>  drwx------. 4 sk sk 145 апр 20 22:50 sk<br>  drwx------. 8 user1 user1 4096 апр 24 09:58 user1<br>  drwx------. 3 user3 managers 113 апр 18 00:28 user3<br>  drwx------. 4 webby webby 111 апр 24 09:58 webby<br>[root@kvmcentos ~]# vim /home/myestfile.txt<br>[root@kvmcentos ~]# cat /home/myestfile.txt<br>  hust text<br>[root@kvmcentos ~]# ls -l /home<br>  итого 12<br>  drwx------. 3 bestuser bestuser 92 апр 10 00:34 bestuser<br>  drwx------. 18 Centos Centos 4096 апр 26 20:44 Centos<br>  drwx------. 3 dmosk dmosk 113 апр 18 00:46 dmosk<br>  -rw-r--r--. 1 root root 10 апр 26 22:17 myestfile.txt<br>  drwx------. 4 sk sk 145 апр 20 22:50 sk<br>  drwx------. 8 user1 user1 4096 апр 24 09:58 user1<br>  drwx------. 3 user3 managers 113 апр 18 00:28 user3<br>  drwx------. 4 webby webby 111 апр 24 09:58 webby<br>root@kvmubuntu:~# ls -l /mnt/nfs<br>  итого 12<br>  drwx------ 3 1001 1001 92 апр 10 07:34 bestuser<br>  drwx------ 18 linux linux 4096 апр 27 03:44 Centos<br>  drwx------ 3 1004 1005 113 апр 18 07:46 dmosk<br>  -rw-r--r-- 1 root root 10 апр 27 05:17 myestfile.txt<br>  drwx------ 4 1006 1007 145 апр 21 05:50 sk<br>  drwx------ 8 1002 1002 4096 апр 24 16:58 user1<br>  drwx------ 3 1003 1003 113 апр 18 07:28 user3<br>  drwx------ 4 1007 1008 111 апр 24 16:58 webby<br>root@kvmubuntu:~# mount<br>  ...<br>  tipcentos:/home on /mnt/nfs type nfs4 (rw,relatime,vers=4.2,rsize=524288,wsize=524288,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=tip,local_lock=none,addr=tipcentos)<br>root@kvmubuntu:~# vim /mnt/nfs/myestfile.txt<br>root@kvmubuntu:~# cat /mnt/nfs/myestfile.txt<br>  hust text<br>  new line<br>[root@kvmcentos ~]# cat /home/myestfile.txt<br>  hust text<br>  new line<br><strong>Task:</strong><br>Если файловая система экспортированы на сервере, который работает круглосуточно (24 часа в сутки) то монтирование разделов можно добавить в конце /etc/fstab тем самым автоматизировав процедуру при старте компьютера.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# ifconfig<br>...<br>tipcentos<br>...<br>root@kvmubuntu:~# cat /etc/fstab<br>/etc/fstab: static file system information.<br>#<br># Use 'blkid' to print the universally unique identifier for a<br># device; this may be used with UUID= as a more robust way to name devices<br># that works even if disks are added and removed. See fstab(5).<br>#<br># &lt;file system&gt; &lt;mount point&gt; &lt;type&gt; &lt;options&gt; &lt;dump&gt; &lt;pass&gt;<br># / was on /dev/sda1 during installation<br>UUID=4020996d-6502-4a36-b7bc-aec4a74d5aa9 / ext4 errors=remount-ro 0 1<br>/swapfile none swap sw 0 0<br>root@kvmubuntu:~# vim /etc/fstab<br>root@kvmubuntu:~# cat /etc/fstab<br>/etc/fstab: static file system information.<br>#<br># Use 'blkid' to print the universally unique identifier for a<br># device; this may be used with UUID= as a more robust way to name devices<br># that works even if disks are added and removed. See fstab(5).<br>#<br># &lt;file system&gt; &lt;mount point&gt; &lt;type&gt; &lt;options&gt; &lt;dump&gt; &lt;pass&gt;<br># / was on /dev/sda1 during installation<br>UUID=4020996d-6502-4a36-b7bc-aec4a74d5aa9 / ext4 errors=remount-ro 0 1<br>/swapfile none swap sw 0 0<br>tipcentos:/home /mnt/nfs nfs defaults 0 0<br><strong>Task:</strong><br>Еще пример монтирования шара. Здесь допустим нету никаких секретов, поэтому сделаем этот файл доcтупным для всех. то есть всем разрешено его монтировать.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# mkdir /mnt/share<br>root@kvmubuntu:~# vim /mnt/share/share.txt<br>root@kvmubuntu:~# cat /mnt/share/share.txt<br>  for share<br>root@kvmubuntu:~# apt list | grep nfs<br>  ...<br>  nfs-common/bionic-updates,now 1:1.3.4-2.1ubuntu5.2 amd64 [установлен]<br>  ...<br>  nfs-kernel-s/bionic-updates 1:1.3.4-2.1ubuntu5.2 amd64<br>  ...<br>root@kvmubuntu:~# apt install -y nfs-kernel-s<br>root@kvmubuntu:~# systemctl enable nfs-kernel-s<br>root@kvmubuntu:~# systemctl start nfs-kernel-s<br>root@kvmubuntu:~# systemctl status nfs-kernel-s<br>  ● nfs-s.service - NFS s and services<br>  Loaded: loaded (/lib/systemd/system/nfs-s.service; enabled; vendor preset: enabled)<br>  Active: active (exited) since Mon 2020-04-27 05:34:56 MSK; 2min 14s ago<br>  Main PID: 5681 (code=exited, status=0/SUCCESS)<br>  Tasks: 0 (limit: 2327)<br>  CGroup: /system.slice/nfs-s.service<br>  апр 27 05:34:54 kvmubuntu systemd[1]: Starting NFS s and services...<br>  апр 27 05:34:56 kvmubuntu systemd[1]: Started NFS s and services.<br>root@kvmubuntu:~# rpcinfo -p localhost<br>  program vers proto port service<br>  100000 4 tcp 111 portmapper<br>  100000 3 tcp 111 portmapper<br>  100000 2 tcp 111 portmapper<br>  100000 4 udp 111 portmapper<br>  100000 3 udp 111 portmapper<br>  100000 2 udp 111 portmapper<br>  100005 1 udp 33609 mountd<br>  100005 1 tcp 35179 mountd<br>  100005 2 udp 53486 mountd<br>  100005 2 tcp 36927 mountd<br>  100005 3 udp 51351 mountd<br>  100005 3 tcp 48353 mountd<br>  100003 3 tcp 2049 nfs<br>  100003 4 tcp 2049 nfs<br>  100227 3 tcp 2049<br>  100003 3 udp 2049 nfs<br>  100227 3 udp 2049<br>  100021 1 udp 55641 nlockmgr<br>  100021 3 udp 55641 nlockmgr<br>  100021 4 udp 55641 nlockmgr<br>  100021 1 tcp 45397 nlockmgr<br>  100021 3 tcp 45397 nlockmgr<br>  100021 4 tcp 45397 nlockmgr<br>root@kvmubuntu:~# vim /etc/exports<br>root@kvmubuntu:~# cat /etc/exports<br>/mnt/share *(rw)<br>root@kvmubuntu:~# exportfs -r<br>  exportfs: /etc/exports [1]: Neither 'subtree_check' or 'no_subtree_check' specified for export "*:/mnt/share".<br>  Assuming default behaviour ('no_subtree_check').<br>  NOTE: this default has changed since nfs-utils version 1.0.x<br>root@kvmubuntu:~# exportfs<br>  /mnt/share &lt;world&gt;<br>root@kvmubuntu:~# ifconfig<br>...<br>tipubuntu<br>[root@kvmcentos ~]# ls -l /mnt/<br>[root@kvmcentos ~]# mount -t nfs tipubuntu:/mnt/share /mnt<br>[root@kvmcentos ~]# ls -l /mnt/<br>  итого 4<br>  -rw-r--r--. 1 root root 10 апр 26 22:27 share.txt<br>  <strong>Task:</strong><br>Создайте директорию ~/myfiles, скопируйте туда /etc/passwd и /etc/group. Создайте раздел с файловая система ext4. Перенесите данные из директории myfiles на эту файловую систему. Настройте автомонтирование этой файловой системы в эту директорию.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# mkdir  ~/myfiles<br>[root@kvmcentos ~]# cp /etc/passwd ~/myfiles<br>[root@kvmcentos ~]# cp /etc/group ~/myfiles<br>[root@kvmcentos ~]# ls -l myfiles/<br>  total 8<br>  -rw-r--r--. 1 cs cs 1457 Feb 10 10:24 group<br>  -rw-r--r--. 1 cs cs 3614 Feb 10 10:24 passwd<br>[root@kvmcentos ~]# sudo mkfs.ext4 /dev/sdb1<br>  mke2fs 1.45.6 (20-Mar-2020)<br>  Creating filesystem with 51200 1k blocks and 12824 inodes<br>  Filesystem UUID: 8f4688cc-def1-44aa-9fc5-7c1793fda09c<br>  Superblock backups stored on blocks:<br>&nbsp;&nbsp;  8193, 24577, 40961<br>  Allocating group tables: done<br>  Writing inode tables: done<br>  Creating journal (4096 blocks): done<br>  Writing superblocks and filesystem accounting information: done<br>[root@kvmcentos ~]# sudo tune2fs -l /dev/sdb1<br>  tune2fs 1.45.6 (20-Mar-2020)<br>  Filesystem volume name:   &lt;none&gt;<br>  Last mounted on:&nbsp;&nbsp;&nbsp;&nbsp;  &lt;not available&gt;<br>  Filesystem UUID:&nbsp;&nbsp;&nbsp;&nbsp;  8f4688cc-def1-44aa-9fc5-7c1793fda09c<br>  Filesystem magic number:  0xEF53<br>  Filesystem revision #:&nbsp;&nbsp;1 (dynamic)<br>  Filesystem features:&nbsp;&nbsp;  has_journal ext_attr resize_inode dir_index filetype extent 64bit flex_bg sparse_super large_file huge_file dir_nlink extra_isize metadata_csum<br>  Filesystem flags:&nbsp;&nbsp;&nbsp;&nbsp; signed_directory_hash<br>  Default mount options:&nbsp;&nbsp;user_xattr acl<br>  Filesystem state:&nbsp;&nbsp;&nbsp;&nbsp; clean<br>  Errors behavior:&nbsp;&nbsp;&nbsp;&nbsp;  Continue<br>  Filesystem OS type:&nbsp;&nbsp;   Linux<br>  Inode count:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  12824<br>  Block count:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  51200<br>  Reserved block count:&nbsp;&nbsp; 2560<br>  Free blocks:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  44440<br>  Free inodes:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  12813<br>  First block:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  1<br>  Block size:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   1024<br>  Fragment size:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1024<br>  Group descriptor size:&nbsp;&nbsp;64<br>  Reserved GDT blocks:&nbsp;&nbsp;  256<br>  Blocks per group:&nbsp;&nbsp;&nbsp;&nbsp; 8192<br>  Fragments per group:&nbsp;&nbsp;  8192<br>  Inodes per group:&nbsp;&nbsp;&nbsp;&nbsp; 1832<br>  Inode blocks per group:   229<br>  Flex block group size:&nbsp;&nbsp;16<br>  Filesystem created:&nbsp;&nbsp;   Thu Feb 10 10:30:30 2022<br>  Last mount time:&nbsp;&nbsp;&nbsp;&nbsp;  n/a<br>  Last write time:&nbsp;&nbsp;&nbsp;&nbsp;  Thu Feb 10 10:30:30 2022<br>  Mount count:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  0<br>  Maximum mount count:&nbsp;&nbsp;  -1<br>  Last checked:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Thu Feb 10 10:30:30 2022<br>  Check interval:&nbsp;&nbsp;&nbsp;&nbsp;   0 (&lt;none&gt;)<br>  Lifetime writes:&nbsp;&nbsp;&nbsp;&nbsp;  278 kB<br>  Reserved blocks uid:&nbsp;&nbsp;  0 (user root)<br>  Reserved blocks gid:&nbsp;&nbsp;  0 (group root)<br>  First inode:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  11<br>  Inode size:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   128<br>  Journal inode:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8<br>  Default directory hash:   half_md4<br>  Directory Hash Seed:&nbsp;&nbsp;  334a5650-55c0-4327-97ce-256db7bb0bba<br>  Journal backup:&nbsp;&nbsp;&nbsp;&nbsp;   inode blocks<br>  Checksum type:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crc32c<br>  Checksum:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x656632a3<br>  разлогиниться - ctl+alt+f3<br>[root@kvmcentos ~]# lsof +D /home/cs/myfiles/<br>[root@kvmcentos ~]# du -h /home/cs/myfiles/<br>  8.0K&nbsp;&nbsp;/home/cs/myfiles/<br>[root@kvmcentos ~]# fdisk -l /dev/sdb1<br>  Disk /dev/sdb1: 50 MiB, 52428800 bytes, 102400 sectors<br>  Units: sectors of 1 * 512 = 512 bytes<br>  Sector size (logical/physical): 512 bytes / 512 bytes<br>  I/O size (minimum/optimal): 512 bytes / 512 bytes<br>[root@kvmcentos ~]# mount /dev/sdb1 /mnt/<br>[root@kvmcentos ~]# df -h<br>  Filesystem&nbsp;&nbsp;&nbsp;&nbsp;   Size  Used Avail Use% Mounted on<br>  devtmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 881M&nbsp;&nbsp; 0  881M   0% /dev<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M&nbsp;&nbsp; 0  909M   0% /dev/shm<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M  9.1M  900M   2% /run<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M&nbsp;&nbsp; 0  909M   0% /sys/fs/cgroup<br>  /dev/mapper/cl-root   47G  5.5G   42G  12% /<br>  /dev/sda1&nbsp;&nbsp;&nbsp;&nbsp;   1014M  346M  669M  35% /boot<br>  Downloads&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;931G  321G  611G  35% /media/sf_Downloads<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;182M   12K  182M   1% /run/user/42<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;182M&nbsp;&nbsp; 0  182M   0% /run/user/0<br>  /dev/sdb1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 45M  1.1M   40M   3% /mnt<br>[root@kvmcentos ~]# mv -v /home/cs/myfiles/* /mnt<br>  copied '/home/cs/myfiles/group' -&gt; '/mnt/group'<br>  removed '/home/cs/myfiles/group'<br>  copied '/home/cs/myfiles/passwd' -&gt; '/mnt/passwd'<br>  removed '/home/cs/myfiles/passwd'<br>[root@kvmcentos ~]# ll /mnt /home/cs/myfiles/<br>  /home/cs/myfiles/:<br>  total 0<br>  /mnt:<br>  total 20<br>  -rw-r--r--. 1 cs cs  1457 Feb 10 10:24 group<br>  drwx------. 2 root   root   12288 Feb 10 10:30 lost+found<br>  -rw-r--r--. 1 cs cs  3614 Feb 10 10:24 passwd<br>[root@kvmcentos ~]# ll /mnt/<br>  total 20<br>  -rw-r--r--. 1 cs cs  1457 Feb 10 10:24 group<br>  drwx------. 2 root   root   12288 Feb 10 10:30 lost+found<br>  -rw-r--r--. 1 cs cs  3614 Feb 10 10:24 passwd<br>[root@kvmcentos ~]# du -h /mnt | tail -1<br>  21K&nbsp;&nbsp; /mnt<br>[root@kvmcentos ~]# cat /etc/fstab<br>#<br># /etc/fstab<br># Created by anaconda on Fri Jan 14 04:46:51 2022<br>#<br># Accessible filesystems, by reference, are maintained under '/dev/disk/'.<br># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.<br>#<br># After editing this file, run 'systemctl daemon-reload' to update systemd<br># units generated from this file.<br>#<br>/dev/mapper/cl-root&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   xfs&nbsp;&nbsp; defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>UUID=8ec77867-4190-4bad-b7a5-98c12e4f3a5e /boot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   xfs&nbsp;&nbsp; defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>/dev/mapper/cl-swap&nbsp;&nbsp; none&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap&nbsp;&nbsp;defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>[root@kvmcentos ~]# blkid /dev/sdb1<br>  /dev/sdb1: UUID="8f4688cc-def1-44aa-9fc5-7c1793fda09c" BLOCK_SIZE="1024" TYPE="ext4" PARTUUID="87f777ab-01"<br>[root@kvmcentos ~]# blkid /dev/sdb1 | cut -d' ' -f2<br>  UUID="8f4688cc-def1-44aa-9fc5-7c1793fda09c"<br>[root@kvmcentos ~]# cp /etc/fstab{,.bkp}<br>[root@kvmcentos ~]# ls -l /etc/fstab*<br>  -rw-r--r--. 1 root root 579 Jan 14 12:46 /etc/fstab<br>  -rw-r--r--. 1 root root 579 Feb 10 10:56 /etc/fstab.bkp<br>[root@kvmcentos ~]# blkid /dev/sdb1 | cut -d' ' -f2 &gt;&gt; /etc/fstab<br>[root@kvmcentos ~]# cat /etc/fstab<br>#<br># /etc/fstab<br># Created by anaconda on Fri Jan 14 04:46:51 2022<br>#<br># Accessible filesystems, by reference, are maintained under '/dev/disk/'.<br># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.<br>#<br># After editing this file, run 'systemctl daemon-reload' to update systemd<br># units generated from this file.<br>#<br>/dev/mapper/cl-root&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   xfs&nbsp;&nbsp; defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>UUID=8ec77867-4190-4bad-b7a5-98c12e4f3a5e /boot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   xfs&nbsp;&nbsp; defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>/dev/mapper/cl-swap&nbsp;&nbsp; none&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap&nbsp;&nbsp;defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>UUID="8f4688cc-def1-44aa-9fc5-7c1793fda09c"<br>[root@kvmcentos ~]# vim /etc/fstab<br>[root@kvmcentos ~]# cat /etc/fstab<br>#<br># /etc/fstab<br># Created by anaconda on Fri Jan 14 04:46:51 2022<br>#<br># Accessible filesystems, by reference, are maintained under '/dev/disk/'.<br># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.<br>#<br># After editing this file, run 'systemctl daemon-reload' to update systemd<br># units generated from this file.<br>#<br>/dev/mapper/cl-root&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   xfs&nbsp;&nbsp; defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>UUID=8ec77867-4190-4bad-b7a5-98c12e4f3a5e /boot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   xfs&nbsp;&nbsp; defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>/dev/mapper/cl-swap&nbsp;&nbsp; none&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap&nbsp;&nbsp;defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>UUID="8f4688cc-def1-44aa-9fc5-7c1793fda09c" /home/cs/myfiles ext4 defaults,auto 0 1<br>[root@kvmcentos ~]# df -h<br>Filesystem&nbsp;&nbsp;&nbsp;&nbsp;   Size  Used Avail Use% Mounted on<br>devtmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 881M&nbsp;&nbsp; 0  881M   0% /dev<br>tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M&nbsp;&nbsp; 0  909M   0% /dev/shm<br>tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M  9.1M  900M   2% /run<br>tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M&nbsp;&nbsp; 0  909M   0% /sys/fs/cgroup<br>/dev/mapper/cl-root   47G  5.5G   42G  12% /<br>/dev/sda1&nbsp;&nbsp;&nbsp;&nbsp;   1014M  346M  669M  35% /boot<br>Downloads&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;931G  321G  611G  35% /media/sf_Downloads<br>tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;182M   12K  182M   1% /run/user/42<br>tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;182M&nbsp;&nbsp; 0  182M   0% /run/user/0<br>/dev/sdb1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 45M  1.1M   40M   3% /mnt<br>[root@kvmcentos ~]# mount /home/cs/myfiles<br>  mount: /home/cs/myfiles: /dev/sdb1 already mounted on /mnt.<br>  залогиниться - ctl+f1<br>[root@kvmcentos ~]# df -h<br>  Filesystem&nbsp;&nbsp;&nbsp;&nbsp;   Size  Used Avail Use% Mounted on<br>  devtmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 881M&nbsp;&nbsp; 0  881M   0% /dev<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M&nbsp;&nbsp; 0  909M   0% /dev/shm<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M  9.2M  900M   2% /run<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M&nbsp;&nbsp; 0  909M   0% /sys/fs/cgroup<br>  /dev/mapper/cl-root   47G  5.5G   42G  12% /<br>  /dev/sda1&nbsp;&nbsp;&nbsp;&nbsp;   1014M  346M  669M  35% /boot<br>  /dev/sdb1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 45M  1.1M   40M   3% /home/cs/myfiles<br>  Downloads&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;931G  321G  610G  35% /media/sf_Downloads<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;182M   12K  182M   1% /run/user/42<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;182M  4.0K  182M   1% /run/user/1000<br><strong>Task:</strong><br>Создайте директорию ~/mybackup. Создайте раздел с файловая система xfs, временно примонтируйте файловая система в директорию mybackup и перенесите данные из ~/myfiles на эту файловую систему. Отмонтируйте файловую систему.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# mkdir ~/mybackup<br>[root@kvmcentos ~]# lsof +D /home/cs/mybackup/<br>[root@kvmcentos ~]# du -h /home/cs/mybackup/<br>  0&nbsp;&nbsp;   /home/cs/mybackup/<br>[root@kvmcentos ~]# fdisk -l /dev/sdb2<br>  Disk /dev/sdb2: 50 MiB, 52428800 bytes, 102400 sectors<br>  Units: sectors of 1 * 512 = 512 bytes<br>  Sector size (logical/physical): 512 bytes / 512 bytes<br>  I/O size (minimum/optimal): 512 bytes / 512 bytes<br>[root@kvmcentos ~]# mkfs.xfs /dev/sdb2<br>  meta-data=/dev/sdb2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  isize=512&nbsp;&nbsp;agcount=2, agsize=6400 blks<br>&nbsp;&nbsp;   =&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   sectsz=512   attr=2, projid32bit=1<br>&nbsp;&nbsp;   =&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   crc=1&nbsp;&nbsp;&nbsp;&nbsp;finobt=1, sparse=1, rmapbt=0<br>&nbsp;&nbsp;   =&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   reflink=1<br>  data&nbsp;&nbsp; =&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   bsize=4096   blocks=12800, imaxpct=25<br>&nbsp;&nbsp;   =&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   sunit=0&nbsp;&nbsp;  swidth=0 blks<br>  naming   =version 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  bsize=4096   ascii-ci=0, ftype=1<br>  log&nbsp;&nbsp;  =internal log&nbsp;&nbsp;&nbsp;&nbsp;   bsize=4096   blocks=1368, version=2<br>&nbsp;&nbsp;   =&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   sectsz=512   sunit=0 blks, lazy-count=1<br>  realtime =none&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   extsz=4096   blocks=0, rtextents=0<br>[root@kvmcentos ~]# mount /dev/sdb2 /mnt/<br>[root@kvmcentos ~]# df -h<br>  Filesystem&nbsp;&nbsp;&nbsp;&nbsp;   Size  Used Avail Use% Mounted on<br>  devtmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 881M&nbsp;&nbsp; 0  881M   0% /dev<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M&nbsp;&nbsp; 0  909M   0% /dev/shm<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M  9.1M  900M   2% /run<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M&nbsp;&nbsp; 0  909M   0% /sys/fs/cgroup<br>  /dev/mapper/cl-root   47G  5.5G   42G  12% /<br>  /dev/sda1&nbsp;&nbsp;&nbsp;&nbsp;   1014M  346M  669M  35% /boot<br>  /dev/sdb1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 45M  1.1M   40M   3% /home/cs/myfiles<br>  Downloads&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;931G  321G  610G  35% /media/sf_Downloads<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;182M   12K  182M   1% /run/user/42<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;182M&nbsp;&nbsp; 0  182M   0% /run/user/0<br>  /dev/sdb2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 45M  3.0M   42M   7% /mnt<br>[root@kvmcentos ~]# mv -v /home/cs/mybackup /mnt<br>  created directory '/mnt/mybackup'<br>  removed directory '/home/cs/mybackup'<br>[root@kvmcentos ~]# mv -v /home/cs/myfiles /mnt<br>  created directory '/mnt/myfiles'<br>  created directory '/mnt/myfiles/lost+found'<br>  copied '/home/cs/myfiles/group' -&gt; '/mnt/myfiles/group'<br>  copied '/home/cs/myfiles/passwd' -&gt; '/mnt/myfiles/passwd'<br>  removed '/home/cs/myfiles/passwd'<br>  removed directory '/home/cs/myfiles/lost+found'<br>  removed '/home/cs/myfiles/group'<br>  mv: cannot remove '/home/cs/myfiles': Device or resource busy<br>[root@kvmcentos ~]# ls /mnt/<br>  mybackup  myfiles<br>[root@kvmcentos ~]# umount /mnt<br>[root@kvmcentos ~]# df -h<br>  Filesystem&nbsp;&nbsp;&nbsp;&nbsp;   Size  Used Avail Use% Mounted on<br>  devtmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 881M&nbsp;&nbsp; 0  881M   0% /dev<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M&nbsp;&nbsp; 0  909M   0% /dev/shm<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M  9.1M  900M   2% /run<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M&nbsp;&nbsp; 0  909M   0% /sys/fs/cgroup<br>  /dev/mapper/cl-root   47G  5.5G   42G  12% /<br>  /dev/sda1&nbsp;&nbsp;&nbsp;&nbsp;   1014M  346M  669M  35% /boot<br>  /dev/sdb1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 45M  1.1M   40M   3% /home/cs/myfiles<br>  Downloads&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;931G  321G  610G  35% /media/sf_Downloads<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;182M   12K  182M   1% /run/user/42<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;182M&nbsp;&nbsp; 0  182M   0% /run/user/0<br><strong>Task:</strong><br>Управление логическими томами - LVM.<br>Создайте LVM, состоящий из двух разделов и одного целого диска.<br>Внутри группы томов создайте два логических раздела, каждый из которых должен занимать 30% пространства группы томов.<br>При включении файловая система на первом логическом разделе должна монтироваться в директорию /data, а файловая система второго логического раздела должна монтироваться в директорию /backup.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# df -h<br>  Filesystem&nbsp;&nbsp;&nbsp;&nbsp;   Size  Used Avail Use% Mounted on<br>  devtmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 881M&nbsp;&nbsp; 0  881M   0% /dev<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M&nbsp;&nbsp; 0  909M   0% /dev/shm<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M  9.3M  900M   2% /run<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;909M&nbsp;&nbsp; 0  909M   0% /sys/fs/cgroup<br>  /dev/mapper/cl-root   47G  5.5G   42G  12% /<br>  /dev/sda1&nbsp;&nbsp;&nbsp;&nbsp;   1014M  346M  669M  35% /boot<br>  Downloads&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;931G  322G  610G  35% /media/sf_Downloads<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;182M   32K  182M   1% /run/user/1000<br>  /dev/sr0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  59M   59M&nbsp;&nbsp; 0 100% /run/media/cs/VBox_GAs_6.1.29<br>[root@kvmcentos ~]# lsblk<br>  NAME&nbsp;&nbsp;&nbsp;&nbsp;MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>  sda&nbsp;&nbsp;&nbsp;&nbsp;   8:0&nbsp;&nbsp;0   50G  0 disk<br>  ├─sda1&nbsp;&nbsp;&nbsp;&nbsp;8:1&nbsp;&nbsp;0&nbsp;&nbsp;1G  0 part /boot<br>  └─sda2&nbsp;&nbsp;&nbsp;&nbsp;8:2&nbsp;&nbsp;0   49G  0 part<br>├─cl-root 253:0&nbsp;&nbsp;0   47G  0 lvm  /<br>└─cl-swap 253:1&nbsp;&nbsp;0  2.1G  0 lvm  [SWAP]<br>  sdb&nbsp;&nbsp;&nbsp;&nbsp;   8:16   0&nbsp;&nbsp;1G  0 disk<br>  sdc&nbsp;&nbsp;&nbsp;&nbsp;   8:32   0&nbsp;&nbsp;1G  0 disk<br>  sr0&nbsp;&nbsp;&nbsp;&nbsp;  11:0&nbsp;&nbsp;1 58.3M  0 rom  /run/media/cs/VBox_GAs_6.1.29<br>[root@kvmcentos ~]# sudo fdisk /dev/sdb<br>  Welcome to fdisk (util-linux 2.32.1).<br>  Changes will remain in memory only, until you decide to write them.<br>  Be careful before using the write command.<br>  Device does not contain a recognized partition table.<br>  Created a new DOS disklabel with disk identifier 0x45b7ad47.<br>Command (m for help): g<br>  Created a new GPT disklabel (GUID: F214B3AC-4B25-C44A-9B25-391159BDF128).<br>Command (m for help): n<br>Partition number (1-128, default 1):<br>First sector (2048-2097118, default 2048):<br>Last sector, +sectors or +size{K,M,G,T,P} (2048-2097118, default 2097118): +200M<br>  Created a new partition 1 of type 'Linux filesystem' and of size 200 MiB.<br>Command (m for help): n<br>Partition number (2-128, default 2):<br>First sector (411648-2097118, default 411648):<br>Last sector, +sectors or +size{K,M,G,T,P} (411648-2097118, default 2097118): +400M<br>  Created a new partition 2 of type 'Linux filesystem' and of size 400 MiB.<br>Command (m for help): p<br>  Disk /dev/sdb: 1 GiB, 1073741824 bytes, 2097152 sectors<br>  Units: sectors of 1 * 512 = 512 bytes<br>  Sector size (logical/physical): 512 bytes / 512 bytes<br>  I/O size (minimum/optimal): 512 bytes / 512 bytes<br>  Disklabel type: gpt<br>  Disk identifier: F214B3AC-4B25-C44A-9B25-391159BDF128<br>  Device&nbsp;&nbsp;  Start&nbsp;&nbsp; End Sectors  Size Type<br>  /dev/sdb1&nbsp;&nbsp;2048  411647  409600  200M Linux filesystem<br>  /dev/sdb2  411648 1230847  819200  400M Linux filesystem<br>Command (m for help): w<br>  The partition table has been altered.<br>  Calling ioctl() to re-read partition table.<br>  Syncing disks.<br>[root@kvmcentos ~]# sudo pvcreate /dev/sdb1<br>Physical volume "/dev/sdb1" successfully created.<br>[root@kvmcentos ~]# sudo pvs<br>PV&nbsp;&nbsp;&nbsp;&nbsp; VG Fmt  Attr PSize   PFree<br>/dev/sda2  cl lvm2 a--  &lt;49.00g&nbsp;&nbsp;  0<br>/dev/sdb1&nbsp;&nbsp; lvm2 ---  200.00m 200.00m<br>[root@kvmcentos ~]# sudo pvdisplay /dev/sdb1<br>"/dev/sdb1" is a new physical volume of "200.00 MiB"<br>--- NEW Physical volume ---<br>PV Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   /dev/sdb1<br>VG Name<br>PV Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   200.00 MiB<br>Allocatable&nbsp;&nbsp;&nbsp;&nbsp;   NO<br>PE Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   0<br>Total PE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  0<br>Free PE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   0<br>Allocated PE&nbsp;&nbsp;&nbsp;&nbsp;  0<br>PV UUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Zh9vy1-BMtC-NwkZ-uelY-PTFf-XEO8-nINDjc<br>[root@kvmcentos ~]# sudo vgcreate myvg /dev/sdb1<br>Volume group "myvg" successfully created<br>[root@kvmcentos ~]# sudo vgs<br>VG   #PV #LV #SN Attr   VSize   VFree<br>cl&nbsp;&nbsp; 1   2   0 wz--n- &lt;49.00g&nbsp;&nbsp;  0<br>myvg   1   0   0 wz--n- 196.00m 196.00m<br>[root@kvmcentos ~]# sudo vgdisplay myvg<br>--- Volume group ---<br>VG Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   myvg<br>System ID<br>Format&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lvm2<br>Metadata Areas&nbsp;&nbsp;&nbsp;&nbsp;1<br>Metadata Sequence No  1<br>VG Access&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; read/write<br>VG Status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resizable<br>MAX LV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>Cur LV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>Open LV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   0<br>Max PV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>Cur PV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>Act PV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>VG Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   196.00 MiB<br>PE Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   4.00 MiB<br>Total PE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  49<br>Alloc PE / Size&nbsp;&nbsp;   0 / 0<br>Free  PE / Size&nbsp;&nbsp;   49 / 196.00 MiB<br>VG UUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   jAA7BR-mEHr-V2F8-yu8A-Bzoq-POr1-VSdD2q<br>[root@kvmcentos ~]# sudo lvcreate myvg -n mylv -L 200M<br>Volume group "myvg" has insufficient free space (49 extents): 50 required.<br>[root@kvmcentos ~]# sudo lvcreate myvg -n mylv -l 30%FREE<br>Logical volume "mylv" created.<br>[root@kvmcentos ~]# sudo lvcreate myvg -n mylv2 -l 30%FREE<br>Logical volume "mylv2" created.<br>[root@kvmcentos ~]# sudo lvs<br>LV&nbsp;&nbsp;VG   Attr&nbsp;&nbsp;   LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert<br>root  cl   -wi-ao---- &lt;46.94g<br>swap  cl   -wi-ao----  &lt;2.06g<br>mylv  myvg -wi-a-----  56.00m<br>mylv2 myvg -wi-a-----  40.00m<br>[root@kvmcentos ~]# sudo lvdisplay myvg<br>--- Logical volume ---<br>LV Path&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/dev/myvg/mylv<br>LV Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mylv<br>VG Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myvg<br>LV UUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BXxmLe-zWBY-Syui-ifdb-uQ5h-7W8d-ER1fKc<br>LV Write Access&nbsp;&nbsp;&nbsp;&nbsp;read/write<br>LV Creation host, time cs.virtualbox, 2022-02-12 10:27:18 +0800<br>LV Status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  available<br># open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0<br>LV Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;56.00 MiB<br>Current LE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 14<br>Segments&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   1<br>Allocation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inherit<br>Read ahead sectors&nbsp;&nbsp; auto<br>- currently set to&nbsp;&nbsp; 8192<br>Block device&nbsp;&nbsp;&nbsp;&nbsp;   253:2<br>--- Logical volume ---<br>LV Path&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/dev/myvg/mylv2<br>LV Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mylv2<br>VG Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myvg<br>LV UUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UO5u2O-61IE-niam-EogM-8WDg-jP8y-vMyzjf<br>LV Write Access&nbsp;&nbsp;&nbsp;&nbsp;read/write<br>LV Creation host, time cs.virtualbox, 2022-02-12 10:33:40 +0800<br>LV Status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  available<br># open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0<br>LV Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;40.00 MiB<br>Current LE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10<br>Segments&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   1<br>Allocation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inherit<br>Read ahead sectors&nbsp;&nbsp; auto<br>- currently set to&nbsp;&nbsp; 8192<br>Block device&nbsp;&nbsp;&nbsp;&nbsp;   253:3<br>[root@kvmcentos ~]# ls /dev/myvg<br>  mylv  mylv2<br>[root@kvmcentos ~]# sudo mkfs.ext4 /dev/myvg/mylv<br>  mke2fs 1.45.6 (20-Mar-2020)<br>  Creating filesystem with 57344 1k blocks and 14336 inodes<br>  Filesystem UUID: 4e2490cc-9a96-4cac-af6d-12f7835067ad<br>  Superblock backups stored on blocks:<br>&nbsp;&nbsp;  8193, 24577, 40961<br>  Allocating group tables: done<br>  Writing inode tables: done<br>  Creating journal (4096 blocks): done<br>  Writing superblocks and filesystem accounting information: done<br>[root@kvmcentos ~]# sudo mkfs.ext4 /dev/myvg/mylv2<br>  mke2fs 1.45.6 (20-Mar-2020)<br>  Creating filesystem with 40960 1k blocks and 10240 inodes<br>  Filesystem UUID: 0c48275d-16e2-4054-a1c6-1d0da548eba3<br>  Superblock backups stored on blocks:<br>&nbsp;&nbsp;  8193, 24577<br>  Allocating group tables: done<br>  Writing inode tables: done<br>  Creating journal (4096 blocks): done<br>  Writing superblocks and filesystem accounting information: done<br>[root@kvmcentos ~]# ll /dev/myvg/<br>  total 0<br>  lrwxrwxrwx. 1 root root 7 Feb 12 10:37 mylv -&gt; ../dm-2<br>  lrwxrwxrwx. 1 root root 7 Feb 12 10:37 mylv2 -&gt; ../dm-3<br>[root@kvmcentos ~]# ll /dev/dm-*<br>  brw-rw----. 1 root disk 253, 0 Feb 10 09:25 /dev/dm-0<br>  brw-rw----. 1 root disk 253, 1 Feb 10 09:25 /dev/dm-1<br>  brw-rw----. 1 root disk 253, 2 Feb 12 10:37 /dev/dm-2<br>  brw-rw----. 1 root disk 253, 3 Feb 12 10:37 /dev/dm-3<br>[root@kvmcentos ~]# sudo lsblk -f /dev/myvg/mylv<br>  NAME&nbsp;&nbsp;  FSTYPE LABEL UUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOUNTPOINT<br>  myvg-mylv ext4&nbsp;&nbsp;&nbsp;&nbsp; 4e2490cc-9a96-4cac-af6d-12f7835067ad<br>[root@kvmcentos ~]# sudo lsblk -f /dev/myvg/mylv2<br>  NAME&nbsp;&nbsp;   FSTYPE LABEL UUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOUNTPOINT<br>  myvg-mylv2 ext4&nbsp;&nbsp;&nbsp;&nbsp; 0c48275d-16e2-4054-a1c6-1d0da548eba3<br>[root@kvmcentos ~]# cat /etc/fstab<br>#<br># /etc/fstab<br># Created by anaconda on Fri Jan 14 04:46:51 2022<br>#<br># Accessible filesystems, by reference, are maintained under '/dev/disk/'.<br># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.<br>#<br># After editing this file, run 'systemctl daemon-reload' to update systemd<br># units generated from this file.<br>#<br>/dev/mapper/cl-root&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   xfs&nbsp;&nbsp; defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>UUID=8ec77867-4190-4bad-b7a5-98c12e4f3a5e /boot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   xfs&nbsp;&nbsp; defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>/dev/mapper/cl-swap&nbsp;&nbsp; none&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap&nbsp;&nbsp;defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>[root@kvmcentos ~]# ll /dev/mapper<br>  total 0<br>  lrwxrwxrwx. 1 root root&nbsp;&nbsp;   7 Feb 10 09:25 cl-root -&gt; ../dm-0<br>  lrwxrwxrwx. 1 root root&nbsp;&nbsp;   7 Feb 10 09:25 cl-swap -&gt; ../dm-1<br>  crw-------. 1 root root 10, 236 Feb 10 09:25 control<br>  lrwxrwxrwx. 1 root root&nbsp;&nbsp;   7 Feb 12 10:37 myvg-mylv -&gt; ../dm-2<br>  lrwxrwxrwx. 1 root root&nbsp;&nbsp;   7 Feb 12 10:37 myvg-mylv2 -&gt; ../dm-3<br>[root@kvmcentos ~]# sudo vim /etc/fstab<br>[root@kvmcentos ~]# cat /etc/fstab<br>#<br># /etc/fstab<br># Created by anaconda on Fri Jan 14 04:46:51 2022<br>#<br># Accessible filesystems, by reference, are maintained under '/dev/disk/'.<br># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.<br>#<br># After editing this file, run 'systemctl daemon-reload' to update systemd<br># units generated from this file.<br>#<br>/dev/mapper/cl-root&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   xfs&nbsp;&nbsp; defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>UUID=8ec77867-4190-4bad-b7a5-98c12e4f3a5e /boot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   xfs&nbsp;&nbsp; defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>/dev/mapper/cl-swap&nbsp;&nbsp; none&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap&nbsp;&nbsp;defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>/dev/mapper/myvg-mylv   /data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   ext4&nbsp;&nbsp;noatime&nbsp;&nbsp;&nbsp;&nbsp; 0 0<br>/dev/mapper/myvg-mylv2  /backup&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ext4&nbsp;&nbsp;noatime&nbsp;&nbsp;&nbsp;&nbsp; 0 0<br>[root@kvmcentos ~]# sudo mkdir /data<br>  mkdir: cannot create directory ‘/data’: File exists<br>[root@kvmcentos ~]# sudo mkdir /backup<br>[root@kvmcentos ~]# sudo mount /data<br>[root@kvmcentos ~]# sudo mount /backup<br>[root@kvmcentos ~]# df -h /data<br>  Filesystem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Size  Used Avail Use% Mounted on<br>  /dev/mapper/myvg-mylv   51M  1.1M   46M   3% /data<br>[root@kvmcentos ~]# df -h /backup<br>  Filesystem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Size  Used Avail Use% Mounted on<br>  /dev/mapper/myvg-mylv2   35M  782K   32M   3% /backup<br><strong>Source:</strong><br># https://codernotes.ru/articles/administrirovanie-linux/chem-zanyato-mesto-na-diske-linux.html<br># https://losst.ru/komanda-du-v-linux<br># https://www.youtube.com/watch?v=qXq7qH_MdV8&list=PLtSGboPf3g50Aejrp6KjQsqqjxvAO4aKw&index=4<br># https://basis.gnulinux.pro/ru/latest/basis/25/25._%D0%9F%D1%80%D0%B0%D0%BA%D1%82%D0%B8%D0%BA%D0%B0.html#"<br><strong>Task:</strong><br>Команды, которые покажут что у нас есть в составе системы<br>- посмотрим какие у нас есть модули ядра, которые отвечают за какие то устройства<br>- смотрим устройства на шине pci. Для получения списка всех подсоединенных к системе устройств PCI вы можете либо обратиться к содержимому файла /proc/bus/pci, либо использовать утилиту lspci - /usr/sbin/lspci (фрагмент вывода которой приведен ниже).<br>- посмотрим все детально<br>- Для получения списка всех устройств usb, соединенных с вашей системой, вам придется прочитать содержимое файла /proc/bus/usb/devices. Тут покажет, что у нас определенные два хаба и какой то планшет (tablet) от Virtualbox.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# lsmod<br>&nbsp;&nbsp;  Module&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Size  Used by<br>&nbsp;&nbsp;  nls_utf8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   16384  1<br>&nbsp;&nbsp;  isofs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  49152  1<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  e1000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 143360  0<br>&nbsp;&nbsp;  pata_acpi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  16384  0<br>[root@kvmcentos ~]# lspci<br>&nbsp;&nbsp;  00:00.0 Host bridge: Intel Corporation 440FX - 82441FX PMC [Natoma] (rev 02)<br>&nbsp;&nbsp;  00:01.0 ISA bridge: Intel Corporation 82371SB PIIX3 ISA [Natoma/Triton II]<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  00:0b.0 USB controller: Intel Corporation 82801FB/FBM/FR/FW/FRW (ICH6 Family) USB2 EHCI Controller<br>&nbsp;&nbsp;  00:0d.0 SATA controller: Intel Corporation 82801HM/HEM (ICH8M/ICH8M-E) SATA Controller [AHCI mode] (rev 02)<br>[root@kvmcentos ~]# lshw<br>&nbsp;&nbsp;&nbsp;&nbsp;  virtualbox&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  описание: Project-Id-Version: lshwReport-Msgid-Bugs-To: FULL NAME &lt;EMAIL@ADDRESS&gt;PO-Revision-Date: 2015-01-21 09:55+0000Last-Translator: Aleksey Kabanov &lt;Unknown&gt;Language-Team: Russian &lt;ru@li.org&gt;MIME-Version: 1.0Content-Type: text/plain; charset=UTF-8Content-Transfer-Encoding: 8bitX-Launchpad-Export-Date: 2018-07-12 13:19+0000X-Generator: Launchpad (build 18719)Language: ru_RU<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  возможности: primary bootable journaled extended_attributes large_files huge_files dir_nlink recover 64bit extents ext4 ext2 initialized<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  конфигурация: created=2020-02-29 06:58:50 filesystem=ext4 lastmountpoint=/ modified=2020-03-20 09:21:46 mount.fstype=ext4 mount.options=rw,relatime,errors=remount-ro mounted=2020-03-20 09:21:51 state=mounted<br>[root@kvmcentos ~]# lsusb<br>&nbsp;&nbsp;  Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub<br>&nbsp;&nbsp;  Bus 002 Device 003: ID 80ee:0021 VirtualBox USB Tablet<br>&nbsp;&nbsp;  Bus 002 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub<br><strong>Task:</strong><br>лиункс сам может находить устройства, но иногда нужно добавлять устройства или модули ядра для того чтобы это устройство работало. для этого есть утилиты управления модулями ядра.<br>- в lsmod увидим e1000, это интернет модуль, который отвечает за сетевую карту. <br>- в description увидим название сет карты. удалим и вернем его. но на нас будут ругаться так как от него заисят еще другие модули ядра.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# lsmod<br>root@kvmubuntu:~# modinfo e1000<br>root@kvmubuntu:~# rmmod e1000<br>root@kvmubuntu:~# insmod e1000<br>insmod: ERROR: could not load module e1000: No such file or directory<br>root@kvmubuntu:~# insmod e1000<br>insmod: ERROR: could not load module e1000: No such file or directory<br>root@kvmubuntu:~# modprobe e1000<br><strong>Task:</strong><br>Технология DMA<br>- для обращения к оперативка минуемого процессора. В примере показано, что в процессе загрузки параллельный порт получил канал прямого доступа к памяти номер 1, а инфракрасный порт - канал прямого доступа к памяти номер 3.<br>- так как у нас мало установленных ПО, у нас только некий cascade использует обращение к оперативке в  минуемых процессорах. посмотрим какие у нас есть диски и посмотрим какие у этих дисков есть ID. увидим какие у нас есть устройства и куда смотнированы. как раз udev умеет читать ID, то есть UUID имеет уникальный ID, который какраз UDEV<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# cat /proc/dma<br>&nbsp;&nbsp;   4: cascade<br>root@kvmubuntu:~# dmesg | egrep -C 1 'dma 1|dma 3'<br>&nbsp;&nbsp;  [   20.576000] parport: PnPBIOS parport detected.<br>&nbsp;&nbsp;  [   20.580000] parport0: PC-style at 0x378 (0x778), irq 7, dma 1...<br>&nbsp;&nbsp;  [   20.764000] irda_init()<br>&nbsp;&nbsp;  --<br>&nbsp;&nbsp;  [   21.204000] pnp: Device 00:0b activated.<br>&nbsp;&nbsp;  [   21.204000] nsc_ircc_pnp_probe() : From PnP, found firbase 0x2F8...<br>&nbsp;&nbsp;  [   21.204000] nsc-ircc, chip-&gt;init<br>root@kvmubuntu:~# blkid<br>&nbsp;&nbsp;  /dev/loop0: TYPE="squashfs"<br>&nbsp;&nbsp;  /dev/loop1: TYPE="squashfs"<br>&nbsp;&nbsp;  /dev/loop2: TYPE="squashfs"<br>&nbsp;&nbsp;  /dev/loop3: TYPE="squashfs"<br>&nbsp;&nbsp;  /dev/loop4: TYPE="squashfs"<br>&nbsp;&nbsp;  /dev/loop5: TYPE="squashfs"<br>&nbsp;&nbsp;  /dev/loop6: TYPE="squashfs"<br>&nbsp;&nbsp;  /dev/loop7: TYPE="squashfs"<br>&nbsp;&nbsp;  /dev/sr0: UUID="2020-02-18-17-20-05-35" LABEL="VBox_GAs_6.1.4" TYPE="iso9660"<br>&nbsp;&nbsp;  /dev/sda1: UUID="4020996d-6502-4a36-b7bc-aec4a74d5aa9" TYPE="ext4" PARTUUID="012ffc0e-01"<br>&nbsp;&nbsp;  /dev/loop8: TYPE="squashfs"<br>&nbsp;&nbsp;  /dev/loop9: TYPE="squashfs"<br>&nbsp;&nbsp;  /dev/loop10: TYPE="squashfs"<br>&nbsp;&nbsp;  /dev/loop11: TYPE="squashfs"<br>&nbsp;&nbsp;  /dev/loop12: TYPE="squashfs"<br><strong>Source:</strong><br># https://www.youtube.com/user/itsemaev"<br># https://stepik.org/lesson/32801/step/2?unit=12616<br><strong>Task:</strong><br>Создание образа-копии компакт-диска<br>у нас есть компакт-диск с дистрибутивом Ubuntu, и мы хотим создать файл ISO-образа, который потом можно будет использовать для создания нескольких копий.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>Вставив компакт-диск в привод CD-ROM и определив имя устройства (пусть это будет /dev/cdrom), мы сможем создать файл ISO-образа следующим способом:<br>root@kvmubuntu:~# dd if=/dev/cdrom of=ubuntu.iso<br>  119104+0 records in<br>  119104+0 records out<br>  60981248 bytes (61 MB, 58 MiB) copied, 2.66461 s, 22.9 MB/s<br><strong>Task:</strong><br>Создание образа из коллекции файлов<br>Создать файл ISO-образа, включающий содержимое некоего каталога с помощью программы enisoimage. сначала создадим каталог (~/folder) со всеми необходимыми файлами для включения в образ<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ls folder<br>  1.txt  3.txt<br>root@kvmubuntu:~# genisoimage -o folder.iso -R -J ~/folder<br>  I: -input-charset not specified, using utf-8 (detected in locale settings)<br>  Total translation table size: 0<br>  Total rockridge attributes bytes: 323<br>  Total directory bytes: 474<br>  Path table size(bytes): 10<br>  Max brk space used 0<br>  181 extents written (0 MB)<br>root@kvmubuntu:~# ls -l folder.iso<br>  -rw-rw-r-- 1 s s 370688 Nov 18 20:14 folder.iso<br><strong>Task:</strong><br>Просмотр списка смонтированных файловых систем.<br>Для монтирования файловых систем вывести список файловых систем, смонтированных в настоящий момент. Для первого эксперимента возьмем флешку. <br>Сначала посмотрим, что имеется в системе, перед тем как вставить флешку. Вставим флешку. Теперь, когда мы знаем имя устройства флешки, размонтируем ее и повторно смонтируем его в другой каталог в дереве файловой системы. Создать новую точку монтирования диска. Смонтируем флешку в новую точку монтирования.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# mount<br>  sysfs on /sys type sysfs (rw)<br>  proc on /proc type proc (rw)<br>  udev on /dev type devtmpfs (rw)<br>  ...<br>  /dev/fuse on /run/user/1000/doc type fuse (rw)<br>  tmpfs on /run/snapd/ns type tmpfs (rw)<br>  nsfs on /run/snapd/ns/snap-store.mnt type nsfs (rw)<br>root@kvmubuntu:~# mount<br>  sysfs on /sys type sysfs (rw)<br>  proc on /proc type proc (rw)<br>  udev on /dev type devtmpfs (rw)<br>  ...<br>  /dev/fuse on /run/user/1000/doc type fuse (rw)<br>  tmpfs on /run/snapd/ns type tmpfs (rw)<br>  nsfs on /run/snapd/ns/snap-store.mnt type nsfs (rw)<br>  /dev/sdc1 on /media/asus/BOOT_MENU type vfat (rw,nosuid,nodev,relatime,uid=1000,gid=1000,fmask=0022,dmask=0022,codepage=437,iocharset=iso8859-1,shortname=mixed,showexec,utf8,flush,errors=remount-ro,uhelper=udisks2)<br>root@kvmubuntu:~# umount /dev/sdc1<br>root@kvmubuntu:~# mkdir /mnt/flash<br>root@kvmubuntu:~# ls /mnt<br>flash<br>root@kvmubuntu:~# mount -t vfat /dev/sdc1 /mnt/flash<br>root@kvmubuntu:~# cd /mnt/flash/<br>/mnt/flash# ls<br>  '???'&nbsp;&nbsp;&nbsp;&nbsp;  autorun.inf   bootmgr&nbsp;&nbsp;   efi&nbsp;&nbsp;  'System Volume Information'<br>   autorun.ico   boot&nbsp;&nbsp;&nbsp;&nbsp;  bootmgr.efi   sources<br>root@kvmubuntu:~# umount /dev/sdc1<br><strong>Task:</strong><br>Определение названий устройств. Сначала давайте посмотрим, как система выбирает названия для устройств. Посмотрим значительное число устройств<br>Если вам доведется работать в системе, которая не монтирует автоматически съемные носители, вы можете использовать следующий прием для определения названий таких устройств после их подключения. Сначала запустите мониторинг содержимого файла /var/log/messages в режиме реального времени (для этого могут потребоваться права суперпользователя).<br>- Подключите извлекаемое устройство. В этом отношении следующие две строки являются для нас особенно показательными<br>- Зная имя устройства, смонтировать флеш-диск.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# ls /dev<br>&nbsp;&nbsp;  autofs&nbsp;&nbsp;&nbsp;&nbsp;   loop-control&nbsp;&nbsp;&nbsp;&nbsp;sg0&nbsp;&nbsp;   tty24  tty49&nbsp;&nbsp;usbmon0<br>&nbsp;&nbsp;  block&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lp0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sg1&nbsp;&nbsp;   tty25  tty5&nbsp;&nbsp; usbmon1<br>&nbsp;&nbsp;  bsg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  lp1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; shm&nbsp;&nbsp;   tty26  tty50&nbsp;&nbsp;vboxguest<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  input&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sda1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tty21&nbsp;&nbsp; tty46  uhid<br>&nbsp;&nbsp;  kmsg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sda2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tty22&nbsp;&nbsp; tty47  uinput<br>&nbsp;&nbsp;  log&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  sda3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tty23&nbsp;&nbsp; tty48  urandom<br>[root@kvmcentos ~]#  tail -f /var/log/messages<br>&nbsp;&nbsp;  Nov 18 20:29:12 localhost systemd-tmpfiles[3996]: [/usr/lib/tmpfiles.d/subscription-manager.conf:1] Line references path below legacy directory /var/run/, updating /var/run/rhsm → /run/rhsm; please update the tmpfiles.d/ drop-in file accordingly.<br>&nbsp;&nbsp;  Nov 18 20:29:12 localhost systemd[1]: Started Cleanup of Temporary Directories.<br>&nbsp;&nbsp;  Nov 18 20:33:27 localhost dbus-daemon[900]: [system] Activating via systemd: service name='org.freedesktop.PackageKit' unit='packagekit.service' requested by ':1.485' (uid=1000 pid=4195 comm="/usr/libexec/pk-command-not-found ?????????? " label="unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023")<br>&nbsp;&nbsp;  Nov 18 20:33:27 localhost systemd[1]: Starting PackageKit Daemon...<br>&nbsp;&nbsp;  Nov 18 20:33:28 localhost dbus-daemon[900]: [system] Successfully activated service 'org.freedesktop.PackageKit'<br>&nbsp;&nbsp;  Nov 18 20:33:28 localhost systemd[1]: Started PackageKit Daemon.<br>&nbsp;&nbsp;  Nov 18 21:09:35 localhost dbus-daemon[900]: [system] Activating via systemd: service name='net.reactivated.Fprint' unit='fprintd.service' requested by ':1.490' (uid=0 pid=5911 comm="sudo tail -f /var/log/messages " label="unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023")<br>&nbsp;&nbsp;  Nov 18 21:09:35 localhost systemd[1]: Starting Fingerprint Authentication Daemon...<br>&nbsp;&nbsp;  Nov 18 21:09:35 localhost dbus-daemon[900]: [system] Successfully activated service 'net.reactivated.Fprint'<br>&nbsp;&nbsp;  Nov 18 21:09:35 localhost systemd[1]: Started Fingerprint Authentication Daemon.<br>[root@kvmcentos ~]#  tail -f /var/log/messages<br>&nbsp;&nbsp;  Nov 18 21:09:37 localhos kernel: sdc: sdc1<br>&nbsp;&nbsp;  Nov 18 21:09:37 localhos kernel: sd 3:0:0:0: [sdc] Attached SCSI removable disk<br>[root@kvmcentos ~]# mount /dev/sdc1 /mnt/flash<br>[root@kvmcentos ~]# ls /mnt/flash/<br>&nbsp;&nbsp;   autorun.ico   boot&nbsp;&nbsp;  bootmgr.efi   sources&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  РПА<br>&nbsp;&nbsp;   autorun.inf   bootmgr   efi&nbsp;&nbsp;&nbsp;&nbsp;  'System Volume Information'<br>[root@kvmcentos ~]# df<br>&nbsp;&nbsp;  Файл.система   1K-блоков Использовано  Доступно Использовано% Cмонтировано в<br>&nbsp;&nbsp;  udev&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3978168&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0   3978168&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0% /dev<br>&nbsp;&nbsp;  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 801316&nbsp;&nbsp;&nbsp;&nbsp; 1916&nbsp;&nbsp;799400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1% /run<br>&nbsp;&nbsp;  /dev/sda2&nbsp;&nbsp;  191197068&nbsp;&nbsp; 15079852 166335200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9% /<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  /dev/sda3&nbsp;&nbsp;  767149872&nbsp;&nbsp;413510296 314600756&nbsp;&nbsp;&nbsp;&nbsp;   57% /home<br>&nbsp;&nbsp;  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 801312&nbsp;&nbsp;&nbsp;&nbsp;   52&nbsp;&nbsp;801260&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1% /run/user/1000<br>&nbsp;&nbsp;  /dev/sdc1&nbsp;&nbsp;&nbsp;&nbsp;3923948&nbsp;&nbsp;   414528   3509420&nbsp;&nbsp;&nbsp;&nbsp;   11% /mnt/flash<br><strong>Task:</strong><br>Сколько места занимает на диске.<br>- определить в текущей папке занимаемое место всеми подкаталогами и файлами<br>- отсортировать результаты, чтобы выяснить, чем занято место в конкретной папке или на всем разделе<br>- исключим все deb файлы<br>- Найдите самую большую директорию в корне.<br>- Напишите команду, которая выведет сколько места на диске занимает текущая директория (при этом размер нужно вывести в удобном для чтения формате (например, вместо 2048 байт надо выводить 2.0К) и больше на экран выводить ничего не нужно).<br>- Узнать сколько места занято/свободно во всей системе.<br>- посмотреть занятость файловой системы в %, в килограммах.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# du -h ~/<br>root@kvmubuntu:~# du --max-depth 1 -h .<br>root@kvmubuntu:~# apt-get -y install ncdu<br>root@kvmubuntu:~# ncdu<br>root@kvmubuntu:~# du -sm *<br>&nbsp;&nbsp;  1   Cross-Platphorm<br>&nbsp;&nbsp;  1   Desktop<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  1   test0<br>&nbsp;&nbsp;  1   testC<br>root@kvmubuntu:~# du -sm * | sort -n<br>&nbsp;&nbsp;  1   Cross-Platphorm<br>&nbsp;&nbsp;  1   Desktop<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  51  Downloads<br>&nbsp;&nbsp;  8538&nbsp;&nbsp;Qt<br>root@kvmubuntu:~# du -smh *<br>&nbsp;&nbsp;  52K Cross-Platphorm<br>&nbsp;&nbsp;  4.0K&nbsp;&nbsp;Desktop<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  36K test0<br>&nbsp;&nbsp;  36K testC<br>root@kvmubuntu:~# du -smh * --exclude="*.deb"<br>&nbsp;&nbsp;  52K Cross-Platphorm<br>&nbsp;&nbsp;  4.0K&nbsp;&nbsp;Desktop<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  36K test0<br>&nbsp;&nbsp;  36K testC<br>root@kvmubuntu:~# du -sh /* | sort -h | tail -3<br>root@kvmubuntu:~# du -hs<br>938M<br>root@kvmubuntu:~# df -h<br>Filesystem Size Used Avail Use% Mounted on<br>tmpfs 196M 1.6M 195M 1% /run<br>/dev/sda349G 31G 16G 67% /<br>tmpfs 980M 0 980M 0% /dev/shm<br>tmpfs 5.0M 4.0K 5.0M 1% /run/lock<br>/dev/sda2 512M 6.1M 506M 2% /boot/efi<br>tmpfs 196M 76K 196M 1% /run/user/127<br>tmpfs 196M 64K 196M 1% /run/user/1001<br>root@kvmubuntu:~# df --output=pcent<br>  Use%<br>&nbsp;&nbsp;0%<br>&nbsp;&nbsp;1%<br>...<br>&nbsp;&nbsp;1%<br>  100%<br><strong>Source:</strong><br># https://winitpro.ru/index.php/2021/02/20/svobodnoe-mesta-na-diske-v-linux/ - Просмотр занятого места на разделах командой du.<br><strong>Task:</strong><br>Сбор информации до и после взлома.<br>- Вы можете посмотреть содержимое файла /var/log/audit.log. Здесь фиксируются все события в системе, в том числе неудачные попытки входа по ssh. Можно увидеть, например, что ваш пароль пытались подобрать. Также можно посмотреть логи сервиса sshd с помощью journalctl<br>- Рассчитав контрольные суммы для каждого образа и проверив их на совпадение, можно сравнить образ раздела или файла перед взломом с образом из взломанной системы.<br>- Команда file полезна для определения, изменился ли набор статических библиотек, используемых программой, что может указывать на то, что программа модифицирована злоумышленником.<br>- Команда stat выводит информацию о состоянии файла, включая время последнего доступа, разрешения, значения битов UID и GID и т.д. Это может использоваться для определения последнего использования или модификации во взломанной системе.<br>- Команда md5sum используется для вычисления контрольной суммы файла. Вы можете создать список контрольных сумм для популярных файлов, которые обычно могут изменяться при взломе системы. В случае модификации файла контрольная сумма также изменится.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# cat /var/log/audit/audit.log<br>&nbsp;&nbsp;&nbsp;&nbsp;  type=SERVICE_STOP msg=audit(1587173242.907:3186): pid=1 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:init_t:s0 msg='unit=systemd-coredump@1009-14416-0 comm="systemd" exe="/usr/lib/systemd/systemd" hostname=? addr=? terminal=? res=success'^]UID="root" AUID="unset"<br>&nbsp;&nbsp;&nbsp;&nbsp;  ...<br>[root@kvmcentos ~]# journalctl _SYSTEMD_UNIT=sshd.service<br>&nbsp;&nbsp;&nbsp;&nbsp;  -- Logs begin at Sat 2020-02-29 08:59:41 MSK, end at Sun 2020-04-19 06:36:03 MSK<br>&nbsp;&nbsp;&nbsp;&nbsp;  -- No entries --<br>[root@kvmcentos ~]# dd if=/bin/ls of=ls.dd | md5sum ls.dd &gt; sum.txt<br>&nbsp;&nbsp;&nbsp;&nbsp;  521+1 записей получено<br>&nbsp;&nbsp;&nbsp;&nbsp;  521+1 записей отправлено<br>&nbsp;&nbsp;&nbsp;&nbsp;  267000 байт (267 kB, 261 KiB) скопирован, 0,0275932 s, 9,7 MB/s<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;   40 апр 18 23:20  sum.txt<br>[root@kvmcentos ~]# file /bin/ls<br>&nbsp;&nbsp;&nbsp;&nbsp;  /bin/ls: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=bed150f5bac8514e69b3b98eb6fd3e75d6b277c8, stripped, too many notes (256)<br>[root@kvmcentos ~]# stat /bin/ls<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Файл: /bin/ls<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Размер: 267000&nbsp;&nbsp;&nbsp;&nbsp;Блоков: 528&nbsp;&nbsp;&nbsp;&nbsp;Блок В/В: 4096   обычный файл<br>&nbsp;&nbsp;&nbsp;&nbsp;  Устройство: fd00h/64768d&nbsp;&nbsp;Inode: 101435220   Ссылки: 1<br>&nbsp;&nbsp;&nbsp;&nbsp;  Доступ: (0755/-rwxr-xr-x)  Uid: (&nbsp;&nbsp;0/&nbsp;&nbsp;root)   Gid: (&nbsp;&nbsp;0/&nbsp;&nbsp;root)<br>&nbsp;&nbsp;&nbsp;&nbsp;  Контекст: system_u:object_r:bin_t:s0<br>&nbsp;&nbsp;&nbsp;&nbsp;  Доступ: 2020-04-18 20:04:34.587999107 -0400<br>&nbsp;&nbsp;&nbsp;&nbsp;  Модифицирован: 2020-04-09 14:53:51.000000000 -0400<br>&nbsp;&nbsp;&nbsp;&nbsp;  Изменён: 2020-04-14 02:54:41.028538894 -0400<br>&nbsp;&nbsp;&nbsp;&nbsp;   Создан: -<br>[root@kvmcentos ~]# md5sum /bin/ls &gt;&gt; sums.txt<br>[root@kvmcentos ~]# ls -l<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;   42 апр 18 23:22  sums.txt<br>&nbsp;&nbsp;&nbsp;&nbsp;  -rw-r--r--. 1 root   root&nbsp;&nbsp;   40 апр 18 23:20  sum.txt<br><strong>Task:</strong><br>Клонирование дисков.<br>- Представьте, что у вас есть два флеш-диска USB одинакового размера и вам нужно создать точную копию первого диска на втором. Допустим, что после подключения к компьютеру им назначаются имена устройств /dev/sdb и /dev/sdc соответственно. То есть нужно скопировать содержимое первого диска на второй.<br>- Как вариант, если к компьютеру подключено только первое устройство, можно скопировать его содержимое в обычный файл, который впоследствии использовать для восстановления или копирования.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# dd if=/dev/sdb of=/dev/sdc<br>[root@kvmcentos ~]# dd if=/dev/sdc of=flash_drive.img<br><strong>Task:</strong><br>Поиск процессов, которые "держат" удаленные файлы.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# lsof | grep deleted<br>pulseaudi 2309&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ubuntu&nbsp;&nbsp;6u&nbsp;&nbsp;  REG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,1  67108864&nbsp;&nbsp;  34867 /memfd:pulseaudio (deleted)<br>gnome-she 2601 2612 gmain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   ubuntu   32r&nbsp;&nbsp;  REG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8,5&nbsp;&nbsp; 32768&nbsp;&nbsp; 414249 /home/ubuntu/.local/share/gvfs-metadata/root-91a6702b.log (deleted)<br>...<br>Web\x20Co 4259 4279 ProfilerC&nbsp;&nbsp;&nbsp;&nbsp;   ubuntu   68r&nbsp;&nbsp;  REG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,1&nbsp;&nbsp; 19462&nbsp;&nbsp;  49425 /memfd:mozilla-ipc (deleted)<br>Web\x20Co 4259 4279 ProfilerC&nbsp;&nbsp;&nbsp;&nbsp;   ubuntu   69r&nbsp;&nbsp;  REG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,1&nbsp;&nbsp;  9566&nbsp;&nbsp;  49427 /memfd:mozilla-ipc (deleted)<br><strong>Task:</strong><br>Как очистить раздел от мусора в командной строке? Это файлы с расширениями .tmp,.trace,*.out и файлы старше 7 дней.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# find /opt/tdir -iname "*.out" -daystart -atime +7 -exec rm {} \;<br>root@kvmubuntu:~# crontab -e<br>1 1 * * * /usr/bin/find /opt/tdir -iname "*.out" -daystart -atime +7 -exec rm {} \;<br><strong>Task:</strong><br>Удалить раздел из диска<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# fdisk -l<br>root@kvmubuntu:~# fdisk /dev/sdb<br>  d<br>  p<br>  w<br><strong>Source:</strong><br># https://wiki.merionet.ru/servernye-resheniya/81/kak-udalit-razdel-diska-v-linux/<br><strong>Task:</strong><br>Перемещение папки /var на другой физический диск.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# lsblk<br>NAME&nbsp;&nbsp;&nbsp;&nbsp;MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS<br>...<br>sdc&nbsp;&nbsp;&nbsp;&nbsp;   8:32   0 931,5G  0 disk <br>root@kvmubuntu:~# fdisk /dev/sdc<br>...<br>Команда (m для справки): n<br>...<br>Выберите (по умолчанию - p):p<br>Номер раздела (1-4, default 1): <br>Первый сектор (2048-1953525167, default 2048): <br>Last sector, +/-sectors or +/-size{K,M,G,T,P} (2048-1953525167, default 1953525167): <br>...<br>Do you want to remove the signature? [Y] Да/[N] Нет: Y<br>...<br>Команда (m для справки): w<br>root@kvmubuntu:~# lsblk<br>NAME&nbsp;&nbsp;&nbsp;&nbsp;MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS<br>...<br>sdc&nbsp;&nbsp;&nbsp;&nbsp;   8:32   0 931,5G  0 disk <br>└─sdc1&nbsp;&nbsp;&nbsp;&nbsp;8:33   0 931,5G  0 part <br>root@kvmubuntu:~# mkfs -t ext4 /dev/sdc1<br>mke2fs 1.46.5 (30-Dec-2021)<br>...<br>Allocating group tables: done&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>Writing inode tables: done&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>Creating journal (262144 blocks): done<br>Writing superblocks and filesystem accounting information: done<br>root@kvmubuntu:~# mount /dev/sdc1 /mnt<br>root@kvmubuntu:~# lsblk<br>NAME&nbsp;&nbsp;&nbsp;&nbsp;MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS<br>...<br>sdc&nbsp;&nbsp;&nbsp;&nbsp;   8:32   0 931,5G  0 disk <br>└─sdc1&nbsp;&nbsp;&nbsp;&nbsp;8:33   0 931,5G  0 part /mnt<br>root@kvmubuntu:~# shopt -s dotglob<br>root@kvmubuntu:~# rsync -aulvXpogtr /var/* /mnt<br>sending incremental file list<br>...<br>total size is 63,868,813,893  speedup is 1.00<br>root@kvmubuntu:~# ls -Zd /var<br>system_u:object_r:var_t:s0 /var<br>root@kvmubuntu:~# ls -Zd /mnt<br>system_u:object_r:unlabeled_t:s0 /mnt<br>root@kvmubuntu:~# chcon -t var_t /mnt<br>root@kvmubuntu:~# ls -Zd /mnt<br>system_u:object_r:var_t:s0 /mnt<br>root@kvmubuntu:~# umount /mnt<br>root@kvmubuntu:~# blkid | grep sdc<br>/dev/sdc1: UUID="823ae1fa-...-b71dbb654f1f" TYPE="ext4" PARTUUID="3d352be0-01"<br>root@kvmubuntu:~# vim /etc/fstab<br>root@kvmubuntu:~# cat /etc/fstab | grep ext4<br>UUID=823ae1fa-...-b71dbb654f1f   /var  ext4  defaults,noatime,nofail 0 2<br>root@kvmubuntu:~# mv /var /var.back<br>root@kvmubuntu:~# mkdir /var<br>root@kvmubuntu:~# mount -av<br>/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ignored<br>...<br>/var&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : successfully mounted<br>root@kvmubuntu:~# ls /var<br>account  crash  ftp&nbsp;&nbsp;   lib&nbsp;&nbsp;log&nbsp;&nbsp;&nbsp;&nbsp; nis&nbsp;&nbsp;   run&nbsp;&nbsp;yp<br>adm&nbsp;&nbsp;  db&nbsp;&nbsp; games&nbsp;&nbsp; local  lost+found  opt&nbsp;&nbsp;   spool<br>cache&nbsp;&nbsp;empty  kerberos  lock   mail&nbsp;&nbsp;&nbsp;&nbsp;preserve  tmp<br>root@kvmubuntu:~# lsblk<br>NAME&nbsp;&nbsp;&nbsp;&nbsp;MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS<br>...<br>sdc&nbsp;&nbsp;&nbsp;&nbsp;   8:32   0 931,5G  0 disk <br>└─sdc1&nbsp;&nbsp;&nbsp;&nbsp;8:33   0 931,5G  0 part /var<br><strong>Source:</strong><br># http://sysengineering.ru/notes/peremeschenie-papok-linux-na-drugoy-disk?ysclid=lisfix46x1712981898<br># https://losst.pro/kakuyu-fajlovuyu-sistemu-vybrat-dlya-linux?ysclid=lishte72fq279374732<br><strong>Task:</strong><br>Анализ Линукс системы<br>- оценить объем свободной памяти RAM, раздела подкачки<br>- оценить нагрузку на дисковую подсистему<br>- Как просмотреть нагрузку на диск в Linux<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# free<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total&nbsp;&nbsp;&nbsp;&nbsp;used&nbsp;&nbsp;&nbsp;&nbsp;free&nbsp;&nbsp;  shared  buff/cache   available<br>  Mem:&nbsp;&nbsp;&nbsp;&nbsp;2034736&nbsp;&nbsp;  956720&nbsp;&nbsp;   80744&nbsp;&nbsp;&nbsp;&nbsp;6856&nbsp;&nbsp;  997272&nbsp;&nbsp;  883316<br>  Swap:&nbsp;&nbsp;   2097148&nbsp;&nbsp;   14668&nbsp;&nbsp; 2082480<br>root@kvmubuntu:~# df<br>  Filesystem&nbsp;&nbsp; 1K-blocks&nbsp;&nbsp;  Used Available Use% Mounted on<br>  udev&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  987820&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;987820   0% /dev<br>  ...<br>  tmpfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 203472&nbsp;&nbsp;&nbsp;&nbsp; 8&nbsp;&nbsp;203464   1% /run/user/1000<br>root@kvmubuntu:~# apt install sysstat<br>root@kvmubuntu:~# iostat -xtc<br>  Linux 5.15.0-41-generic (i-1) 05.09.2022 _x86_64_ (4 CPU)<br>  05.09.2022 10:58:39<br>  avg-cpu: %user %nice %system %iowait %steal %idle<br>  25,40 0,14 11,25 4,76 0,00 58,46<br>  Device r/s rkB/s rrqm/s %rrqm r_await rareq-sz w/s wkB/s wrqm/s %wrqm w_await wareq-sz d/s dkB/s drqm/s %drqm d_await dareq-sz f/s f_await aqu-sz %util<br>  loop0 0,00 0,00 0,00 0,00 2,21 1,21 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00<br>  loop1 0,01 0,05 0,00 0,00 25,33 7,80 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,02<br>  ...<br>  sda 4,91 204,42 1,88 27,67 37,92 41,66 3,40 97,10 4,79 58,47 27,11 28,55 0,00 0,00 0,00 0,00 0,00 0,00 0,57 50,53 0,31 5,08<br>  sr0 0,00 0,00 0,00 0,00 1,60 0,20 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00 0,00<br>root@kvmubuntu:~# pidstat -dl 5<br>  Linux 5.15.0-41-generic (i-1) 05.09.2022 _x86_64_ (4 CPU)<br>  11:01:25 UID PID kB_rd/s kB_wr/s kB_ccwr/s iodelay Command<br>  11:01:30 1000 3367 0,00 4,76 0,00 0 /snap/firefox/1794/usr/lib/firefox/firefox<br>  ...<br>  Среднее: UID PID kB_rd/s kB_wr/s kB_ccwr/s iodelay Command<br>  Среднее: 1000 3367 0,00 2,96 0,00 0 /snap/firefox/1794/usr/lib/firefox/firefox<br>  Среднее: 1000 61402 0,00 1,60 0,00 0 /opt/sublime_text/sublime_text --detached<br><strong>Source:</strong><br># https://te.legra.ph/Kak-prosmotret-nagruzku-na-disk-v-Linux-07-07<br><strong>Task:</strong><br>Создайте скрипт, который будет создавать файл. <br>- После чего скрипт будет прописывать последнюю строчку из сообщений syslog в этот файл.<br>- Затем будет отправлять в syslog своё сообщение - «Logs collected».<br>- Настройте rsyslog, чтобы логи, посланные этим скриптом, сохранялись в отдельном файле «collect.log» в директории /var/log.<br>- Настройте ротацию этих логов, чтобы они сохранялись на протяжении месяца с еженедельной ротацией.<br>- Запустите скрипт и убедитесь, что все ранее проделанные шаги выполнили свою задачу.<br># Написаниие скриптов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# chmod +x LogScript1.sh<br>root@kvmubuntu:~# ./LogScript1.sh<br>root@kvmubuntu:~# cat /var/log/messages | grep 'Logs collected'<br>  Logs collected<br>root@kvmubuntu:~# logger -p local4.info "Logs Collected"<br>root@kvmubuntu:~# journalctl -p info | grep 'Logs Collected'<br>  апр 28 09:21:31 i6.rt.ru ur[5962]: Logs Collected<br>root@kvmubuntu:~# vim /etc/rsyslog.conf<br>root@kvmubuntu:~# cat /etc/rsyslog.conf<br>....<br># Save boot messages also to boot.log<br>local7.*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/var/log/boot.log<br>local4.*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/var/log/collect.log<br>...<br>root@kvmubuntu:~# systemctl restart rsyslog<br>root@kvmubuntu:~# ./LogScript1.sh<br>root@kvmubuntu:~# cat /var/log/collect.log<br>  Apr 28 09:41:29 i6 ur[6135]: Logs Collected<br>root@kvmubuntu:~# logger -p local4.info "Logs Collected"<br>root@kvmubuntu:~# cat /var/log/collect.log<br>  Apr 28 09:41:29 i6 ur[6135]: Logs Collected<br>  Apr 28 09:44:28 i6 ur[6162]: Logs Collected<br>root@kvmubuntu:~# vim /etc/logrotate.d/collect.conf<br>root@kvmubuntu:~# cat /etc/logrotate.d/collect.conf<br>/var/log/collect.log<br>{<br>  dateext<br>  weekly<br>  rotate 4<br>}<br>root@kvmubuntu:~# logrotate -d /etc/logrotate.d/collect.conf<br>  WARNING: logrotate in debug mode does nothing except printing debug messages!  Consider using verbose mode (-v) instead if this is not what you want.<br>  reading config file /etc/logrotate.d/collect.conf<br>  Reading state from file: /var/lib/logrotate/logrotate.status<br>  Allocating hash table for state file, size 64 entries<br>  Handling 1 logs<br>  rotating pattern: /var/log/collect.log<br>  weekly (4 rotations)<br>  empty log files are rotated, old logs are removed<br>  considering log /var/log/collect.log<br>  Creating new state<br>  Now: 2022-04-28 10:14<br>  Last rotated at 2022-04-28 10:00<br>  log does not need rotating (log has been already rotated)<br>root@kvmubuntu:~# logrotate -f /etc/logrotate.d/collect.conf<br>root@kvmubuntu:~# ls -l /var/log/colle*<br>  -rw-------. 1 root root 112 апр 28 09:44 /var/log/collect.log-20220428<br>root@kvmubuntu:~# ./LogScript1.sh<br>root@kvmubuntu:~# journalctl -e<br>  ...<br>  апр 28 10:46:50 i6.rt.ru sudo[6584]:&nbsp;&nbsp; ur : TTY=pts/1 ; PWD=/home/ur ; ur=root ; COMMAND=./LogScript1.sh<br>  ...<br>root@kvmubuntu:~# tail -n 20 /var/log/messages<br>  ...<br>  Logs collected<br>  ...<br>root@kvmubuntu:~# logger -p local4.info "Logs Collected"<br>root@kvmubuntu:~# cat /var/log/collect.log<br>  cat: /var/log/collect.log: No such file or directory<br>root@kvmubuntu:~# cat /var/log/collect.log-20220428<br>  Apr 28 09:41:29 i6 ur[6135]: Logs Collected<br>  Apr 28 09:44:28 i6 ur[6162]: Logs Collected<br>  Apr 28 10:38:59 i6 ur[6437]: Logs Collected<br>  Apr 28 10:49:34 i6 ur[6601]: Logs Collected<br>root@kvmubuntu:~# tail -n 20 /var/log/messages<br>  ...<br>  Apr 28 10:49:34 i6 ur[6601]: Logs Collected<br>  ...<br><strong>Task:</strong><br>Создайте скрипт, который будет отправлять логи в syslog – This is normal log → debug, <br>This is error → error и This is critical error → crit. <br>Настройте syslog, чтобы записывал эти логи в соответствующие файлы - /var/log/mylog.debug, /var/log/mylog.crit, /var/log/mylog.error. <br>Настройте ротацию этих логов, чтобы они ротировались 5 раз. <br>debug и error должны ротировались ежедневно, debug с сжатием, а error без сжатия. crit должен ротироваться раз в неделю.<br># Написаниие скриптов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ./LogScript2.sh<br>root@kvmubuntu:~# cat /etc/rsyslog.conf<br># rsyslog configuration file<br>...<br># Save boot messages also to boot.log<br>local4.*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/var/log/collect.log<br>local7.*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/var/log/boot.log<br># ### sample forwarding rule ###<br>...<br>#Target="remote_host" Port="XXX" Protocol="tcp")<br>local1.*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/var/log/mylog.debug<br>local2.*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  /var/log/mylog.error<br>local3.*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  /var/log/mylog.crit<br>root@kvmubuntu:~# ls /var/log/mylog.<br>  mylog.crit-20220428&nbsp;&nbsp;  mylog.debug-20220428.gz  mylog.error-20220428&nbsp;&nbsp; <br>root@kvmubuntu:~# cat /var/log/mylog.crit-20220428<br>  Apr 28 11:46:30 i6 root[6943]: This is critical error -&gt; crit<br>root@kvmubuntu:~# cat /var/log/mylog.error-20220428<br>  Apr 28 11:46:30 i6 root[6942]: This is error -&gt; error<br>root@kvmubuntu:~# cat /etc/logrotate.d/mylog<br>mylogcrit.conf   mylogdebug.conf  mylogerror.conf  <br>root@kvmubuntu:~# cat /etc/logrotate.d/mylogdebug.conf<br>/var/log/mylog.debug<br>{<br>  dateext<br>  daily<br>  rotate 5<br>  compress<br>}<br>root@kvmubuntu:~# cat /var/log/messages | grep 'This is '<br>  Apr 28 11:34:58 i6 ur[6745]: This is error -&gt; error<br>  Apr 28 11:34:58 i6 ur[6746]: This is critical error -&gt; crit<br>  Apr 28 11:35:31 i6 root[6766]: This is error -&gt; error<br>  Apr 28 11:35:31 i6 root[6767]: This is critical error -&gt; crit<br>  Apr 28 11:40:00 i6 root[6828]: This is error -&gt; error<br>  Apr 28 11:40:00 i6 root[6829]: This is critical error -&gt; crit<br>  Apr 28 11:42:18 i6 root[6872]: This is error -&gt; error<br>  Apr 28 11:42:18 i6 root[6873]: This is critical error -&gt; crit<br>  Apr 28 11:44:04 i6 root[6903]: This is error -&gt; error<br>  Apr 28 11:44:04 i6 root[6904]: This is critical error -&gt; crit<br>  Apr 28 11:46:30 i6 root[6942]: This is error -&gt; error<br>  Apr 28 11:46:30 i6 root[6943]: This is critical error -&gt; crit<br>root@kvmubuntu:~# journalctl -e | grep 'This is '<br>  апр 28 11:34:58 i6.rt.ru ur[6744]: This is normal log -&gt; debug<br>  апр 28 11:34:58 i6.rt.ru ur[6745]: This is error -&gt; error<br>  апр 28 11:34:58 i6.rt.ru ur[6746]: This is critical error -&gt; crit<br>  апр 28 11:35:31 i6.rt.ru root[6765]: This is normal log -&gt; debug<br>  апр 28 11:35:31 i6.rt.ru root[6766]: This is error -&gt; error<br>  апр 28 11:35:31 i6.rt.ru root[6767]: This is critical error -&gt; crit<br>  апр 28 11:40:00 i6.rt.ru root[6827]: This is normal log -&gt; debug<br>  апр 28 11:40:00 i6.rt.ru root[6828]: This is error -&gt; error<br>  апр 28 11:40:00 i6.rt.ru root[6829]: This is critical error -&gt; crit<br>  апр 28 11:42:18 i6.rt.ru root[6871]: This is normal log -&gt; debug<br>  апр 28 11:42:18 i6.rt.ru root[6872]: This is error -&gt; error<br>  апр 28 11:42:18 i6.rt.ru root[6873]: This is critical error -&gt; crit<br>  апр 28 11:44:04 i6.rt.ru root[6902]: This is normal log -&gt; debug<br>  апр 28 11:44:04 i6.rt.ru root[6903]: This is error -&gt; error<br>  апр 28 11:44:04 i6.rt.ru root[6904]: This is critical error -&gt; crit<br>  апр 28 11:46:30 i6.rt.ru root[6941]: This is normal log -&gt; debug<br>  апр 28 11:46:30 i6.rt.ru root[6942]: This is error -&gt; error<br>  апр 28 11:46:30 i6.rt.ru root[6943]: This is critical error -&gt; crit<br><strong>Task:</strong><br>Создайте файл /etc/allowedurs, в котором пропишите логин своего пользователя.<br>Создайте скрипт, который сначала проверит, имеет ли данный текущий пользователь право запускать скрипт <br>(пользователь должен быть в списке /etc/allowedurs).<br>Если прав нету, то следует вывести на экран сообщение «This incident will be reported», а в syslog в секцию error написать «ur urname tried to run this script!». <br>После запуска скрипт должен вывести содержимое директории /data/. <br>После чего предложить пользователю указать имя файла и указать дату и время модификации для смены.<br># Написаниие скриптов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# vim /etc/allowedurs<br>root@kvmubuntu:~# cat /etc/allowedurs<br>root<br>it<br>root@kvmubuntu:~# whoami<br>  ur<br>root@kvmubuntu:~# ./LogScript3.sh<br>  This incident will be reported<br>  testfile1  testfile2  testfile3  testfile4  testfile5<br>  specify the file name: ur2<br>  specify the modification date and time for the shift: 2019.10.12 19:15   <br>root@kvmubuntu:~# journalctl -e | grep 'tried to run this '<br>  апр 28 16:23:20 i6.rt.ru ur[8491]: ur urname tried to run this script!<br>  апр 28 16:24:51 i6.rt.ru ur[8513]: ur ur tried to run this script!<br>  апр 28 16:26:52 i6.rt.ru ur[8534]: ur ur tried to run this script!<br>  апр 28 16:30:09 i6.rt.ru ur[8556]: ur ur tried to run this script!<br>  апр 28 16:33:16 i6.rt.ru ur[8567]: ur ur tried to run this script!<br>  апр 28 16:34:36 i6.rt.ru ur[8591]: ur ur tried to run this script!<br><strong>Source:</strong><br># https://www.youtube.com/playlist?list=PLg5SS_4L6LYuu1RAT4l1tCkZrJzkIaNgL<br><strong>Task:</strong><br>Как в Bash проверить, содержит ли строка подстроку<br># Написаниие скриптов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ./testSubLine.sh<br>Подстрока найдена!<br><strong>Source:</strong><br># https://zalinux.ru/?p=3870<br><strong>Task:</strong><br>Сохранить результат команды в переменную<br># Написаниие скриптов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ./saveResult.sh<br>hello<br><strong>Source:</strong><br># https://ru.stackoverflow.com/questions/326774/%D0%A1%D0%BE%D1%85%D1%80%D0%B0%D0%BD%D0%B8%D1%82%D1%8C-%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82-%D0%BA%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4%D1%8B-%D0%B2-%D0%BF%D0%B5%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%BD%D1%83%D1%8E?ysclid=l7mv4wpacm631163365<br><strong>Task:</strong><br>Разрешите пользователю helpdesk1 запускать команду NewBackup от имени пользователя backup. <br>Команда NewBackup должна создавать сжатый архив директории /data и сохранять его в домашней директории <br>пользователя backup с датой в названии.<br># Написаниие скриптов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# useradd backup1<br>root@kvmubuntu:~# passwd backup1<br>  Изменение пароля пользователя backup1.<br>  Новый пароль:<br>  НЕУДАЧНЫЙ ПАРОЛЬ: Пароль должен содержать не менее 8 символов<br>  Повторите ввод нового пароля:<br>  passwd: данные аутентификации успешно обновлены.<br>root@kvmubuntu:~# mkdir /data<br>root@kvmubuntu:~# touch /data/testfile{1..5}<br>root@kvmubuntu:~# ls -l /data/<br>  итого 0<br>  -rw-r--r--. 1 root root 0 апр 14 13:14 testfile1<br>  -rw-r--r--. 1 root root 0 апр 14 13:14 testfile2<br>  -rw-r--r--. 1 root root 0 апр 14 13:14 testfile3<br>  -rw-r--r--. 1 root root 0 апр 14 13:14 testfile4<br>  -rw-r--r--. 1 root root 0 апр 14 13:14 testfile5<br>root@kvmubuntu:~# bash /home/tuser/startBackup.sh<br>  tar: Удаляется начальный `/' из имен объектов<br>  /data/<br>  /data/testfile5<br>  /data/testfile1<br>  /data/testfile3<br>  /data/testfile2<br>  /data/testfile4<br>root@kvmubuntu:~# r-t -rf /home/backup1/testArchive150422.tar.gz<br>root@kvmubuntu:~# cp startBackup.sh /usr/bin/<br>root@kvmubuntu:~# cat /etc/sudoers<br>  ...<br>  ## Allow root to run any commands anywhere<br>  root&nbsp;&nbsp;ALL=(ALL)&nbsp;&nbsp; ALL<br>  sysadmin&nbsp;&nbsp;&nbsp;&nbsp;ALL=(ALL)&nbsp;&nbsp;   ALL<br>  netadmin&nbsp;&nbsp;&nbsp;&nbsp;ALL=(root)&nbsp;&nbsp;  /usr/bin/nmtui<br>  #helpdesk1&nbsp;&nbsp;   ALL=(ALL)   /usr/bin/passwd, !/usr/bin/passwd sysadmin, !/usr/bin/passwd root<br>  ...<br>root@kvmubuntu:~# visudo<br>root@kvmubuntu:~# cat /etc/sudoers<br>  ...<br>  ## Allow root to run any commands anywhere<br>  root&nbsp;&nbsp;ALL=(ALL)&nbsp;&nbsp; ALL<br>  sysadmin&nbsp;&nbsp;&nbsp;&nbsp;ALL=(ALL)&nbsp;&nbsp;   ALL<br>  netadmin&nbsp;&nbsp;&nbsp;&nbsp;ALL=(root)&nbsp;&nbsp;  /usr/bin/nmtui<br>  #helpdesk1&nbsp;&nbsp;   ALL=(ALL)   /usr/bin/passwd, !/usr/bin/passwd sysadmin, !/usr/bin/passwd root<br>  backup1&nbsp;&nbsp; ALL=(ALL)&nbsp;&nbsp;ALL<br>  helpdesk1&nbsp;&nbsp; ALL=(backup1)&nbsp;&nbsp;/usr/bin/startBackup.sh<br>  ...<br>root@kvmubuntu:~# su - helpdesk1<br>root@kvmubuntu:~# su - backup1 -c "sudo startBackup.sh"<br>  sudo: a ter-tinal is required to read the password; either use the -S option to read from standard input or configure an askpass helper<br>root@kvmubuntu:~# su - helpdesk1<br>  Последний вход в систему: Пт апр 15 14:24:48 +08 2022 на pts/0<br>root@kvmubuntu:~# su - backup1 startBackup.sh<br>  Последний вход в систему: Пт апр 15 14:27:43 +08 2022 на pts/0<br>  tar: Удаляется начальный `/' из имен объектов<br>  /data/<br>  /data/testfile5<br>  /data/testfile1<br>  /data/testfile3<br>  /data/testfile2<br>  /data/testfile4<br>root@kvmubuntu:~# exit<br>  выход<br>root@kvmubuntu:~# ls -l /home/backup1/<br>  итого 4<br>  -rw-r--r--. 1 root&nbsp;&nbsp;root&nbsp;&nbsp;183 апр 15 14:28 testArchive150422.tar.gz<br><strong>Task:</strong><br>Напишите сценарий, который выводит дату, время, список зарегистрировавшихся пользователей, и uptime системы и сохраняет эту информацию в системном журнале.<br># Написаниие скриптов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ./aboutUserLogFile.sh<br>  выводит число секунд прошедших с начала эпохи unix:<br>  1633836259<br>  выводит локальное время:<br>  2021-10-09 22:24:19<br>  список зарегистрировавшихся обычных пользователей, которые создаются с UID от UID_MIN до UID_MAX которые определены в файле /etc/login.defs:<br>  UID_MIN=1000<br>  UID_MAX=60000<br>  из файла /etc/passwd выбрать только тех пользователей у которых UID (третий столбик :) из этого диапазона:<br>  ubuntu<br>  uptime системы:<br>  up 21 minutes<br>root@kvmubuntu:~# ./aboutUserLogFile2.sh<br>root@kvmubuntu:~# journalctl SYSLOG_IDENTIFIER="задача3"<br>  -- Logs begin at Fri 2021-05-21 06:21:13 CDT, end at Sat 2021-10-09 22:33:30 CDT. --<br>  Oct 09 22:25:25 ubuntu-VirtualBox задача3[2796]: Дата и Время:&nbsp;&nbsp;&nbsp;&nbsp;   2021-10-09 22:25:25<br>  Oct 09 22:25:25 ubuntu-VirtualBox задача3[2796]: Пользователи:&nbsp;&nbsp;&nbsp;&nbsp;   ubuntu<br>  Oct 09 22:25:25 ubuntu-VirtualBox задача3[2796]: Время работы (начало):  2021-10-09 22:02:57<br>  Oct 09 22:25:25 ubuntu-VirtualBox задача3[2796]: Время работы (прошло):  up 22 minutes<br>  Oct 09 22:26:23 ubuntu-VirtualBox задача3[2826]: Дата и Время:&nbsp;&nbsp;&nbsp;&nbsp;   2021-10-09 22:26:23<br>  Oct 09 22:26:23 ubuntu-VirtualBox задача3[2826]: Пользователи:&nbsp;&nbsp;&nbsp;&nbsp;   ubuntu<br>  Oct 09 22:26:23 ubuntu-VirtualBox задача3[2826]: Время работы (начало):  2021-10-09 22:02:57<br>  Oct 09 22:26:23 ubuntu-VirtualBox задача3[2826]: Время работы (прошло):  up 23 minutes<br>  Oct 09 22:29:41 ubuntu-VirtualBox задача3[2846]: Дата и Время:&nbsp;&nbsp;&nbsp;&nbsp;   2021-10-09 22:29:41<br>  Oct 09 22:29:41 ubuntu-VirtualBox задача3[2846]: Пользователи:&nbsp;&nbsp;&nbsp;&nbsp;   ubuntu<br>  Oct 09 22:29:41 ubuntu-VirtualBox задача3[2846]: Время работы (начало):  2021-10-09 22:02:57<br>  Oct 09 22:29:41 ubuntu-VirtualBox задача3[2846]: Время работы (прошло):  up 26 minutes<br>  Oct 09 22:31:48 ubuntu-VirtualBox задача3[2868]: Дата и Время:&nbsp;&nbsp;&nbsp;&nbsp;   2021-10-09 22:31:48<br>  Oct 09 22:31:48 ubuntu-VirtualBox задача3[2868]: Пользователи:&nbsp;&nbsp;&nbsp;&nbsp;   ubuntu<br>  Oct 09 22:31:48 ubuntu-VirtualBox задача3[2868]: Время работы (начало):  2021-10-09 22:02:57<br>  Oct 09 22:31:48 ubuntu-VirtualBox задача3[2868]: Время работы (прошло):  up 28 minutes<br>  Oct 09 22:33:30 ubuntu-VirtualBox задача3[2885]: Дата и Время:&nbsp;&nbsp;&nbsp;&nbsp;   2021-10-09 22:33:30<br>  Oct 09 22:33:30 ubuntu-VirtualBox задача3[2885]: Пользователи:&nbsp;&nbsp;&nbsp;&nbsp;   ubuntu<br>  Oct 09 22:33:30 ubuntu-VirtualBox задача3[2885]: Время работы (начало):  2021-10-09 22:02:57<br>  Oct 09 22:33:30 ubuntu-VirtualBox задача3[2885]: Время работы (прошло):  up 30 minutes<br><strong>Task:</strong><br>Создайте функции просмотра информации о пользователе(1), создания пользователя(2), удаления пользователя (3). <br>Используйте case и select для использования этих функций в виде меню.<br># Написаниие скриптов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ./aboutUser1.sh<br>1) About user<br>2) Add user<br>3) Delete user<br>4) Exit<br>#? 1<br>About user: d<br>d:x:1000:1000:,,,:/home/d:/bin/bash<br>#? 4<br>user<br><strong>Task:</strong><br>Создайте скрипт, который запрашивает имя пользователя, а в ответ выводит информацию о пользователе – его uid, домашнюю директорию, список групп, в которых он состоит.<br>После этого скрипт должен спросить, что следует поменять – uid, домашнюю директорию или группу.<br>Если uid, то сначала проверить, доступен ли такой uid, если нет – то один раз предложить ввести заново.<br>Если домашнюю директорию, то спросить, на какую директорию следует сменить, а также следует ли перемещать домашнюю директорию.<br>После чего следует вывести на экран итоговую команду.<br># Написаниие скриптов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ./aboutUser2.sh<br>Print username: tuser<br>uid = 1000<br>home = /home/tuser<br>group = dialout<br>cdrom<br>floppy<br>sudo<br>audio<br>dip<br>video<br>plugdev<br>netdev<br>What should be changed? (uid/home/group): uid<br>Write youser own version: 45435<br>Re-Enter. Write youser own version: 34534<br><strong>Task:</strong><br>Записать строку в конец файла linux.<br># Написание скриптов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# cat testfile<br>  Hey<br>root@kvmubuntu:~# ./writeEndFile.sh<br>root@kvmubuntu:~# ./writeEndFile.sh<br>root@kvmubuntu:~# cat testfile<br>  Hey<br>  bro<br>  bro<br><strong>Source:</strong><br># https://jeka.by/ask/165/bash-add-string-in-file/<br><strong>Task:</strong><br>Cинхронизация файлов и каталогов с удаленной системой<br>Давайте попробуем синхронизировать несколько локальных файлов. <br>- Сначала очистим наш каталог foo. <br>- Далее синхронизируем каталог playground с соответствующей копией в foo и запустим команду еще раз. <br>- теперь изменить файл в playground и запустить rsync еще раз<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# rm -rf foo/*<br>root@kvmubuntu:~# rsync -av playground foo<br>&nbsp;&nbsp;  sending incremental file list<br>&nbsp;&nbsp;  playground/<br>&nbsp;&nbsp;  playground/dir-001/<br>&nbsp;&nbsp;  playground/dir-001/file-A<br>&nbsp;&nbsp;  playground/dir-001/file-B<br>&nbsp;&nbsp;  playground/dir-001/file-C<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  playground/dir-100/file-X<br>&nbsp;&nbsp;  playground/dir-100/file-Y<br>&nbsp;&nbsp;  playground/dir-100/file-Z<br>&nbsp;&nbsp;  sent 138,130 bytes  received 49,852 bytes  375,964.00 bytes/sec<br>&nbsp;&nbsp;  total size is 0  speedup is 0.00<br>root@kvmubuntu:~# rsync -av playground foo<br>&nbsp;&nbsp;  sending incremental file list<br>&nbsp;&nbsp;  sent 36,415 bytes  received 133 bytes  73,096.00 bytes/sec<br>&nbsp;&nbsp;  total size is 0  speedup is 0.00<br>root@kvmubuntu:~# touch playground/dir-099/file-Z<br>root@kvmubuntu:~# rsync -av playground foo<br>&nbsp;&nbsp;  sending incremental file list<br>&nbsp;&nbsp;  playground/dir-099/file-Z<br>&nbsp;&nbsp;  sent 36,467 bytes  received 158 bytes  73,250.00 bytes/sec<br>&nbsp;&nbsp;  total size is 0  speedup is 0.00<br><strong>Task:</strong><br>Необходимо отсортировать содержимое tennis.txt по второму столбцу.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# cat tennis.txt<br>&nbsp;&nbsp;  Amelie Mauresmo, Fra<br>&nbsp;&nbsp;  Kim Clijsters, BEL<br>&nbsp;&nbsp;  Justine Henin, Bel<br>&nbsp;&nbsp;  Serena Williams, usa<br>&nbsp;&nbsp;  Venus Williams, USA<br>root@kvmubuntu:~# sort -k2 tennis.txt<br>TasK:<br>Необходимо подсчитать строки в выводе утилиты env<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# env | wc -l<br><strong>Task:</strong><br>Содержимое файла tennis.txt:<br>root@kvmubuntu:~# cat tennis.txt<br>  Amelie Mauresmo, Fra<br>  Kim Clijsters, BEL<br>  Justine Henin, Bel<br>  Serena Williams, usa<br>  Venus Williams, USA<br>В результате выполнения каких команд будут выведены строки:<br>&nbsp;&nbsp;  Amelie Mauresmo, Fra<br>&nbsp;&nbsp;  Serena Williams, usa<br>&nbsp;&nbsp;  Venus Williams, USA<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# grep -E "W|M" tennis.txt<br>&nbsp;&nbsp;  Amelie Mauresmo, Fra<br>&nbsp;&nbsp;  Serena Williams, usa<br>&nbsp;&nbsp;  Venus Williams, USA<br>root@kvmubuntu:~# grep -G "M\|W" tennis.txt<br>&nbsp;&nbsp;  Amelie Mauresmo, Fra<br>&nbsp;&nbsp;  Serena Williams, usa<br>&nbsp;&nbsp;  Venus Williams, USA<br><strong>Task:</strong><br>- Найдите все директории в системе, в имени которых встречается «.d» и сохраните список в файл<br>- Найдите все файлы в системе, у которых есть suid, и скопируйте их в директорию ~/suidfiles.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# find / -name "*.d*" &gt; output.txt<br>root@kvmubuntu:~# find / -type f -per-t /u=s -exec ls -l {} \; &gt; ~/suidfiles<br><strong>Task:</strong><br>Создайте архив со всеми файлами из директории /var/log с помощью gzip, а также с помощью bzip. Сравните размеры полученных архивов.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# cd /var<br>root@kvmubuntu:~# tar -cf ~/log.tar log<br>root@kvmubuntu:~# du -h ~/log.tar<br>  17G /home/user/log.tar<br>root@kvmubuntu:~# du -h ~/log.tar<br>root@kvmubuntu:~# gzip -k ~/log.tar<br>root@kvmubuntu:~# du -h ~/log.tar.gz<br>root@kvmubuntu:~# bzip2 -k ~/log.tar<br>root@kvmubuntu:~# du -h ~/log.tar.bz2<br><strong>Task:</strong><br>- Создайте директорию exam. <br>- Внутри директории создайте файл myfile.<br>- Создайте жёсткую и символические ссылки на этот файл. <br>Переименуйте файл и символическую ссылку, чтобы их названия совпадали с их инодами.<br>Создайте сжатый архив со всей директорией. <br>Удалите из архива символическую ссылку.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# mkdir exam<br>root@kvmubuntu:~# touch exam/myfile<br>root@kvmubuntu:~# vim exam/myfile<br>root@kvmubuntu:~# cat exam/myfile<br>  Hello<br>root@kvmubuntu:~# ln exam/myfile hardlink<br>root@kvmubuntu:~# ln -s exam/myfile softlink<br>root@kvmubuntu:~# ls -li<br>  итого 8<br>  1312032 drwxrwxr-x. 2 user user 4096 мая 12 11:17 exam<br>  1320672 -rw-rw-r--. 2 user user 6 мая 12 11:17 hardlink<br>  1320670 lrwxrwxrwx. 1 user user 11 мая 12 11:17 softlink -&gt; exam/myfile<br>root@kvmubuntu:~# ls -li exam/<br>  итого 4<br>  1320672 -rw-rw-r--. 2 user user 6 мая 12 11:17 myfile<br>root@kvmubuntu:~# cat hardlink<br>  Hello<br>root@kvmubuntu:~# cat softlink<br>  Hello<br>root@kvmubuntu:~# cd exam/<br>root@kvmubuntu:~# mv myfile 1320672<br>root@kvmubuntu:~# cd ..<br>root@kvmubuntu:~# ls -li exam/<br>  итого 4<br>  1320672 -rw-rw-r--. 2 user user 6 мая 12 11:17 1320672<br>root@kvmubuntu:~# ls -li<br>  итого 8<br>  1312032 drwxrwxr-x. 2 user user 4096 мая 12 11:28 exam<br>  1320672 -rw-rw-r--. 2 user user 6 мая 12 11:17 hardlink<br>  1320670 lrwxrwxrwx. 1 user user 11 мая 12 11:17 softlink -&gt; exam/myfile<br>root@kvmubuntu:~# mv softlink 1320670<br>root@kvmubuntu:~# ls -li<br>  итого 8<br>  1320670 lrwxrwxrwx. 1 user user 11 мая 12 11:17 1320670 -&gt; exam/myfile<br>  1312032 drwxrwxr-x. 2 user user 4096 мая 12 11:28 exam<br>  1320672 -rw-rw-r--. 2 user user 6 мая 12 11:17 hardlink<br>root@kvmubuntu:~# ls -li exam/<br>  итого 4<br>  1320672 -rw-rw-r--. 2 user user 6 мая 12 11:17 1320672<br>root@kvmubuntu:~# tar -czf link.tar.gz *<br>root@kvmubuntu:~# ls -l<br>  итого 12<br>  lrwxrwxrwx. 1 user user 11 мая 12 11:17 1320670 -&gt; exam/myfile<br>  drwxrwxr-x. 2 user user 4096 мая 12 11:28 exam<br>  -rw-rw-r--. 2 user user 6 мая 12 11:17 hardlink<br>  -rw-rw-r--. 1 user user 221 мая 12 11:55 link.tar.gz<br>root@kvmubuntu:~# tar -tf link.tar.gz<br>  1320670<br>  exam/<br>  exam/1320672<br>  hardlink<br>root@kvmubuntu:~# tar --delete -f link.tar.gz 1320670<br>root@kvmubuntu:~# tar -tf link.tar.gz<br>  exam/<br>  exam/1320672<br>  hardlink<br><strong>Source:</strong><br># https://basis.gnulinux.pro/<br><strong>Task:</strong><br>- Напишите команду, которая заменит пользователя владельца каталога /home/foo на bar.<br>- Напишите команду, которая заменит группу владельца каталога /home/foo на bar.<br>- Напишите команду, которая заменит пользователя и группу владельца каталога /home/foo на bar и baz соотвественно.<br>- Напишите команду максимально короткую (т.е. в которой минимально возможное число символов), которая позволит создать в текущей директории 3 поддиректории с именами dir1, dir2, dir3<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# chown bar /home/foo<br>root@kvmubuntu:~# chgrp  bar /home/foo<br>root@kvmubuntu:~# chown bar:baz /home/foo<br>root@kvmubuntu:~# mkdir dir{1,2,3}<br>root@kvmubuntu:~# ls --sort=time -l<br>&nbsp;&nbsp;  total 105364<br>&nbsp;&nbsp;  drwxrwxr-x   2 s s&nbsp;&nbsp; 4096 Feb 12 21:36 dir1<br>&nbsp;&nbsp;  drwxrwxr-x   2 s s&nbsp;&nbsp; 4096 Feb 12 21:36 dir2<br>&nbsp;&nbsp;  drwxrwxr-x   2 s s&nbsp;&nbsp; 4096 Feb 12 21:36 dir3<br><strong>Task:</strong><br>- Сохраните в файл ~/bashusers отсортированный в алфавитном порядке список имен пользователей из /etc/passwd, которые используют командную оболочку bash.<br>- Рассмотрите вывод утилиты /sbin/ifconfig. Создайте команду, с помощью которой будут выводиться исключительно IPv4-адреса. Сохраните результат в файл ~/ipaddr.<br># Администрирование локальных серверов.  <br><strong>Decision:</strong><br>root@kvmubuntu:~# grep bash /etc/passwd | cut -d: -f1 | sort &gt; bashusers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>root@kvmubuntu:~# /sbin/ifconfig | grep 'inet' | cut -d: -f2 | cut -d' ' -f1 &gt; /ipaddr<br>root@kvmubuntu:~# ls&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;  bashusers  ipaddr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>root@kvmubuntu:~# cat bashusers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;  bar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;  baz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;  foo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;  root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>root@kvmubuntu:~# cat ipaddr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;  10.42.197.95&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;  127.0.0.1<br><strong>Task:</strong><br>Распаковать архив.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ls training_*<br>  training_8_3_23_1688_LinuxRun.tar.gz<br>root@kvmubuntu:~# tar xvzf training_8_3_23_1688_LinuxRun.tar.gz <br>  setup-training-8.3.23.1688-x86_64.run<br>  Liberica-Notice.txt<br>  LibericaJDK-8-9-10-licenses.pdf<br><strong>Source:</strong><br># https://pingvinus.ru/answers/844<br><strong>Task:</strong><br>Известно что для архивации файлов существует пакет gzip, который работает только с файлами. Также есть пакет tar, который может объединять файлы в один. Приведите команду, которая запаковывает все файлы с расширением log в каталоге /home/de13ma/de/files в архив quiz.tar.gz, при этом использует максимальную степень сжатия.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# tar -9cfvz quiz.tar.gz /home/de13ma/de/files/*.log<br><strong>Task:</strong><br>Вывести список файлов в дереве каталогов в расширенном формате (права доступа, владелец и тд)<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# tree -p /var/log/<br>  /var/log/<br>  ├── [-rw-r--r--]  alternatives.log<br>  ├── [drwxr-xr-x]  apt<br>  │   ├── [-rw-r--r--]  eipp.log.xz<br>  │   ├── [-rw-r--r--]  history.log<br>  │   ├── [-rw-r--r--]  history.log.1.gz<br>  │   ├── [-rw-r-----]  term.log<br>  │   └── [-rw-r-----]  term.log.1.gz<br>  ...<br>  └── [-rw-rw-r--]  wtmp<br>  14 directories, 65 files<br><strong>Task:</strong><br>В дереве каталогов посчитать количество файлов, каталогов<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# find /var/log/ -type f | wc -l<br>  65<br>root@kvmubuntu:~# find /var/log/ -type d | wc -l<br>  15<br><strong>Task:</strong><br>Сменить владельца каталога, файла<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ls -la /var/log<br>  total 3212<br>  -rw-r--r--   1 root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  0 Jun 26 20:52 alternatives.log<br>  -rw-r--r--   1 root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  32650 May 21 20:49 alternatives.log.1<br>  ...<br>  -rw-rw-r--   1 root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  utmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  16896 Jul  1 06:03 wtmp<br>root@kvmubuntu:~# chown ubuntu /var/log/dmesg.0<br>root@kvmubuntu:~# ls -la /var/log<br>  total 3216<br>  -rw-r--r--   1 root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  0 Jun 26 20:52 alternatives.log<br>  -rw-r--r--   1 root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  32650 May 21 20:49 alternatives.log.1<br>  ...<br>  -rw-rw-r--   1 root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  utmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  16896 Jul  1 06:03 wtmp<br><strong>Task:</strong><br>массово сменить владельца дерева каталогов<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# chown -R ubuntu /var/log/<br>root@kvmubuntu:~# ls -la /var/log<br>  total 3216<br>  -rw-r--r--   1 ubuntu root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  0 Jun 26 20:52 alternatives.log<br>  -rw-r--r--   1 ubuntu root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  32650 May 21 20:49 alternatives.log.1<br>  ...<br>  -rw-rw-r--   1 ubuntu utmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  16896 Jul  1 06:03 wtmp<br><strong>Task:</strong><br>Запустите gedit, найдите его pid, найдите pid его родительского процесса и так по цепочке все родительские pid-ы.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# gedit &<br>[1] 3965<br>[root@kvmcentos ~]# ps | grep gedit<br>3965 pts/1 00:00:01 gedit<br>[root@kvmcentos ~]# ps -ef | grep gedit<br>centos 3965 3218 1 10:01 pts/1 00:00:01 gedit<br>centos 4039 3218 0 10:03 pts/1 00:00:00 grep --color=auto gedit<br>[root@kvmcentos ~]# ps -f 3218<br>UID PID PPID C STIME TTY STAT TIME CMD<br>centos 3218 3215 0 09:25 pts/1 Ss 0:00 -bash<br>[root@kvmcentos ~]# ps -f 3215<br>UID PID PPID C STIME TTY STAT TIME CMD<br>centos 3215 3208 0 09:25 ? S 0:00 sshd: centos@pts/1<br>[root@kvmcentos ~]# ps -f 3208<br>UID PID PPID C STIME TTY STAT TIME CMD<br>root 3208 1013 0 09:25 ? Ss 0:00 sshd: centos [priv]<br>[root@kvmcentos ~]# ps -f 1013<br>UID PID PPID C STIME TTY STAT TIME CMD<br>root 1013 1 0 09:17 ? Ss 0:00 /usr/sbin/sshd -D -oCiphers=aes256-gcm@openssh.com,chacha20-poly1<br>[root@kvmcentos ~]# ps -f 1<br>UID PID PPID C STIME TTY STAT TIME CMD<br>root 1 0 0 09:15 ? Ss 0:05 /usr/lib/systemd/systemd --switched-root --system --deserialize 1<br><strong>Task:</strong><br>Запустите форк-бомбу :<br>:(){ :|:& };:<br>Затем перезагрузите виртуалку, ограничьте количество процессов у своего пользователя до 50 и заново запустите форк-бомбу.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# :(){ :|:& };:<br>[2] 4788<br>[root@kvmcentos ~]# -bash: fork: retry: Resource temporarily unavailable<br>-bash: fork: retry: Resource temporarily unavailable<br>...<br>-bash: fork: retry: Resource temporarily unavailable<br>-bash: fork: Resource temporarily unavailable<br>client_loop: send disconnect: Connection reset<br>C:\Users\tuser&gt;<br>C:\Users\tuser&gt;ssh centos@tipcentos<br>[root@kvmcentos ~]# vim ~/.bash_profile<br>[root@kvmcentos ~]# cat ~/.bash_profile<br># .bash_profile<br># Get the aliases and functions<br>if [ -f ~/.bashrc ]; then<br>. ~/.bashrc<br>fi<br># User specific environment and startup programs<br># Limits<br>ulimit -u 50<br>[root@kvmcentos ~]# :(){ :|:& };:<br><strong>Task:</strong><br>Запустите любой процесс в фоновом режиме (к примеру, gedit). Найдите его родительский процесс. <br>Найдите все дочерние процессы, которые принадлежат этому родительскому процессу. <br>Убейте родительский процесс. Проверьте дочерние процессы и найдите новый родительский процесс.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# gedit &<br>[1] 5380<br>[root@kvmcentos ~]# ps -ef | grep gedit<br>centos 5215 5164 0 12:30 pts/0 00:00:01 gedit<br>centos 5387 5285 0 12:34 pts/2 00:00:00 grep --color=auto gedit<br>[root@kvmcentos ~]# ps -f 5164<br>UID PID PPID C STIME TTY STAT TIME CMD<br>centos 5164 5159 0 12:30 pts/0 Ss+ 0:00 bash<br>[root@kvmcentos ~]# ps -ef | grep 5164<br>centos 5164 5159 0 12:30 pts/0 00:00:00 bash<br>centos 5215 5164 0 12:30 pts/0 00:00:01 gedit<br>centos 5406 5285 0 12:35 pts/2 00:00:00 grep --color=auto 5164<br>[root@kvmcentos ~]# pstree -p | grep gedit<br>| |-gnome-terminal-(5159)-+-bash(5164)---gedit(5215)-+-{gedit}(5222)<br>| | | |-{gedit}(5223)<br>| | | `-{gedit}(5224)<br>[root@kvmcentos ~]# ps -xal | grep gedit<br>0 1000 5215 5164 20 0 566668 52284 x64_sy Sl pts/0 0:01 gedit<br>0 1000 5442 5285 20 0 12136 1104 - S+ pts/2 0:00 grep --color=auto gedit<br>[root@kvmcentos ~]# kill -KILL 5164<br>[root@kvmcentos ~]# ps -ef | grep gedit<br>centos 5215 2331 0 12:30 ? 00:00:01 gedit<br>centos 5552 5285 0 12:40 pts/2 00:00:00 grep --color=auto gedit<br>[root@kvmcentos ~]# ps 2331<br>PID TTY STAT TIME COMMAND<br>2331 ? Ss 0:00 /usr/lib/systemd/systemd --user<br>[root@kvmcentos ~]# ps 1<br>PID TTY STAT TIME COMMAND<br>1 ? Ss 0:06 /usr/lib/systemd/systemd --switched-root --system --deserialize 17<br><strong>Task:</strong><br>получить полный список сигналов.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# kill -l<br> 1) SIGHUP&nbsp;&nbsp; 2) SIGINT&nbsp;&nbsp; 3) SIGQUIT&nbsp;&nbsp; 4) SIGILL&nbsp;&nbsp; 5) SIGTRAP<br> 6) SIGABRT&nbsp;&nbsp; 7) SIGBUS&nbsp;&nbsp; 8) SIGFPE&nbsp;&nbsp; 9) SIGKILL&nbsp;&nbsp;10) SIGUSR1<br>11) SIGSEGV&nbsp;&nbsp;12) SIGUSR2&nbsp;&nbsp;13) SIGPIPE&nbsp;&nbsp;14) SIGALRM&nbsp;&nbsp;15) SIGTERM<br>16) SIGSTKFLT&nbsp;&nbsp;17) SIGCHLD&nbsp;&nbsp;18) SIGCONT&nbsp;&nbsp;19) SIGSTOP&nbsp;&nbsp;20) SIGTSTP<br>21) SIGTTIN&nbsp;&nbsp;22) SIGTTOU&nbsp;&nbsp;23) SIGURG&nbsp;&nbsp;24) SIGXCPU&nbsp;&nbsp;25) SIGXFSZ<br>26) SIGVTALRM&nbsp;&nbsp;27) SIGPROF&nbsp;&nbsp;28) SIGWINCH&nbsp;&nbsp;29) SIGIO&nbsp;&nbsp;30) SIGPWR<br>31) SIGSYS&nbsp;&nbsp;34) SIGRTMIN&nbsp;&nbsp;35) SIGRTMIN+1&nbsp;&nbsp;36) SIGRTMIN+2&nbsp;&nbsp;37) SIGRTMIN+3<br>38) SIGRTMIN+4&nbsp;&nbsp;39) SIGRTMIN+5&nbsp;&nbsp;40) SIGRTMIN+6&nbsp;&nbsp;41) SIGRTMIN+7&nbsp;&nbsp;42) SIGRTMIN+8<br>43) SIGRTMIN+9&nbsp;&nbsp;44) SIGRTMIN+10&nbsp;&nbsp;45) SIGRTMIN+11&nbsp;&nbsp;46) SIGRTMIN+12&nbsp;&nbsp;47) SIGRTMIN+13<br>48) SIGRTMIN+14&nbsp;&nbsp;49) SIGRTMIN+15&nbsp;&nbsp;50) SIGRTMAX-14&nbsp;&nbsp;51) SIGRTMAX-13&nbsp;&nbsp;52) SIGRTMAX-12<br>53) SIGRTMAX-11&nbsp;&nbsp;54) SIGRTMAX-10&nbsp;&nbsp;55) SIGRTMAX-9&nbsp;&nbsp;56) SIGRTMAX-8&nbsp;&nbsp;57) SIGRTMAX-7<br>58) SIGRTMAX-6&nbsp;&nbsp;59) SIGRTMAX-5&nbsp;&nbsp;60) SIGRTMAX-4&nbsp;&nbsp;61) SIGRTMAX-3&nbsp;&nbsp;62) SIGRTMAX-2<br>63) SIGRTMAX-1&nbsp;&nbsp;64) SIGRTMAX<br><strong>Task:</strong><br>Предположим вы запустили программы firefox, filezilla и gedit в фоновом режиме. <br>После этого вы выполнили следующие действия: fg %1, Ctrl+С, fg %2, Ctrl+Z, jobs. <br>Информация о каких программах будет показана при выполнении команды jobs?<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# firefox &<br>[1] 8962<br>root@kvmubuntu:~# filezilla &<br>[2] 9141<br>root@kvmubuntu:~# gedit &<br>[3] 9184<br>root@kvmubuntu:~# jobs<br>[1] Running&nbsp;&nbsp;&nbsp;&nbsp; firefox &<br>[2]- Running&nbsp;&nbsp;&nbsp;&nbsp; filezilla &<br>[3]+ Running&nbsp;&nbsp;&nbsp;&nbsp; gedit &<br>root@kvmubuntu:~# fg %1<br>firefox<br>^C[GFX1-]: Receive IPC close with reason=AbnormalShutdown<br>Exiting due to channel error.<br>[GFX1-]: Receive IPC close with reason=AbnormalShutdown<br>Exiting due to channel error.<br>[GFX1-]: Receive IPC close with reason=AbnormalShutdown<br>Exiting due to channel error.<br>root@kvmubuntu:~# fg %2<br>filezilla<br>^Z<br>[2]+ Stopped&nbsp;&nbsp;&nbsp;&nbsp; filezilla<br>root@kvmubuntu:~# jobs<br>[2]+ Stopped&nbsp;&nbsp;&nbsp;&nbsp; filezilla<br>[3]- Running&nbsp;&nbsp;&nbsp;&nbsp; gedit &<br><strong>Task:</strong><br>запустить программу в фоне.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# packettracer &<br>[1] 3270<br>root@kvmubuntu:~# ps aux | grep packettracer<br>u   3270 0.0 0.1 18132 3192 pts/1  S  20:27 0:00 /bin/bash /usr/local/bin/packettracer<br>u   3361 0.0 0.1 17700 2796 pts/1  S+ 20:28 0:00 grep --color=auto packettracer<br>root@kvmubuntu:~# kill %1<br>root@kvmubuntu:~# ps aux | grep packettracer<br>u   3364 0.0 0.0 17700 660 pts/1  S+ 20:28 0:00 grep --color=auto packettracer<br>[1]+ Завершено   packettracer <br><strong>Source:</strong><br># https://basis.gnulinux.pro/<br># https://stepik.org/course/73/syllabus<br><strong>Task:</strong><br>посмотреть адрессацию <br>- по портам.<br>- в памяти.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# cat /proc/ioports<br>  0000-0cf7 : PCI Bus 0000:00<br>  0000-001f : dma1<br>  0020-0021 : pic1<br>  0040-0043 : timer0<br>  0050-0053 : timer1<br>  0060-0060 : keyboard<br>  0064-0064 : keyboard<br>  0070-0071 : rtc_cmos<br>...<br>d258-d25b : ahci<br>  d260-d26f : 0000:00:0d.0<br>d260-d26f : ahci<br>root@kvmubuntu:~# cat /proc/iomem<br>00000000-00000fff : Reserved<br>00001000-0009fbff : System RAM<br>0009fc00-0009ffff : Reserved<br>000a0000-000bffff : PCI Bus 0000:00<br>...<br>fee00000-fee00fff : Local APIC<br>  fee00000-fee00fff : Reserved<br>fffc0000-ffffffff : Reserved<br><strong>Task:</strong><br>Cмотрим инфу о прерываниях. например какие процессы сейчас запущены.<br>использовать утилиту dmesg для установления идентификаторов запросов прерываний, резервируемых для определенных устройств в процессе загрузки системы.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# cat /proc/interrupts<br>  CPU0&nbsp;&nbsp; CPU1&nbsp;&nbsp;   <br>0:  1320048&nbsp;&nbsp; 555  IO-APIC-edge&nbsp;&nbsp;  timer<br>1:&nbsp;&nbsp;10224&nbsp;&nbsp;   7  IO-APIC-edge&nbsp;&nbsp;  i8042<br>7:&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;   0  IO-APIC-edge&nbsp;&nbsp;  parport0<br>8:&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;   1  IO-APIC-edge&nbsp;&nbsp;  rtc<br>10:&nbsp;&nbsp; 3062&nbsp;&nbsp; 21  IO-APIC-fasteoi   acpi<br>12:&nbsp;&nbsp;  131&nbsp;&nbsp;  2  IO-APIC-edge&nbsp;&nbsp;  i8042<br>15:&nbsp;&nbsp;47073&nbsp;&nbsp;  0  IO-APIC-edge&nbsp;&nbsp;  ide1<br>18:&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;  1  IO-APIC-fasteoi   yenta<br>19:&nbsp;&nbsp;31056&nbsp;&nbsp;  1  IO-APIC-fasteoi   libata, ohci1394<br>20:&nbsp;&nbsp;19042&nbsp;&nbsp;  1  IO-APIC-fasteoi   eth0<br>21:&nbsp;&nbsp;44052&nbsp;&nbsp;  1  IO-APIC-fasteoi   uhci_hcd:usb1, uhci_hcd:usb2,...<br>22:   188352&nbsp;&nbsp;  1  IO-APIC-fasteoi   ra0<br>23:   632444&nbsp;&nbsp;  1  IO-APIC-fasteoi   nvidia<br>24:&nbsp;&nbsp; 1585&nbsp;&nbsp;  1  IO-APIC-fasteoi   VIA82XX-MODEM, VIA8237<br>root@kvmubuntu:~# dmesg | grep "irq 1[45]"<br>[ 28.930069] ata3: PATA max UDMA/133 cmd 0x1f0 ctl 0x3f6 bmdma 0x2090 irq 14<br>[ 28.930071] ata4: PATA max UDMA/133 cmd 0x170 ctl 0x376 bmdma 0x2098 irq 15<br><strong>Task:</strong><br>оценить загрузку CPU.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# top<br>top - 08:00:51 up  2:02,  2 users,  load average: 0.15, 0.12, 0.09<br>Tasks: 189 total,   2 running, 187 sleeping,   0 stopped,   0 zombie<br>%Cpu(s):  0.2 us,  0.3 sy,  0.0 ni, 99.5 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<br>MiB Mem :   1987.0 total,&nbsp;&nbsp; 83.6 free,&nbsp;&nbsp;932.0 used,&nbsp;&nbsp;971.4 buff/cache<br>MiB Swap:   2048.0 total,   2033.7 free,&nbsp;&nbsp; 14.3 used.&nbsp;&nbsp;864.9 avail Mem<br>PID USER&nbsp;&nbsp;  PR  NI&nbsp;&nbsp;VIRT&nbsp;&nbsp;RES&nbsp;&nbsp;SHR S  %CPU  %MEM&nbsp;&nbsp; TIME+ COMMAND<br>765 mysql&nbsp;&nbsp; 20   0 1733056 356604  38296 S   0.7  17.5   0:38.09 mysqld  <br>...<br> 15 root&nbsp;&nbsp;  20   0&nbsp;&nbsp;   0&nbsp;&nbsp;  0&nbsp;&nbsp;  0 S   0.0   0.0   0:00.00 cpuhp/1<br>В третьей строке приводится информация об использовании центрального процессора.<br>%Cpu(s):  0.2 us,  0.3 sy,  0.0 ni, 99.5 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<br><strong>Task:</strong><br>Как узнать, не нарушая работы программы, к каким системным библиотекам и ресурсам системы она обращается в ходе работы?<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# awk '$NF!~/\.so/{next} {$0=$NF} !a[$0]++' /proc/$PID/maps<br>readelf --dynamic /usr/bin/vim | grep NEEDED<br> 0x0000000000000001 (NEEDED)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shared library: [libm.so.6]<br> 0x0000000000000001 (NEEDED)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shared library: [libtinfo.so.6]<br> 0x0000000000000001 (NEEDED)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shared library: [libselinux.so.1]<br> 0x0000000000000001 (NEEDED)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shared library: [libcanberra.so.0]<br> 0x0000000000000001 (NEEDED)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shared library: [libacl.so.1]<br> 0x0000000000000001 (NEEDED)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shared library: [libgpm.so.2]<br> 0x0000000000000001 (NEEDED)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shared library: [libdl.so.2]<br> 0x0000000000000001 (NEEDED)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shared library: [libpython3.8.so.1.0]<br> 0x0000000000000001 (NEEDED)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shared library: [libpthread.so.0]<br> 0x0000000000000001 (NEEDED)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shared library: [libc.so.6]<br> <strong>Task:</strong><br>Передача файлов по протоколу FTP<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ftp test.rbx.net<br>&nbsp;&nbsp;  Connected to test.rbx.net.<br>&nbsp;&nbsp;  220 Microsoft FTP Service<br>Name (test.rbx.net:s): demo<br>&nbsp;&nbsp;  331 Password required for demo.<br>Password:<br>&nbsp;&nbsp;  230 User logged in.<br>&nbsp;&nbsp;  Remote system type is Windows_NT.<br>ftp&gt; lcd Desktop<br>&nbsp;&nbsp;  Local directory now /home/s/Desktop<br>ftp&gt; ls<br>&nbsp;&nbsp;  200 PORT command successful.<br>&nbsp;&nbsp;  125 Data connection already open; Transfer starting.<br>&nbsp;&nbsp;  10-19-20  03:19PM&nbsp;&nbsp;   &lt;DIR&gt;&nbsp;&nbsp;&nbsp;&nbsp;  pub<br>&nbsp;&nbsp;  04-08-14  03:09PM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  403 readme.txt<br>&nbsp;&nbsp;  226 Transfer complete.<br>ftp&gt; get readme.txt<br>&nbsp;&nbsp;  local: readme.txt remote: readme.txt<br>&nbsp;&nbsp;  200 PORT command successful.<br>&nbsp;&nbsp;  150 Opening ASCII mode data connection.<br>&nbsp;&nbsp;  226 Transfer complete.<br>&nbsp;&nbsp;  403 bytes received in 0.11 secs (3.4755 kB/s)<br>ftp&gt; bye<br>&nbsp;&nbsp;  221 Goodbye.<br>root@kvmubuntu:~# ls -l readme.txt<br>&nbsp;&nbsp;  -rw-rw-r-- 1 s s 393 Dec  4 20:17 readme.txt<br><strong>Task:</strong><br>Скопируйте при помощи SCP с удаленного сервера s1.stepik-local все файлы из директории /srv/files_on_s/ в локальную директорию /home/box/files_on_client/ (её нужно будет еще создать!). Для доступа к серверу используйте логин box и пароль supersecret, а порт указывать не нужно -- используется порт по умолчанию. Примечание: саму директорию files_on_s копировать не нужно! Таким образом, все файлы из неё должны лежать прямо в /home/box/files_on_client/<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# mkdir /home/box/files_on_client<br>root@kvmubuntu:~# scp s1.stepik-local:/srv/files_on_s/* /home/box/files_on_client/<br><strong>Task:</strong><br>Передача файлов по протоколу TFTP<br>- установить его на CentOS 8. Oбновите кэш репозитория пакетов CentOS 8<br>- Конфигурация службы systemd по умолчанию TFTP не работает корректно на CentOS 8. Таким образом, вы должны создать свою собственную версию сервиса systemd для TFTP-сервера. Cкопируйте файл default /usr/lib/systemd/system/tftp.служебный файл на /etc / systemd/system/tftp-сервер.обслуживание. Затем скопировать значения по умолчанию /usr/lib/systemd/system/tftp.socket на /etc/systemd/system/tftp-s.socket<br>- отредактируйте файл /etc/systemd/system/tftp-s.service файл.<br>- измeните  Requires=tftp.socket на Requires=tftp-s.socket.<br>- измeните  ExecStart=/usr/sbin/in.tftpd -s /var/lib/tftpboot на ExecStart=/usr/sbin/in.tftpd -c -p -s /var/lib/tftpboot.<br>- измeните  Also=tftp.socket на Also=tftp-s.socket.<br>- добавить новую строку WantedBy=multi-user.target after the [Install] line.<br>- отредактируйте файл /etc/systemd/system/tftp-s.socket файл<br>- проверьте состояние службы tftp-сервера, которую вы только что создали<br>- Если у вас включен SELinux, разрешите анонимный доступ для записи на сервер TFTP. Команда setsebool может быть недоступна на вашем компьютере CentOS 8. Если это так, установите пакет policycoreutils-python.<br>- разрешите чтение, запись и выполнение для корневого каталога TFTP /var/lib/tftpboot от любого пользователя<br>- Если у вас есть iptables, настроенный на вашем компьютере CentOS 8 (что очень вероятно), вы должны разрешить доступ к порту UDP 69<br>- Чтобы получить доступ к серверу TFTP, вы должны знать IP-адрес вашего компьютера CentOS 8. Вы можете найти IP-адрес вашего устройства CentOS 8. Чтобы получить доступ к серверу TFTP, на компьютере, с которого вы хотите получить доступ к нему, должна быть установлена клиентская программа TFTP. На CentOS 8 / RHEL 8 можно установить клиентскую программу TFTP.<br>- Чтобы загрузить файлы на ваш TFTP-сервер или загрузить файлы с вашего TFTP-сервера, вы должны перейти в каталог, где доступен файл/файлы, которые вы хотите загрузить на TFTP-сервер, или где вы хотите сохранить загруженный файл/файлы с TFTP-сервера. Допустим, вы хотите загрузить некоторые файлы / файлы из каталога /etc, а также загрузить и сохранить некоторые file/files в каталог /etc. Итак, перейдите в каталог /etc с помощью следующей команды:<br>- Пробуем подключиться к tftp с удаленного сервера<br>- Включить подробный режим<br>- загрузить файл fstab, файл hosts и сохранить его в каталоге /etc<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# dnf makecache<br>[root@kvmcentos ~]# dnf -y install xinetd<br>[root@kvmcentos ~]# dnf list | grep tftp<br>&nbsp;&nbsp;  tftp.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  5.2-24.el8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   @AppStream   <br>&nbsp;&nbsp;  tftp-s.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   5.2-24.el8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   @AppStream   <br>&nbsp;&nbsp;  erlang-tftp.x86_64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   22.0.7-1.el8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; epel&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;  syslinux-tftpboot.noarch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6.04-4.el8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   BaseOS <br>[root@kvmcentos ~]# dnf -y install tftp-s<br>[root@kvmcentos ~]# cp -v /usr/lib/systemd/system/tftp.service /etc/systemd/system/tftp-s.service<br>&nbsp;&nbsp;  '/usr/lib/systemd/system/tftp.service' -&gt; '/etc/systemd/system/tftp-s.service'<br>[root@kvmcentos ~]# cp -v /usr/lib/systemd/system/tftp.socket /etc/systemd/system/tftp-s.socket<br>&nbsp;&nbsp;  '/usr/lib/systemd/system/tftp.socket' -&gt; '/etc/systemd/system/tftp-s.socket'<br>[root@kvmcentos ~]# cat /etc/systemd/system/tftp-s.service<br>&nbsp;&nbsp;  [Unit]<br>&nbsp;&nbsp;  Description=Tftp s<br>&nbsp;&nbsp;  Requires=tftp.socket<br>&nbsp;&nbsp;  Documentation=man:in.tftpd<br>&nbsp;&nbsp;  [Service]<br>&nbsp;&nbsp;  ExecStart=/usr/sbin/in.tftpd -s /var/lib/tftpboot<br>&nbsp;&nbsp;  StandardInput=socket<br>&nbsp;&nbsp;  [Install]<br>&nbsp;&nbsp;  Also=tftp.socket<br>[root@kvmcentos ~]# vim /etc/systemd/system/tftp-s.service<br>[root@kvmcentos ~]# cat /etc/systemd/system/tftp-s.service<br>&nbsp;&nbsp;  [Unit]<br>&nbsp;&nbsp;  Description=Tftp s<br>&nbsp;&nbsp;  Requires=tftp-s.socket<br>&nbsp;&nbsp;  Documentation=man:in.tftpd<br>&nbsp;&nbsp;  [Service]<br>&nbsp;&nbsp;  ExecStart=/usr/sbin/in.tftpd -c -p -s /var/lib/tftpboot<br>&nbsp;&nbsp;  StandardInput=socket<br>&nbsp;&nbsp;  [Install]<br>&nbsp;&nbsp;  WantedBy=multi-user.target<br>&nbsp;&nbsp;  Also=tftp-s.socket<br>[root@kvmcentos ~]# cat /etc/systemd/system/tftp-s.socket<br>&nbsp;&nbsp;  [Unit]<br>&nbsp;&nbsp;  Description=Tftp s Activation Socket<br>&nbsp;&nbsp;  [Socket]<br>&nbsp;&nbsp;  ListenDatagram=69<br>&nbsp;&nbsp;  [Install]<br>&nbsp;&nbsp;  WantedBy=sockets.target<br>[root@kvmcentos ~]# vim /etc/systemd/system/tftp-s.socket<br>[root@kvmcentos ~]# cat /etc/systemd/system/tftp-s.socket<br>&nbsp;&nbsp;  [Unit]<br>&nbsp;&nbsp;  Description=Tftp s Activation Socket<br>&nbsp;&nbsp;  [Socket]<br>&nbsp;&nbsp;  ListenDatagram=69<br>&nbsp;&nbsp;  BindIPv6Only=both<br>&nbsp;&nbsp;  [Install]<br>&nbsp;&nbsp;  WantedBy=sockets.target<br>[root@kvmcentos ~]# systemctl status tftp-s.service<br>&nbsp;&nbsp;  ● tftp-s.service - Tftp s<br>&nbsp;&nbsp;&nbsp;&nbsp; Loaded: loaded (/etc/systemd/system/tftp-s.service; disabled; vendor pr&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; Active: inactive (dead)<br>&nbsp;&nbsp;&nbsp;&nbsp;   Docs: man:in.tftpd<br>[root@kvmcentos ~]# systemctl start tftp-s.service<br>[root@kvmcentos ~]# systemctl enable tftp-s.service<br>&nbsp;&nbsp;  Created symlink /etc/systemd/system/multi-user.target.wants/tftp-s.service → /etc/systemd/system/tftp-s.service.<br>&nbsp;&nbsp;  Created symlink /etc/systemd/system/sockets.target.wants/tftp-s.socket → /etc/systemd/system/tftp-s.socket.<br>[root@kvmcentos ~]# systemctl status tftp-s.service<br>&nbsp;&nbsp;  ● tftp-s.service - Tftp s<br>&nbsp;&nbsp;&nbsp;&nbsp; Loaded: loaded (/etc/systemd/system/tftp-s.service; enabled; vendor pre&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; Active: active (running) since Sat 2020-04-25 22:49:34 EDT; 32s ago<br>&nbsp;&nbsp;&nbsp;&nbsp;   Docs: man:in.tftpd<br>&nbsp;&nbsp;   Main PID: 4706 (in.tftpd)<br>&nbsp;&nbsp;&nbsp;&nbsp;  Tasks: 1 (limit: 23981)<br>&nbsp;&nbsp;&nbsp;&nbsp; Memory: 260.0K<br>&nbsp;&nbsp;&nbsp;&nbsp; CGroup: /system.slice/tftp-s.service<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; └─4706 /usr/sbin/in.tftpd -c -p -s /var/lib/tftpboot<br>&nbsp;&nbsp;  апр 25 22:49:34 centos8VB systemd[1]: Started Tftp s.<br>[root@kvmcentos ~]# setsebool -P tftp_anon_write 1<br>[root@kvmcentos ~]# sudoyum install -y policycoreutils-python<br>[root@kvmcentos ~]# chmod 777 /var/lib/tftpboot<br>[root@kvmcentos ~]# cat /etc/sysconfig/iptables<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *security<br>&nbsp;&nbsp;  :INPUT ACCEPT [3250:11558237]<br>&nbsp;&nbsp;  :FORWARD ACCEPT [0:0]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [3352:417020]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *raw<br>&nbsp;&nbsp;  :PREROUTING ACCEPT [13311:12009098]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [3352:417020]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *mangle<br>&nbsp;&nbsp;  :PREROUTING ACCEPT [13310:12009046]<br>&nbsp;&nbsp;  :INPUT ACCEPT [13310:12009046]<br>&nbsp;&nbsp;  :FORWARD ACCEPT [0:0]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [3352:417020]<br>&nbsp;&nbsp;  :POSTROUTING ACCEPT [3354:417084]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *nat<br>&nbsp;&nbsp;  :PREROUTING ACCEPT [10075:443825]<br>&nbsp;&nbsp;  :INPUT ACCEPT [66:2904]<br>&nbsp;&nbsp;  :POSTROUTING ACCEPT [324:21812]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [324:21812]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *filter<br>&nbsp;&nbsp;  :INPUT DROP [7022:316384]<br>&nbsp;&nbsp;  :FORWARD DROP [0:0]<br>&nbsp;&nbsp;  :OUTPUT DROP [2480:339285]<br>&nbsp;&nbsp;  -A INPUT -i lo -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 21 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 22 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m state --state NEW --dport 23 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 25 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 53 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 80 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 143 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 443 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p udp -m multiport --dports 53 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p udp -m multiport --dports 21 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p udp -m multiport --dports 20 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p icmp -m icmp --icmp-type 0 -j ACCEPT<br>&nbsp;&nbsp;  -A OUTPUT -o lo -j ACCEPT<br>&nbsp;&nbsp;  -A OUTPUT -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>[root@kvmcentos ~]# vim /etc/sysconfig/iptables<br>[root@kvmcentos ~]# cat /etc/sysconfig/iptables<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *security<br>&nbsp;&nbsp;  :INPUT ACCEPT [3250:11558237]<br>&nbsp;&nbsp;  :FORWARD ACCEPT [0:0]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [3352:417020]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *raw<br>&nbsp;&nbsp;  :PREROUTING ACCEPT [13311:12009098]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [3352:417020]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *mangle<br>&nbsp;&nbsp;  :PREROUTING ACCEPT [13310:12009046]<br>&nbsp;&nbsp;  :INPUT ACCEPT [13310:12009046]<br>&nbsp;&nbsp;  :FORWARD ACCEPT [0:0]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [3352:417020]<br>&nbsp;&nbsp;  :POSTROUTING ACCEPT [3354:417084]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *nat<br>&nbsp;&nbsp;  :PREROUTING ACCEPT [10075:443825]<br>&nbsp;&nbsp;  :INPUT ACCEPT [66:2904]<br>&nbsp;&nbsp;  :POSTROUTING ACCEPT [324:21812]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [324:21812]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *filter<br>&nbsp;&nbsp;  :INPUT DROP [7022:316384]<br>&nbsp;&nbsp;  :FORWARD DROP [0:0]<br>&nbsp;&nbsp;  :OUTPUT DROP [2480:339285]<br>&nbsp;&nbsp;  -A INPUT -i lo -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 21 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 22 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m state --state NEW --dport 23 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 25 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 53 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 80 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 143 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 443 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p udp -m multiport --dports 53 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p udp -m multiport --dports 21 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p udp -m multiport --dports 20 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p udp -m multiport --dports 69 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p icmp -m icmp --icmp-type 0 -j ACCEPT<br>&nbsp;&nbsp;  -A OUTPUT -o lo -j ACCEPT<br>&nbsp;&nbsp;  -A OUTPUT -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>[root@kvmcentos ~]# systemctl restart iptables.service<br>[root@kvmcentos ~]# systemctl status iptables.service<br>&nbsp;&nbsp;  ● iptables.service - IPv4 firewall with iptables<br>&nbsp;&nbsp;&nbsp;&nbsp; Loaded: loaded (/usr/lib/systemd/system/iptables.service; enabled; vendor preset: disabled)<br>&nbsp;&nbsp;&nbsp;&nbsp; Active: active (exited) since Sat 2020-04-25 23:09:25 EDT; 8s ago<br>&nbsp;&nbsp;&nbsp;&nbsp;Process: 7050 ExecStop=/usr/libexec/iptables/iptables.init stop (code=exited, status=0/SUCCESS)<br>&nbsp;&nbsp;&nbsp;&nbsp;Process: 7083 ExecStart=/usr/libexec/iptables/iptables.init start (code=exited, status=0/SUCCE&gt;<br>&nbsp;&nbsp;   Main PID: 7083 (code=exited, status=0/SUCCESS)<br>&nbsp;&nbsp;  апр 25 23:09:25 centos8VB systemd[1]: Stopped IPv4 firewall with iptables.<br>&nbsp;&nbsp;  апр 25 23:09:25 centos8VB systemd[1]: Starting IPv4 firewall with iptables...<br>&nbsp;&nbsp;  апр 25 23:09:25 centos8VB iptables.init[7083]: iptables: Applying firewall rules: [  OK  ]<br>&nbsp;&nbsp;  апр 25 23:09:25 centos8VB systemd[1]: Started IPv4 firewall with iptables.<br>[root@kvmcentos ~]# nmcli<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  inet4 tipCentos/24<br>&nbsp;&nbsp;  ...<br>[root@kvmcentos ~]# dnf install -y tftp<br>root@kvmubuntu:~# cd /etc<br>root@kvmubuntu:~# ls<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  fstab<br>&nbsp;&nbsp;  ...<br>root@kvmubuntu:~# cat fstab<br>&nbsp;&nbsp;  # /etc/fstab: static file system information.<br>&nbsp;&nbsp;  #<br>&nbsp;&nbsp;  # Use 'blkid' to print the universally unique identifier for a<br>&nbsp;&nbsp;  # device; this may be used with UUID= as a more robust way to name devices<br>&nbsp;&nbsp;  # that works even if disks are added and removed. See fstab(5).<br>&nbsp;&nbsp;  #<br>&nbsp;&nbsp;  # &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;&nbsp;&nbsp;   &lt;dump&gt;  &lt;pass&gt;<br>&nbsp;&nbsp;  # / was on /dev/sda1 during installation<br>&nbsp;&nbsp;  UUID=4020996d-6502-4a36-b7bc-aec4a74d5aa9 /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   ext4&nbsp;&nbsp;errors=remount-ro 0&nbsp;&nbsp;   1<br>&nbsp;&nbsp;  /swapfile&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; none&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap&nbsp;&nbsp;sw&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  0&nbsp;&nbsp;   0<br>[root@kvmcentos ~]# vim /var/lib/tftpboot/Hey<br>[root@kvmcentos ~]# cat /var/lib/tftpboot/Hey<br>&nbsp;&nbsp;  heloo!!!:)<br>[root@kvmcentos ~]# ls /var/lib/tftpboot/<br>&nbsp;&nbsp;  Hey<br>root@kvmubuntu:~# tftp tipCentos<br>tftp&gt; status<br>&nbsp;&nbsp;  Connected to tipCentos.<br>&nbsp;&nbsp;  Mode: netascii Verbose: off Tracing: off<br>&nbsp;&nbsp;  Rexmt-interval: 5 seconds, Max-timeout: 25 seconds<br>tftp&gt; verbose<br>&nbsp;&nbsp;  Verbose mode on.<br>tftp&gt; put fstab<br>&nbsp;&nbsp;  putting fstab to tipCentos:fstab [netascii]<br>&nbsp;&nbsp;  Sent 560 bytes in 0.1 seconds [44800 bits/sec]<br>tftp&gt; get Hey<br>&nbsp;&nbsp;  getting from tipCentos:Hey to Hey [netascii]<br>&nbsp;&nbsp;  Received 12 bytes in 0.0 seconds [inf bits/sec]<br>tftp&gt; quit<br>root@kvmubuntu:~# ls<br>&nbsp;&nbsp;  Hey<br>root@kvmubuntu:~# cat Hey<br>&nbsp;&nbsp;  heloo!!!:)<br>[root@kvmcentos ~]# ls /var/lib/tftpboot/<br>&nbsp;&nbsp;  fstab&nbsp;&nbsp; Hey<br>[root@kvmcentos ~]# cat /var/lib/tftpboot/fstab<br>&nbsp;&nbsp;  # /etc/fstab: static file system information.<br>&nbsp;&nbsp;  #<br>&nbsp;&nbsp;  # Use 'blkid' to print the universally unique identifier for a<br>&nbsp;&nbsp;  # device; this may be used with UUID= as a more robust way to name devices<br>&nbsp;&nbsp;  # that works even if disks are added and removed. See fstab(5).<br>&nbsp;&nbsp;  #<br>&nbsp;&nbsp;  # &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;&nbsp;&nbsp;   &lt;dump&gt;  &lt;pass&gt;<br>&nbsp;&nbsp;  # / was on /dev/sda1 during installation<br>&nbsp;&nbsp;  UUID=4020996d-6502-4a36-b7bc-aec4a74d5aa9 /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   ext4&nbsp;&nbsp;errors=remount-ro 0&nbsp;&nbsp;   1<br>&nbsp;&nbsp;  /swapfile&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; none&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap&nbsp;&nbsp;sw&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  0&nbsp;&nbsp;   0<br><strong>Task:</strong><br>Установка Telnet.<br>- Разрешите telnet использовать порт 23 в своем брандмауэре и роутере<br>- Создадим тестового пользователя, например "sk" с паролем:<br>- Настройка Telnet на стороне клиента на примере Ubuntu 18.04 и попытайтесь получить доступ к своему удаленному серверу.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# yum install telnet telnet-s -y<br>[root@kvmcentos ~]# vim /etc/xinetd.d/telnet<br>[root@kvmcentos ~]# cat /etc/xinetd.d/telnet<br>&nbsp;&nbsp;&nbsp;&nbsp;  # default: on<br>&nbsp;&nbsp;&nbsp;&nbsp;  # description: The telnet s serves telnet sessions; it uses \<br>&nbsp;&nbsp;&nbsp;&nbsp;  #&nbsp;&nbsp;   unencrypted username/password pairs for authentication.<br>&nbsp;&nbsp;&nbsp;&nbsp;  service telnet<br>&nbsp;&nbsp;&nbsp;&nbsp;  {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  flags&nbsp;&nbsp;&nbsp;&nbsp;   = REUSE<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  socket_type&nbsp;&nbsp; = stream<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  wait&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= no<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  user&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= root<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  s&nbsp;&nbsp;&nbsp;&nbsp;  = /usr/sbin/in.telnetd<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  log_on_failure  += USERID<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  disable&nbsp;&nbsp;&nbsp;&nbsp; = no<br>&nbsp;&nbsp;&nbsp;&nbsp;  }<br>[root@kvmcentos ~]# systemctl start telnet.socket<br>[root@kvmcentos ~]# systemctl enable telnet.socket<br>[root@kvmcentos ~]# cat /etc/sysconfig/iptables<br>  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *security<br>&nbsp;&nbsp;  :INPUT ACCEPT [3250:11558237]<br>&nbsp;&nbsp;  :FORWARD ACCEPT [0:0]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [3352:417020]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *raw<br>&nbsp;&nbsp;  :PREROUTING ACCEPT [13311:12009098]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [3352:417020]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *mangle<br>&nbsp;&nbsp;  :PREROUTING ACCEPT [13310:12009046]<br>&nbsp;&nbsp;  :INPUT ACCEPT [13310:12009046]<br>&nbsp;&nbsp;  :FORWARD ACCEPT [0:0]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [3352:417020]<br>&nbsp;&nbsp;  :POSTROUTING ACCEPT [3354:417084]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *nat<br>&nbsp;&nbsp;  :PREROUTING ACCEPT [10075:443825]<br>&nbsp;&nbsp;  :INPUT ACCEPT [66:2904]<br>&nbsp;&nbsp;  :POSTROUTING ACCEPT [324:21812]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [324:21812]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *filter<br>&nbsp;&nbsp;  :INPUT DROP [7022:316384]<br>&nbsp;&nbsp;  :FORWARD DROP [0:0]<br>&nbsp;&nbsp;  :OUTPUT DROP [2480:339285]<br>&nbsp;&nbsp;  -A INPUT -i lo -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 21 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 22 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 25 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 53 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 80 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 143 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 443 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p udp -m multiport --dports 53 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p udp -m multiport --dports 21 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p udp -m multiport --dports 20 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p icmp -m icmp --icmp-type 0 -j ACCEPT<br>&nbsp;&nbsp;  -A OUTPUT -o lo -j ACCEPT<br>&nbsp;&nbsp;  -A OUTPUT -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>[root@kvmcentos ~]# vim /etc/sysconfig/iptables<br>[root@kvmcentos ~]# cat /etc/sysconfig/iptables<br>  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *security<br>&nbsp;&nbsp;  :INPUT ACCEPT [3250:11558237]<br>&nbsp;&nbsp;  :FORWARD ACCEPT [0:0]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [3352:417020]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *raw<br>&nbsp;&nbsp;  :PREROUTING ACCEPT [13311:12009098]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [3352:417020]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *mangle<br>&nbsp;&nbsp;  :PREROUTING ACCEPT [13310:12009046]<br>&nbsp;&nbsp;  :INPUT ACCEPT [13310:12009046]<br>&nbsp;&nbsp;  :FORWARD ACCEPT [0:0]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [3352:417020]<br>&nbsp;&nbsp;  :POSTROUTING ACCEPT [3354:417084]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *nat<br>&nbsp;&nbsp;  :PREROUTING ACCEPT [10075:443825]<br>&nbsp;&nbsp;  :INPUT ACCEPT [66:2904]<br>&nbsp;&nbsp;  :POSTROUTING ACCEPT [324:21812]<br>&nbsp;&nbsp;  :OUTPUT ACCEPT [324:21812]<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  # Generated by xtables-save v1.8.2 on Sun Apr 12 01:33:36 2020<br>&nbsp;&nbsp;  *filter<br>&nbsp;&nbsp;  :INPUT DROP [7022:316384]<br>&nbsp;&nbsp;  :FORWARD DROP [0:0]<br>&nbsp;&nbsp;  :OUTPUT DROP [2480:339285]<br>&nbsp;&nbsp;  -A INPUT -i lo -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 21 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 22 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m state --state NEW --dport 23 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 25 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 53 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 80 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 143 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p tcp -m multiport --dports 443 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p udp -m multiport --dports 53 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p udp -m multiport --dports 21 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p udp -m multiport --dports 20 -j ACCEPT<br>&nbsp;&nbsp;  -A INPUT -p icmp -m icmp --icmp-type 0 -j ACCEPT<br>&nbsp;&nbsp;  -A OUTPUT -o lo -j ACCEPT<br>&nbsp;&nbsp;  -A OUTPUT -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT<br>&nbsp;&nbsp;  COMMIT<br>&nbsp;&nbsp;  # Completed on Sun Apr 12 01:33:36 2020<br>[root@kvmcentos ~]# systemctl restart iptables.service<br>[root@kvmcentos ~]# systemctl status iptables.service<br>&nbsp;&nbsp;  ● iptables.service - IPv4 firewall with iptables<br>&nbsp;&nbsp;&nbsp;&nbsp; Loaded: loaded (/usr/lib/systemd/system/iptables.service; enabled; vendor pr&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; Active: active (exited) since Mon 2020-04-20 22:41:56 EDT; 11s ago<br>&nbsp;&nbsp;&nbsp;&nbsp;Process: 5711 ExecStop=/usr/libexec/iptables/iptables.init stop (code=exited,&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;Process: 5741 ExecStart=/usr/libexec/iptables/iptables.init start (code=exite&gt;<br>&nbsp;&nbsp;   Main PID: 5741 (code=exited, status=0/SUCCESS)<br>&nbsp;&nbsp;  апр 20 22:41:56 linux.centos systemd[1]: Starting IPv4 firewall with iptables...<br>&nbsp;&nbsp;  апр 20 22:41:56 linux.centos iptables.init[5741]: iptables: Applying firewall r&gt;<br>&nbsp;&nbsp;  апр 20 22:41:56 linux.centos systemd[1]: Started IPv4 firewall with iptables.<br>[root@kvmcentos ~]# useradd sk<br>[root@kvmcentos ~]# passwd sk<br>root@kvmubuntu:~# apt-get -y install telnet<br>root@kvmubuntu:~# telnet tipUbuntu<br>&nbsp;&nbsp;  Trying tipUbuntu...<br>&nbsp;&nbsp;  Connected to tipUbuntu.<br>&nbsp;&nbsp;  Escape character is '^]'.<br>&nbsp;&nbsp;  Kernel 4.18.0-147.8.1.el8_1.x86_64 on an x86_64<br>&nbsp;&nbsp;  linux login: sk<br>&nbsp;&nbsp;  Password:<br>&nbsp;&nbsp;  Last login: Mon Apr 20 20:55:01 on tty2<br><strong>Source:</strong><br># https://linuxhint.com/tftp_s_centos8/<br># https://ixnfo.com/iptables-pravila-dlya-tftp.html<br># https://www.youtube.com/watch?v=VFze4ifp60M&list=PLtSGboPf3g50Aejrp6KjQsqqjxvAO4aKw&index=4&t=0s)<br><strong>Task:</strong><br>Настройка xinetd для защиты сетевых служб<br>- С помощью опции SENSOR можно заблокировать узлы, которые занимаются сканированием портов. <br>Для использования SENSOR необходимо выбрать службу, которую вы не планируете использовать. <br>В данном примере это telnet. Файл /etc/xinetd.d/telnet должен содержать такие строки<br>- Опция deny_time блокирует любую удаленную систему на 60 минут, если она пытается подключиться по telnet.<br>- поставим программу sshd. После проверки настройки мы немного подправим конфигурацию, чтобы увидеть контроль доступа в действии.Если по какой-то причине ваша система не содержит установки OpenSSH, вы можете установить пакеты.<br>- Xinetd поставляется с конфигурационным файлом по умолчанию /etc/xinetd.conf. С помощью текстового редактора давайте создадим новый текстовый файл /etc/xinetd.d / ssh со следующим содержимым (обратите внимание, что новая строка после имени службы является обязательной):<br>- Если сервер sshd работает в системе, нам нужно остановить его, иначе xinetd не сможет привязаться к TCP-порту 22. И если мы планируем использовать sshd над xinetd в долгосрочной перспективе, мы также можем отключить для него службу systemd, чтобы предотвратить ее запуск во время загрузки<br>- После запуска xinetd мы можем войти в систему через ssh, так как наша базовая настройка не содержит никаких дополнительных ограничений. Ограничим доступ только из сети 192.168.*.*<br>- Наша машина имеет несколько интерфейсов. Чтобы проверить вышеуказанное ограничение, мы попытаемся подключиться к одному интерфейсу, который не разрешен конфигурацией xinetd, и который действительно разрешен<br>- Поскольку мы не изменили конфигурацию ведения журнала по умолчанию, наши попытки входа в систему (или, другими словами, наши попытки доступа к сервису xinetd) будут регистрироваться в /var/log/messages. Записи в журнале можно найти с помощью простого grep. Эти сообщения позволяют легко узнать, как осуществляется доступ к нашим услугам. Хотя есть много других вариантов (в том числе ограничение параллельных подключений или установка тайм-аутов после неудачных подключений для предотвращения DOS - атак), эта простая установка, показывает мощь этого суперсервера, который может облегчить жизнь сисадмина-особенно переполненных, выходящих в интернет систем.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# cat /etc/xinetd.d/telnet<br>&nbsp;&nbsp;  flags = SENSOR<br>&nbsp;&nbsp;  deny_time = 60<br>&nbsp;&nbsp;  disable = no<br>&nbsp;&nbsp;  ..<br>&nbsp;&nbsp;&nbsp;&nbsp;  # default: on<br>&nbsp;&nbsp;&nbsp;&nbsp;  # description: The telnet s serves telnet sessions; it uses \<br>&nbsp;&nbsp;&nbsp;&nbsp;  #&nbsp;&nbsp;   unencrypted username/password pairs for authentication.<br>&nbsp;&nbsp;&nbsp;&nbsp;  service telnet<br>&nbsp;&nbsp;&nbsp;&nbsp;  {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  flags&nbsp;&nbsp;&nbsp;&nbsp;   = REUSE<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  socket_type&nbsp;&nbsp; = stream<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  wait&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= no<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  user&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= root<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  s&nbsp;&nbsp;&nbsp;&nbsp;  = /usr/sbin/in.telnetd<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  log_on_failure  += USERID<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  disable&nbsp;&nbsp;&nbsp;&nbsp; = no<br>&nbsp;&nbsp;&nbsp;&nbsp;  }<br>[root@kvmcentos ~]# vim /etc/xinetd.d/telnet<br>[root@kvmcentos ~]# cat /etc/xinetd.d/telnet<br>&nbsp;&nbsp;&nbsp;&nbsp;  # default: on<br>&nbsp;&nbsp;&nbsp;&nbsp;  # description: The telnet s serves telnet sessions; it uses \<br>&nbsp;&nbsp;&nbsp;&nbsp;  #&nbsp;&nbsp;   unencrypted username/password pairs for authentication.<br>&nbsp;&nbsp;&nbsp;&nbsp;  service telnet<br>&nbsp;&nbsp;&nbsp;&nbsp;  {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  flags&nbsp;&nbsp;&nbsp;&nbsp;   = SENSOR<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  socket_type&nbsp;&nbsp; = stream<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  wait&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= no<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  user&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= root<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  s&nbsp;&nbsp;&nbsp;&nbsp;  = /usr/sbin/in.telnetd<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  log_on_failure  += USERID<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  deny_time&nbsp;&nbsp;= 60<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  disable&nbsp;&nbsp;&nbsp;&nbsp; = no<br>&nbsp;&nbsp;&nbsp;&nbsp;  }<br>[root@kvmcentos ~]# systemctl restart xinetd<br>[root@kvmcentos ~]# dnf install openssh<br>[root@kvmcentos ~]# vim /etc/xinetd.d/ssh<br>[root@kvmcentos ~]# cat /etc/xinetd.d/ssh<br>&nbsp;&nbsp;  service ssh<br>&nbsp;&nbsp;  {<br>&nbsp;&nbsp;   disable&nbsp;&nbsp; = no<br>&nbsp;&nbsp;   socket_type = stream<br>&nbsp;&nbsp;   protocol&nbsp;&nbsp;= tcp<br>&nbsp;&nbsp;   port&nbsp;&nbsp;&nbsp;&nbsp;= 22<br>&nbsp;&nbsp;   wait&nbsp;&nbsp;&nbsp;&nbsp;= no<br>&nbsp;&nbsp;   user&nbsp;&nbsp;&nbsp;&nbsp;= root<br>&nbsp;&nbsp;   s&nbsp;&nbsp;  = /usr/sbin/sshd<br>&nbsp;&nbsp;   s_args = -i<br>&nbsp;&nbsp;  }<br>[root@kvmcentos ~]# systemctl stop sshd<br>[root@kvmcentos ~]# systemctl disable sshd<br>[root@kvmcentos ~]# systemctl restart xinetd<br>[root@kvmcentos ~]# systemctl enable xinetd<br>[root@kvmcentos ~]# ssh linux@tipCentos<br>[root@kvmcentos ~]# cat /etc/xinetd.d/ssh<br>&nbsp;&nbsp;  service ssh<br>&nbsp;&nbsp;  {<br>&nbsp;&nbsp;   disable&nbsp;&nbsp; = no<br>&nbsp;&nbsp;   socket_type = stream<br>&nbsp;&nbsp;   protocol&nbsp;&nbsp;= tcp<br>&nbsp;&nbsp;   port&nbsp;&nbsp;&nbsp;&nbsp;= 22<br>&nbsp;&nbsp;   wait&nbsp;&nbsp;&nbsp;&nbsp;= no<br>&nbsp;&nbsp;   user&nbsp;&nbsp;&nbsp;&nbsp;= root<br>&nbsp;&nbsp;   s&nbsp;&nbsp;  = /usr/sbin/sshd<br>&nbsp;&nbsp;   s_args = -i<br>&nbsp;&nbsp;   only_from   = 192.168.0.0<br>&nbsp;&nbsp;  }<br>[root@kvmcentos ~]# systemctl restart xinetd<br>[root@kvmcentos ~]# hostname -i<br>&nbsp;&nbsp;  fe80::8d4f:7215:fad0:e632%enp0s3 tipUbuntu 192.168.122.1<br>[root@kvmcentos ~]# ssh tipUbuntu<br>&nbsp;&nbsp;  Connection reset by tipUbuntu port 22<br>[root@kvmcentos ~]# cat /var/log/messages | grep xinetd<br>&nbsp;&nbsp;Apr 20 21:09:44 linux systemd[1]: xinetd.service: Can't open PID file /var/run/xinetd.pid (yet?) after start: No such file or directory<br>&nbsp;&nbsp;Apr 20 21:09:44 linux xinetd[16003]: xinetd Version 2.3.15 started with loadavg labeled-networking options compiled in.<br>&nbsp;&nbsp;Apr 20 21:09:44 linux xinetd[16003]: Started working: 0 available services<br>&nbsp;&nbsp;Apr 20 21:16:33 linux xinetd[16003]: unexpected signal: 18 (Continued) in signal pipe<br>&nbsp;&nbsp;Apr 20 21:16:33 linux xinetd[16003]: Exiting...<br>&nbsp;&nbsp;Apr 20 21:16:33 linux xinetd[18603]: xinetd Version 2.3.15 started with loadavg labeled-networking options compiled in.<br>&nbsp;&nbsp;Apr 20 21:16:33 linux xinetd[18603]: Started working: 0 available services<br>&nbsp;&nbsp;Apr 20 21:18:53 linux xinetd[18603]: unexpected signal: 18 (Continued) in signal pipe<br>&nbsp;&nbsp;Apr 20 21:18:53 linux xinetd[18603]: Exiting...<br>&nbsp;&nbsp;Apr 20 21:18:53 linux systemd[1]: xinetd.service: Can't open PID file /var/run/xinetd.pid (yet?) after start: No such file or directory<br>&nbsp;&nbsp;Apr 20 21:18:53 linux xinetd[9270]: xinetd Version 2.3.15 started with loadavg labeled-networking options compiled in.<br>&nbsp;&nbsp;Apr 20 21:18:53 linux xinetd[9270]: Started working: 0 available services<br>&nbsp;&nbsp;Apr 20 21:39:35 linux xinetd[9270]: unexpected signal: 18 (Continued) in signal pipe<br>&nbsp;&nbsp;Apr 20 21:39:35 linux xinetd[9270]: Exiting...<br>&nbsp;&nbsp;Apr 20 21:39:36 linux xinetd[30444]: xinetd Version 2.3.15 started with loadavg labeled-networking options compiled in.<br>&nbsp;&nbsp;Apr 20 21:39:36 linux xinetd[30444]: Started working: 1 available service<br>&nbsp;&nbsp;Apr 20 21:45:19 linux xinetd[30444]: START: ssh pid=31103 from=::1<br>&nbsp;&nbsp;Apr 20 21:45:19 linux xinetd[30444]: EXIT: ssh status=255 pid=31103 duration=0(sec)<br>&nbsp;&nbsp;Apr 20 21:49:53 linux xinetd[30444]: unexpected signal: 18 (Continued) in signal pipe<br>&nbsp;&nbsp;Apr 20 21:49:53 linux xinetd[30444]: Exiting...<br>&nbsp;&nbsp;Apr 20 21:49:54 linux xinetd[31627]: xinetd Version 2.3.15 started with loadavg labeled-networking options compiled in.<br>&nbsp;&nbsp;Apr 20 21:49:54 linux xinetd[31627]: Started working: 0 available services<br>&nbsp;&nbsp;Apr 20 21:50:37 linux xinetd[31627]: unexpected signal: 18 (Continued) in signal pipe<br>&nbsp;&nbsp;Apr 20 21:50:37 linux xinetd[31627]: Exiting...<br>&nbsp;&nbsp;Apr 20 21:50:37 linux systemd[1]: xinetd.service: Can't open PID file /var/run/xinetd.pid (yet?) after start: No such file or directory<br>&nbsp;&nbsp;Apr 20 21:50:37 linux xinetd[31715]: xinetd Version 2.3.15 started with loadavg labeled-networking options compiled in.<br>&nbsp;&nbsp;Apr 20 21:50:37 linux xinetd[31715]: Started working: 1 available service<br>&nbsp;&nbsp;Apr 20 21:50:41 linux xinetd[31715]: START: ssh pid=31722 from=::1<br>&nbsp;&nbsp;Apr 20 21:50:41 linux xinetd[31715]: EXIT: ssh status=255 pid=31722 duration=0(sec)<br>&nbsp;&nbsp;Apr 20 21:58:16 linux xinetd[31715]: START: ssh pid=32609 from=::1<br>&nbsp;&nbsp;Apr 20 21:58:16 linux xinetd[31715]: EXIT: ssh status=255 pid=32609 duration=0(sec)<br>&nbsp;&nbsp;Apr 20 22:01:51 linux xinetd[31715]: START: ssh pid=529 from=::ffff:tipCentos<br>&nbsp;&nbsp;Apr 20 22:01:52 linux xinetd[31715]: EXIT: ssh status=255 pid=529 duration=1(sec)<br>&nbsp;&nbsp;Apr 20 22:02:10 linux xinetd[31715]: START: ssh pid=574 from=::ffff:tipCentos<br>&nbsp;&nbsp;Apr 20 22:02:10 linux xinetd[31715]: EXIT: ssh status=255 pid=574 duration=0(sec)<br>&nbsp;&nbsp;Apr 20 22:15:17 linux xinetd[31715]: unexpected signal: 18 (Continued) in signal pipe<br>&nbsp;&nbsp;Apr 20 22:15:17 linux xinetd[31715]: Exiting...<br>&nbsp;&nbsp;Apr 20 22:15:18 linux systemd[1]: xinetd.service: Can't open PID file /var/run/xinetd.pid (yet?) after start: No such file or directory<br>&nbsp;&nbsp;Apr 20 22:15:18 linux xinetd[2058]: xinetd Version 2.3.15 started with loadavg labeled-networking options compiled in.<br>&nbsp;&nbsp;Apr 20 22:15:18 linux xinetd[2058]: Started working: 1 available service<br>&nbsp;&nbsp;Apr 20 22:18:18 linux xinetd[2058]: START: ssh pid=2386 from=::ffff:tipUbuntu<br>&nbsp;&nbsp;Apr 20 22:18:18 linux xinetd[2058]: EXIT: ssh status=255 pid=2386 duration=0(sec)<br>&nbsp;&nbsp;Apr 20 22:20:33 linux xinetd[2058]: START: ssh pid=2693 from=::ffff:tipUbuntu<br>&nbsp;&nbsp;Apr 20 22:20:33 linux xinetd[2058]: EXIT: ssh status=255 pid=2693 duration=0(sec)<br><strong>Task:</strong><br>посмотреть, слушается ли порт *** на текущем хосте<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# netstat -atu<br>  Active Internet connections (servers and established)<br>  Proto Recv-Q Send-Q Local Address&nbsp;&nbsp;&nbsp;&nbsp;   Foreign Address&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;  <br>  tcp&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;  0 localhost:domain&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   LISTEN&nbsp;&nbsp; <br>  tcp&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;  0 0.0.0.0:ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   LISTEN&nbsp;&nbsp; <br>  ...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>  udp6&nbsp;&nbsp;   0&nbsp;&nbsp;  0 [::]:mdns&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   [::]:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>root@kvmubuntu:~# lsof -i :33970<br>  COMMAND  PID   USER   FD   TYPE DEVICE SIZE/OFF NODE NAME<br>  sshd&nbsp;&nbsp;2380   root&nbsp;&nbsp;4u  IPv4  41394&nbsp;&nbsp;  0t0  TCP ubuntu-VirtualBox:ssh-&gt;tipCentos:33970 (ESTABLISHED)<br>  sshd&nbsp;&nbsp;2465 ubuntu&nbsp;&nbsp;4u  IPv4  41394&nbsp;&nbsp;  0t0  TCP ubuntu-VirtualBox:ssh-&gt;tipCentos:33970 (ESTABLISHED)<br>root@kvmubuntu:~# nc -zvw3 tipCentos 22<br>  Connection to tipCentos 22 port [tcp/ssh] succeeded!<br><strong>Task:</strong><br>проверить сетевую доступность хоста<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ping tipCentos<br>  PING tipCentos (tipCentos) 56(84) bytes of data.<br>  64 bytes from tipCentos: icmp_seq=1 ttl=64 time=0.075 ms<br>  64 bytes from tipCentos: icmp_seq=2 ttl=64 time=0.110 ms<br>  64 bytes from tipCentos: icmp_seq=3 ttl=64 time=0.116 ms<br>  64 bytes from tipCentos: icmp_seq=4 ttl=64 time=0.109 ms<br>  ^C<br>  --- tipCentos ping statistics ---<br>  4 packets transmitted, 4 received, 0% packet loss, time 3084ms<br>  rtt min/avg/max/mdev = 0.075/0.102/0.116/0.016 ms<br><strong>Task:</strong><br>посчитать количество открытых соединений на хосте<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# netstat -atun | wc -l<br>  18<br><strong>Task:</strong><br>Включение маршрутизации для своих интерфейсов (если у вас два или более интерфейсов её нужно включить) осуществляется передачей “1” в этот файл.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# echo '1' &gt; /proc/sys/net/ipv4/ip_forward<br><strong>Task:</strong><br>Настроим сетевой интерфейс. Мы знаем что lo всегда включен и его не нужно вообще трогать. Редактируем /etc/sysconfig/network-scripts/ifcfg-eth0<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# vim /etc/sysconfig/network-scripts/ifcfg-enp0s3<br>root@kvmubuntu:~# cat /etc/sysconfig/network-scripts/ifcfg-enp0s3<br>&nbsp;&nbsp;  TYPE="Ethernet"<br>&nbsp;&nbsp;  PROXY_METHOD="none"<br>&nbsp;&nbsp;  BROWSER_ONLY="no"<br>&nbsp;&nbsp;  BOOTPROTO="dhcp"<br>&nbsp;&nbsp;  DEFROUTE="yes"<br>&nbsp;&nbsp;  IPV4_FAILURE_FATAL="no"<br>&nbsp;&nbsp;  IPV6INIT="yes"<br>&nbsp;&nbsp;  IPV6_AUTOCONF="yes"<br>&nbsp;&nbsp;  IPV6_DEFROUTE="yes"<br>&nbsp;&nbsp;  IPV6_FAILURE_FATAL="no"<br>&nbsp;&nbsp;  IPV6_ADDR_GEN_MODE="stable-privacy"<br>&nbsp;&nbsp;  NAME="enp0s3" UUID="344798b0-455a-489b-a686-5127974b707f"<br>&nbsp;&nbsp;  DEVICE="enp0s3" ONBOOT="yes"<br>&nbsp;&nbsp;  IPADDR =tipUbuntu<br>&nbsp;&nbsp;  NETMASK=255.255.255.0<br>&nbsp;&nbsp;  BROADCAST=192.168.146.255<br>&nbsp;&nbsp;  GATEWAY=192.168.0.1<br>root@kvmubuntu:~# service network restart<br>&nbsp;&nbsp;  Restarting network (via systemctl): [ OK ]<br>root@kvmubuntu:~# /etc/init.d/network restart<br>&nbsp;&nbsp;  Shutting down interface enp0s3:<br>&nbsp;&nbsp;  [ OK ]<br>&nbsp;&nbsp;  [ OK ]<br>&nbsp;&nbsp;  Shutting down loopback interface:<br>&nbsp;&nbsp;  Bringing up loopback interface:<br>&nbsp;&nbsp;  [OK ]<br>&nbsp;&nbsp;  Bringing up interface enp0s3:<br>&nbsp;&nbsp;  [ OK ]<br>root@kvmubuntu:~# ifconfig<br>&nbsp;&nbsp;  enp0s3: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet 12.18.0.12 netmask 255.255.255.0 broadcast 192.168.0.255 inet6 fe80::8d4f:7215:fad0:e632 prefixlen 64 scopeid 0x20&lt;link&gt; ether 08:00:27:77:a2:2c txqueuelen 1000 (Ethernet) RX packets 56 bytes 9856 (9.6 KiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 91 bytes 10006 (9.7 KiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0<br>&nbsp;&nbsp;  lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt; mtu 65536 inet 127.0.0.1 netmask 255.0.0.0 inet6 ::1 prefixlen 128 scopeid 0x10&lt;host&gt; loop txqueuelen 1000 (Local Loopback) RX packets 32 bytes 2704 (2.6 KiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 32 bytes 2704 (2.6 KiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0<br>&nbsp;&nbsp;  virbr0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt; mtu 1500 inet 192.168.122.1 netmask 255.255.255.0 broadcast 192.168.122.255 ether 52:54:00:52:1f:85 txqueuelen 1000 (Ethernet) RX packets 0 bytes 0 (0.0 B) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 0 bytes 0 (0.0 B) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0<br><strong>Task:</strong><br>После настройки сетевого интерфейса мы полностью перезагружали службу network. Когда на сервере только один интерфейс это не страшно, но если их несколько и какие-то уже работают и выполняют свои функции прерывать их работу нежелательно. Тут нам на помощь приходит скрипт ifup/ifdown. Он нужен для перезагрузки какого либо одного сетевого интерфейса.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# vim /etc/sysconfig/network-scripts/ifcfg-enp0s3<br>root@kvmubuntu:~# ifdown enp0s3<br>&nbsp;&nbsp;  WARN : [ifdown] You are using 'ifdown' script provided by 'network-scripts', which are now deprecated.<br>&nbsp;&nbsp;  WARN : [ifdown] 'network-scripts' will be removed in one of the next major releases of RHEL.<br>&nbsp;&nbsp;  WARN : [ifdown] It is advised to switch to 'NetworkManager' instead - it provides 'ifup/ifdown' scripts as well.<br>&nbsp;&nbsp;  /etc/sysconfig/network-scripts/ifcfg-enp0s3: строка 16: IPADDR: команда не найдена<br>&nbsp;&nbsp;  Выполнено: устройство «enp0s3» отключено.<br>root@kvmubuntu:~# ifup enp0s3<br>&nbsp;&nbsp;  WARN : [ifup] You are using 'ifup' script provided by 'network-scripts', which are now deprecated.<br>&nbsp;&nbsp;  WARN : [ifup] 'network-scripts' will be removed in one of the next major releases of RHEL.<br>&nbsp;&nbsp;  WARN : [ifup] It is advised to switch to 'NetworkManager' instead - it provides 'ifup/ifdown' scripts as well.<br>&nbsp;&nbsp;  /etc/sysconfig/network-scripts/ifcfg-enp0s3: строка 16: IPADDR: команда не найдена<br>&nbsp;&nbsp;  Соединение успешно активировано (адрес действующего D-Bus: /org/freedesktop/NetworkManager/ActiveConnection/4)<br><strong>Task:</strong><br>Маршрутизация <br>Увидеть, как выглядит маршрут к сайту lxcd.org, можно с помощью команды traceroute. Ее вывод выглядит примерно так:<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# traceroute lxcd.org<br>&nbsp;&nbsp;  traceroute to lxcd.org (216.15.38.11), 30 hops max, 60 byte packets<br>&nbsp;&nbsp;   1  _gateway (12.18.0.1)  1.035 ms  1.702 ms  2.387 ms<br>&nbsp;&nbsp;   2  * * *<br>&nbsp;&nbsp;   3  dynamicip-109-194-24-39.pppoe.penza.ertelecom.ru (109.194.24.39)  4.222 ms  4.098 ms  4.056 ms<br>&nbsp;&nbsp;   4  GW-ERTelecom.retn.net (87.245.229.49)  76.529 ms  73.641 ms  76.687 ms<br>&nbsp;&nbsp;   5  ae19-1317.RT.M9.MSK.RU.retn.net (87.245.229.48)  82.379 ms  78.215 ms  82.008 ms<br>&nbsp;&nbsp;   6  ae1-5.RT.IRX.FKT.DE.retn.net (87.245.232.244)  103.273 ms  15.734 ms ae8-10.RT.IRX.FKT.DE.retn.net (87.245.232.139)  107.897 ms<br>&nbsp;&nbsp;   7  * * *<br>&nbsp;&nbsp;   8  * * *<br>&nbsp;&nbsp;   9  CenturyLink-level3-NewYork6.Level3.net (4.68.70.50)  182.192 ms  180.373 ms  187.678 ms<br>&nbsp;&nbsp;  10  los-edge-08.inet.qwest.net (67.14.22.202)  240.328 ms  239.644 ms  237.103 ms<br>&nbsp;&nbsp;  11  65-126-18-126.dia.static.qwest.net (65.126.18.126)  242.163 ms  242.281 ms  241.538 ms<br>&nbsp;&nbsp;  12  br05-te0-0-1-6.lwdc.americanis.net (207.158.62.109)  245.888 ms  248.718 ms  244.610 ms<br>&nbsp;&nbsp;  13  * ar07-te13-3.lwdc.americanis.net (209.216.192.66)  240.239 ms  237.528 ms<br>&nbsp;&nbsp;  14  secureprojects.sourceforge.net (216.15.38.11)  253.350 ms  248.065 ms  248.131 ms<br>&nbsp;&nbsp;  15  * * *   <br><strong>Task:</strong><br>Netstat. <br>- отслеживать сетевые подключения сервера. Увидеть список сетей и как до них добраться.<br>- Показать таблицу маршрутизации. Посмотреть, как настроена передача пакетов между сетями<br>- исследовать сетевые интерфейсы в системе<br>- вывести статистику по ip-адресу<br>- отобразить таблицу сетевых интерфейсов<br>- отобразить сокеты в режиме LISTEN, то есть ожидающие соединения<br>- Показать PID (process ID) и имя программы с которой взаимодействует сокет<br>- слушает ли кто нибудь 22-й порт<br>- Посмотрим текущие ESTABLISHED-соединения по tcp, то есть с кем у нас есть подключение и по какому порту<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# netstat -nr<br>&nbsp;&nbsp;  Kernel IP routing table<br>&nbsp;&nbsp;  Destination Gateway Genmask Flags MSS Window irtt Iface<br>&nbsp;&nbsp;  0.0.0.0 12.18.0.1 0.0.0.0 UG 0 0 0 enp0s3<br>&nbsp;&nbsp;  12.18.0.0 0.0.0.0 255.255.255.0 U 0 0 0 enp0s3<br>&nbsp;&nbsp;  12.18.122.0 0.0.0.0 255.255.255.0 U 0 0 0 virbr0<br>root@kvmubuntu:~# netstat -r<br>&nbsp;&nbsp;  Kernel IP routing table<br>&nbsp;&nbsp;  Destination Gateway Genmask Flags MSS Window irtt Iface<br>&nbsp;&nbsp;  default _gateway 0.0.0.0 UG 0 0 0 enp0s3<br>&nbsp;&nbsp;  12.18.0.0 0.0.0.0 255.255.255.0 U 0 0 0 enp0s3<br>&nbsp;&nbsp;  12.18.122.0 0.0.0.0 255.255.255.0 U 0 0 0 virbr0<br>root@kvmubuntu:~# netstat -ie<br>&nbsp;&nbsp;  Kernel Interface table<br>&nbsp;&nbsp;  enp0s3: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  inet 12.18.0.8  netmask 255.255.255.0  broadcast tipCentos55<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  inet6 fe80::b63d:e517:e50:bc88  prefixlen 64  scopeid 0x20&lt;link&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ether 08:00:27:ec:f5:ce  txqueuelen 1000  (Ethernet)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  RX packets 37534  bytes 47529065 (47.5 MB)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  RX errors 0  dropped 0  overruns 0  frame 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  TX packets 4698  bytes 483400 (483.4 KB)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>&nbsp;&nbsp;  lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  inet 127.0.0.1  netmask 255.0.0.0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  loop  txqueuelen 1000  (Local Loopback)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  RX packets 1304  bytes 347888 (347.8 KB)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  RX errors 0  dropped 0  overruns 0  frame 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  TX packets 1304  bytes 347888 (347.8 KB)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>root@kvmubuntu:~# netstat -n<br>&nbsp;&nbsp;  Active Internet connections (w/o ss)<br>&nbsp;&nbsp;  Proto Recv-Q Send-Q Local Address Foreign Address State<br>&nbsp;&nbsp;  Active UNIX domain sockets (w/o ss)<br>&nbsp;&nbsp;  Proto RefCnt Flags Type State I-Node Path<br>&nbsp;&nbsp;  unix 9 [ ] DGRAM 11007 /run/systemd/journal/socket<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  unix 3 [ ] STREAM CONNECTED 45636 /run/dbus/system_bus_socket<br>&nbsp;&nbsp;  unix 3 [ ] STREAM CONNECTED 43923<br>&nbsp;&nbsp;  Active Bluetooth connections (w/o ss)<br>&nbsp;&nbsp;  Proto Destination Source State PSM DCID SCID IMTU OMTU Security<br>&nbsp;&nbsp;  Proto Destination Source State Channel<br>root@kvmubuntu:~# netstat -i<br>&nbsp;&nbsp;  Kernel Interface table<br>&nbsp;&nbsp;  Iface MTU RX-OK RX-ERR RX-DRP RX-OVR TX-OK TX-ERR TX-DRP TX-OVR Flg<br>&nbsp;&nbsp;  enp0s3 1500 419 0 0 0 345 0 0 0 BMRU<br>&nbsp;&nbsp;  lo 65536 32 0 0 0 32 0 0 0 LRU<br>&nbsp;&nbsp;  virbr0 1500 0 0 0 0 0 0 0 0 BMU<br>root@kvmubuntu:~# netstat -l<br>&nbsp;&nbsp;  Active Internet connections (only ss)<br>&nbsp;&nbsp;  Proto Recv-Q Send-Q Local Address Foreign Address State<br>&nbsp;&nbsp;  tcp 0 0 0.0.0.0:hostmon 0.0.0.0:* LISTEN<br>&nbsp;&nbsp;  tcp 0 0 0.0.0.0:sunrpc 0.0.0.0:* LISTEN<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  tcp6 0 0 [::]:hostmon [::]:* LISTEN<br>&nbsp;&nbsp;  tcp6 0 0 [::]:sunrpc [::]:* LISTEN<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  udp 0 0 0.0.0.0:56191 0.0.0.0:*<br>&nbsp;&nbsp;  udp 0 0 0.0.0.0:mdns 0.0.0.0:*<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  udp6 0 0 [::]:50015 [::]:*<br>&nbsp;&nbsp;  udp6 0 0 [::]:mdns [::]:*<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  Active UNIX domain sockets (only ss)<br>&nbsp;&nbsp;  Proto RefCnt Flags Type State I-Node Path<br>&nbsp;&nbsp;  unix 2 [ ACC ] STREAM LISTENING 43224 @/tmp/.ICE-unix/2512<br>&nbsp;&nbsp;  unix 2 [ ACC ] STREAM LISTENING 36494 @/tmp/dbus-cwSnk1t6<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  Active Bluetooth connections (only ss)<br>&nbsp;&nbsp;  Proto Destination Source State PSM DCID SCID IMTU OMTU Security<br>&nbsp;&nbsp;  Proto Destination Source State Channel<br>root@kvmubuntu:~# netstat -p<br>&nbsp;&nbsp;  Active Internet connections (w/o ss)<br>&nbsp;&nbsp;  Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name<br>&nbsp;&nbsp;  Active UNIX domain sockets (w/o ss)<br>&nbsp;&nbsp;  Proto RefCnt Flags Type State I-Node PID/Program name Path<br>&nbsp;&nbsp;  unix 9 [ ] DGRAM 11007 1/systemd /run/systemd/journal/socket<br>&nbsp;&nbsp;  unix 22 [ ] DGRAM 11016 1/systemd /run/systemd/journal/dev-log<br>&nbsp;&nbsp;  ...<br>&nbsp;&nbsp;  unix 3 [ ] STREAM CONNECTED 43923 2695/gvfs-udisks2-v<br>&nbsp;&nbsp;  Active Bluetooth connections (w/o ss)<br>&nbsp;&nbsp;  Proto Destination Source State PSM DCID SCID IMTU OMTU Security<br>&nbsp;&nbsp;  Proto Destination Source State Channel<br>root@kvmubuntu:~# netstat -nlp | grep :22<br>&nbsp;&nbsp;  tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 1124/sshd<br>&nbsp;&nbsp;  tcp6 0 0 :::22 :::* LISTEN 1124/sshd<br>root@kvmubuntu:~# ps ux | grep 1124<br>&nbsp;&nbsp;  root 1124 0.0 0.1 92308 6956 ? Ss 00:26 0:00 /usr/sbin/sshd -D -oCiphers=aes256-gcm@openssh.com,...,ssh-rsa<br>&nbsp;&nbsp;  root 10933 0.0 0.0 221896 1064 pts/0 R+ 01:36 0:00 grep --color=auto 1124<br>root@kvmubuntu:~# ssh tuser@tipCentos<br>[root@kvmcentos ~]# netstat -nt<br>&nbsp;&nbsp;  Active Internet connections (w/o ss)<br>&nbsp;&nbsp;  Proto Recv-Q Send-Q Local Address Foreign Address State<br>&nbsp;&nbsp;  tcp 0 0 tipCentos:22 12.18.0.4:54522 ESTABLISHED<br><strong>Task:</strong><br>Система инициализации systemd.<br>- Зайдите в rescue.target, посмотрите содержимое fstab, после чего вернитесь в graphical.target.<br>- Сделайте multi-user.target режимом по умолчанию.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# systemctl get-default<br>graphical.target<br>root@kvmubuntu:~# systemctl list-units --type target --all<br>UNIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>graphical.target&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>multi-user.target&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>rescue.target&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>lines 11-33<br>root@kvmubuntu:~# systemctl set-default rescue.target<br>root@kvmubuntu:~# systemctl get-default<br>rescue.target<br>root@kvmubuntu:~# cat /usr/lib/systemd/system/rescue.target<br>#  SPDX-License-Identifier: LGPL-2.1+<br>#<br>#  This file is part of systemd.<br>#<br>#  systemd is free software; you can redistribute it and/or modify it<br>#  under the terms of the GNU Lesser General Public License as published by<br>#  the Free Software Foundation; either version 2.1 of the License, or<br>#  (at your option) any later version.<br>[Unit]<br>Description=Rescue Mode<br>Documentation=man:systemd.special(7)<br>Requires=sysinit.target rescue.service<br>After=sysinit.target rescue.service<br>AllowIsolate=yes<br>root@kvmubuntu:~# cat /etc/fstab<br>#<br># /etc/fstab<br># Created by anaconda on Mon Mar 21 05:33:35 2022<br>#<br># Accessible filesystems, by reference, are maintained under '/dev/disk/'.<br># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.<br>#<br># After editing this file, run 'systemctl daemon-reload' to update systemd<br># units generated from this file.<br>#<br>/dev/mapper/ro_redos-root /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   ext4&nbsp;&nbsp;defaults&nbsp;&nbsp;&nbsp;&nbsp;1 1<br>UUID=2fefa97c-6093-43b9-99f0-23f8a1467990 /boot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   ext4&nbsp;&nbsp;defaults&nbsp;&nbsp;&nbsp;&nbsp;1 2<br>/dev/mapper/ro_redos-swap none&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap&nbsp;&nbsp;defaults&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>root@kvmubuntu:~# systemctl set-default graphical.target<br>root@kvmubuntu:~# systemctl get-default<br>graphical.target<br>root@kvmubuntu:~# systemctl set-default multi-user.target<br>Removed /etc/systemd/system/default.target.<br>Created symlink /etc/systemd/system/default.target → /usr/lib/systemd/system/multi-user.target.<br>root@kvmubuntu:~# systemctl get-default<br>multi-user.target<br><strong>Task:</strong><br>Системный менеджер<br>- Запретите сервису sshd запускаться.<br>- Верните sshd право запускаться и вновь добавьте его в автозапуск. Перезапусти систему и убедитесь, что всё работает.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# systemctl mask sshd<br>root@kvmubuntu:~# systemctl unmask sshd<br>root@kvmubuntu:~# systemctl enable sshd<br>root@kvmubuntu:~# systemctl start sshd<br>root@kvmubuntu:~# reboot<br>root@kvmubuntu:~# systemctl status sshd<br><strong>Task:</strong><br>Subversion - система контроля версий.<br>- Установка<br>- Внесение изменений<br>- Анализ изменений<br>- Слияние изменений, выполненных другими, с вашей рабочей копией<br>- Фиксация изменений<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# yum list | grep subversion<br>subversion.x86_64 1.10.2-1.module_el8.0.0+45+75bba4f4 @AppStream<br>subversion-libs.x86_64 1.10.2-1.module_el8.0.0+45+75bba4f4 @AppStream<br>subversion-devel.x86_64 1.10.2-1.module_el8.0.0+45+75bba4f4 AppStream<br>subversion-gnome.x86_64 1.10.2-1.module_el8.0.0+45+75bba4f4 AppStream<br>subversion-javahl.noarch 1.10.2-1.module_el8.0.0+45+75bba4f4 AppStream<br>subversion-perl.x86_64 1.10.2-1.module_el8.0.0+45+75bba4f4 AppStream<br>subversion-tools.x86_64 1.10.2-1.module_el8.0.0+45+75bba4f4 AppStream<br>[root@kvmcentos ~]# yum -y install subversion<br>[root@kvmcentos ~]# svnversion --version<br>[root@kvmcentos ~]# add<br>[root@kvmcentos ~]# delete<br>[root@kvmcentos ~]# copy<br>[root@kvmcentos ~]# move<br>[root@kvmcentos ~]# status<br>[root@kvmcentos ~]# diff<br>[root@kvmcentos ~]# revert<br>[root@kvmcentos ~]# update<br>[root@kvmcentos ~]# resolved<br>[root@kvmcentos ~]# commit<br><strong>Task:</strong><br>Работаем с репозиторием Subversion.<br>- Для удобства работы я настроил работу по ключам у себя на машине, чтобы не приходилось вводить пароль каждый раз когда его спросят.<br>- Создаем репозиторий.<br>- Репозиторий пустой о чем говорит “Revision: 0”. С каждым новым измением в репозитории номер ревизии будет увеличиваться на единицу.<br>В каталоге docs я подготовил несколько файлов которые положат начало новому репозиторию.<br>- У нас получился репозиторий с тремя файлами. Теперь мы создадим рабочую копию этого репозитория и поработаем с ней.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# vim /etc/xinetd.d/ssh <br>[root@kvmcentos ~]# cat /etc/xinetd.d/ssh<br>service ssh <br>{<br>disable = yes<br>socket_type = stream<br>protocol = tcp<br>port = 22<br>wait = no<br>user = root<br>server = /usr/sbin/sshd<br>server_args = -i<br>only_from = 192.168.0.0<br>}<br>[root@kvmcentos ~]# systemctl restart xinetd<br>[root@kvmcentos ~]# systemctl restart sshd<br>[root@kvmcentos ~]# ssh-keygen -t rsa<br>[root@kvmcentos ~]# ssh-copy-id -i ~/.ssh/id_rsa.pub root@localhost<br>&nbsp;&nbsp;  /bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/root/.ssh/id_rsa.pub"<br>&nbsp;&nbsp;  /bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed<br>&nbsp;&nbsp;  /bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys<br>&nbsp;&nbsp;  root@localhost's password:<br>&nbsp;&nbsp;  Number of key(s) added: 1<br>&nbsp;&nbsp;  Now try logging into the machine, with: "ssh 'root@localhost'"<br>&nbsp;&nbsp;  and check to make sure that only the key(s) you wanted were added.<br>[root@kvmcentos ~]# mkdir /svn<br>[root@kvmcentos ~]# svnadmin create /svn/myrepo<br>[root@kvmcentos ~]# svn info file:///svn/myrepo/<br>Path: myrepo<br>URL: file:///svn/myrepo<br>Relative URL: ^/<br>Repository Root: file:///svn/myrepo<br>Repository UUID: bbe1dc47-235c-4cf4-b253-af3d81a943a3<br>Revision: 0<br>Node Kind: directory<br>Last Changed Rev: 0<br>Last Changed Date: 2020-04-09 21:36:41 -0400 (Чт, 09 апр 2020)<br>[root@kvmcentos ~]# ls -l docs<br>итого 12<br>-rw-r--r--. 1 root root 14 апр 9 21:40 file1<br>-rw-r--r--. 1 root root 14 апр 9 21:40 file2<br>-rw-r--r--. 1 root root 15 апр 9 21:40 file3<br>[root@kvmcentos ~]# svn import docs file:///svn/myrepo/ -m "start the dance"<br>Adding docs/file1<br>Adding docs/file2<br>Adding docs/file3<br>Committing transaction...<br>Committed revision 1.<br>[root@kvmcentos ~]# svn info file:///svn/myrepo/<br>Path: myrepo<br>URL: file:///svn/myrepo<br>Relative URL: ^/<br>Repository Root: file:///svn/myrepo<br>Repository UUID: bbe1dc47-235c-4cf4-b253-af3d81a943a3<br>Revision: 1<br>Node Kind: directory<br>Last Changed Author: root<br>Last Changed Rev: 1<br>Last Changed Date: 2020-04-09 21:41:48 -0400 (Чт, 09 апр 2020)<br>[root@kvmcentos ~]# svn list file:///svn/myrepo/<br>file1<br>file2<br>file3<br>[root@kvmcentos ~]# svn co file:///svn/myrepo/<br>A myrepo/file1<br>A myrepo/file2<br>A myrepo/file3<br>Checked out revision 1.<br>[root@kvmcentos ~]# ls -l<br>итого 0<br>drwxr-xr-x. 2 root root 45 апр 9 21:40 docs<br>drwxr-xr-x. 3 root root 57 апр 9 21:43 myrepo<br>[root@kvmcentos ~]# cd myrepo/<br>[root@kvmcentos ~]# ls -l<br>итого 12<br>-rw-r--r--. 1 root root 14 апр 9 21:43 file1<br>-rw-r--r--. 1 root root 14 апр 9 21:43 file2<br>-rw-r--r--. 1 root root 15 апр 9 21:43 file3<br>[root@kvmcentos ~]# echo "new line" &gt;&gt; file1<br>[root@kvmcentos ~]# cat myrepo/file1<br>it is file 1<br>new line<br>new line2<br>[root@kvmcentos ~]# svn commit -m "file1 has been modified"<br>Sending file1<br>Transmitting file data .done<br>Committing transaction...<br>Committed revision 2.<br>[root@kvmcentos ~]# ls -l /svn/myrepo<br>итого 12<br>drwxr-xr-x. 2 root root 76 апр 9 21:36 conf<br>drwxr-sr-x. 6 root root 4096 апр 9 21:46 db<br>-r--r--r--. 1 root root 2 апр 9 21:36 format<br>drwxr-xr-x. 2 root root 231 апр 9 21:36 hooks<br>drwxr-xr-x. 2 root root 41 апр 9 21:36 locks<br>-rw-r--r--. 1 root root 246 апр 9 21:36 README.txt<br>[root@kvmcentos ~]# ifconfig<br>...<br>inet tipcentos<br>...<br><strong>Decision:</strong><br>[root@kvmcentos ~]# yum -y install subversion<br>[root@kvmcentos ~]# pwd<br>/home/tuser<br><strong>Task:</strong><br>Subversion - система контроля версий.<br>Получение копии репозитория с удаленного сервера где у вас есть аккаунт Убедитесь, что пользователь включен в нужную группу для доступа к репозиториям.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# svn co svn+ssh://root@tipcentos/svn/myrepo<br>root@tipcentos's password:<br>A myrepo/file1<br>A myrepo/file2<br>A myrepo/file3<br>Получена редакция 3.<br>[root@kvmcentos ~]# ls myrepo/<br>file1 file2 file3<br>[root@kvmcentos ~]# cd myrepo/<br>[root@kvmcentos ~]# cat file2<br>it is file 2<br>[root@kvmcentos ~]# vim file2<br>[root@kvmcentos ~]# cat file2<br>it is file 2<br>new modificate 1<br>[root@kvmcentos ~]# svn commit -m "file2 has been modified"<br>root@tipcentos's password:<br>Посылаю file2<br>Передаю данные .done<br>Committing transaction...<br>Committed revision 4.<br>[root@kvmcentos ~]# cat file3<br>it is file 3<br>[root@kvmcentos ~]# vim file3<br>[root@kvmcentos ~]# cat file3<br>it is file 3<br>new file3<br>[root@kvmcentos ~]# svn commit -m "file3 has been modified"<br>Sending file3<br>Transmitting file data .done<br>Committing transaction...<br>Committed revision 5.<br>[root@kvmcentos ~]# svn info file:///svn/myrepo<br>Path: myrepo<br>URL: file:///svn/myrepo<br>Relative URL: ^/<br>Repository Root: file:///svn/myrepo<br>Repository UUID: bbe1dc47-235c-4cf4-b253-af3d81a943a3<br>Revision: 5<br>Node Kind: directory<br>Last Changed Author: root<br>Last Changed Rev: 5<br>Last Changed Date: 2020-04-29 07:43:37 -0400 (Ср, 29 апр 2020)<br>[root@kvmcentos ~]# cat file3<br>it is file 3<br>[root@kvmcentos ~]# vim file3<br>[root@kvmcentos ~]# cat file3<br>it is file 3<br>modified ubuntu3<br>[root@kvmcentos ~]# svn commit -m "file3 has been modified ubuntu3"<br>root@tipcentos's password:<br>Посылаю file3<br>Передаю данные .done<br>Committing transaction...<br>svn: E160028: Фиксация не удалась (подробности приведены ниже):<br>svn: E160028: File '/file3' is out of date<br>[root@kvmcentos ~]# svn update<br>Updating '.':<br>root@tipcentos's password:<br>C file3<br>Обновлено до редакции 5.<br>Summary of conflicts:<br>Text conflicts: 1<br>Conflict discovered in file 'file3'.<br>Select: (p) postpone, (df) show diff, (e) edit file, (m) merge,<br>(mc) my side of conflict, (tc) their side of conflict,<br>(s) show all options: m<br>Merging 'file3'.<br>Conflicting section found during merge:<br>(1) their version (at line 2) |(2) your version (at line 2)<br>--------------------------------------+--------------------------------------<br>new file3 |modified ubuntu3<br>--------------------------------------+--------------------------------------<br>Select: (1) use their version, (2) use your version,<br>(12) their version first, then yours,<br>(21) your version first, then theirs,<br>(e1) edit their version and use the result,<br>(e2) edit your version and use the result,<br>(eb) edit both versions and use the result,<br>(p) postpone this conflicting section leaving conflict markers,<br>(a) abort file merge and return to main menu: 2<br>Merge of 'file3' completed.<br>Select: (p) postpone, (df) show diff, (e) edit file, (m) merge,<br>(r) mark resolved, (mc) my side of conflict,<br>(tc) their side of conflict, (s) show all options: p<br>Summary of conflicts:<br>Text conflicts: 1<br>[root@kvmcentos ~]# ls<br>file1 file2 file3 file3.mine file3.r3 file3.r5<br>[root@kvmcentos ~]# cat file3.r3<br>it is file 3<br>[root@kvmcentos ~]# cat file3.r5<br>it is file 3<br>new file3<br>[root@kvmcentos ~]# cat file3.mine<br>it is file 3<br>modified ubuntu3<br>[root@kvmcentos ~]# rm -f file3.r3 file3.r5 file3.mine<br>[root@kvmcentos ~]# vim file3<br>[root@kvmcentos ~]# cat file3<br>it is file 3<br>modified ubuntu3<br>[root@kvmcentos ~]# svn commit -m "file3 has been modified ubuntu3"<br>root@tipcentos's password:<br>Посылаю file3<br>Передаю данные .done<br>Committing transaction...<br>Committed revision 6.<br>[root@kvmcentos ~]# svn update<br>Updating '.':<br>U file3<br>U file2<br>Updated to revision 6.<br>[root@kvmcentos ~]# ls -l<br>итого 12<br>-rw-r--r--. 1 root root 33 апр 29 06:47 file1<br>-rw-r--r--. 1 root root 30 апр 29 07:57 file2<br>-rw-r--r--. 1 root root 30 апр 29 07:57 file3<br>[root@kvmcentos ~]# cat file3<br>it is file 3<br>modified ubuntu3<br><strong>Task:</strong><br>Subversion - система контроля версий.<br>Системный пользователь, который не является членом группы agents.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# svn list svn+ssh://mybestuser@linuxbox/svn/myrepo <br>mybestuser@linuxbox's password:<br>file1<br>file2<br>file3<br>secret/<br>[root@kvmcentos ~]# svn list svn+ssh://mybestuser@linuxbox/svn/myrepo/secret<br>mybestuser@linuxbox's password:<br>svn: Authorization failed<br>[root@kvmcentos ~]# svn list svn+ssh://mybestuser@linuxbox/svn/myrepo/secret/public<br>mybestuser@linuxbox’s password:<br>file3<br><strong>Task:</strong><br>Ограничение доступа Subversion - система контроля версий.<br>У нас уже есть репозиторий /svn/myrepo и сейчас мы разберемся с правами доступа к нему.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# useradd james<br>[root@kvmcentos ~]# passwd james<br>[root@kvmcentos ~]# ls -l /svn/myrepo/conf/<br>итого 20<br>-rw-r--r--. 1 root root 1080 апр 9 21:36 authz<br>-rw-r--r--. 1 root root 885 апр 9 21:36 hooks-env.tmpl<br>-rw-r--r--. 1 root root 309 апр 9 21:36 passwd<br>-rw-r--r--. 1 root root 4391 апр 29 08:05 svnserve.conf<br>[root@kvmcentos ~]# vim /svn/myrepo/conf/svnserve.conf<br>[root@kvmcentos ~]# cat /svn/myrepo/conf/svnserve.conf<br>...<br>[general]<br>anon-access = none<br>[root@kvmcentos ~]#auth-access = write<br>[root@kvmcentos ~]#password-db = passwd<br>authz-db = authz<br>[root@kvmcentos ~]#realm = Bunch_Of_My_Repos<br><strong>Task:</strong><br>Subversion - система контроля версий.<br>Передаваемая информация не шифруется. Этот способ устарел и я не рекомендую его использовать.<br>Чтобы вы примерно понимали что это за файл я вам приведу пример.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# cat /svn/myrepo/conf/passwd<br>[users]<br>[root@kvmcentos ~]# harry = harryssecret<br>[root@kvmcentos ~]# sally = sallyssecret<br>[root@kvmcentos ~]# cat /svn/myrepo/conf/passwd<br>This file is an example password file for svnserve.<br>[root@kvmcentos ~]### Its format is similar to that of svnserve.conf. As shown in the<br>[root@kvmcentos ~]### example below it contains one section labelled [users].<br>[root@kvmcentos ~]### The name and password for each user follow, one account per line.<br>[users]<br>[root@kvmcentos ~]#harry = harryssecret<br>[root@kvmcentos ~]#sally = sallyssecret<br>james = qaz<br><strong>Task:</strong><br>Subversion - система контроля версий.<br>В файле svnserve.conf раскоментируем строку password-db = passwd, в файл authz добавим запись для пользователя harry если общая политика ему не подходит.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# vim /svn/myrepo/conf/svnserve.conf<br>...<br>[general]<br>anon-access = none<br>[root@kvmcentos ~]#auth-access = write<br>password-db = passwd<br>authz-db = authz<br>[root@kvmcentos ~]#realm = Bunch_Of_My_Repos<br><strong>Task:</strong><br>Subversion - система контроля версий.<br>Запустим службу svnserve.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# svnserve -d<br>[root@kvmcentos ~]# svn list svn://harry@kvm-tcentos/svn/myrepo<br>Authentication realm: &lt;svn://kvm-tcentos:3690&gt; bbe1dc47-235c-4cf4-b253-af3d81a943a3<br>Password for 'root': *************<br>Authentication realm: &lt;svn://kvm-tcentos:3690&gt; bbe1dc47-235c-4cf4-b253-af3d81a943a3<br>Username: james<br>Password for 'james': ***<br>-----------------------------------------------------------------------<br>ATTENTION! Your password for authentication realm:<br>&lt;svn://kvm-tcentos:3690&gt; bbe1dc47-235c-4cf4-b253-af3d81a943a3<br>can only be stored to disk unencrypted! You are advised to configure<br>your system so that Subversion can store passwords encrypted, if<br>possible. See the documentation for details.<br>You can avoid future appearances of this warning by setting the value<br>of the 'store-plaintext-passwords' option to either 'yes' or 'no' in<br>'/root/.subversion/servers'.<br>-----------------------------------------------------------------------<br>Store password unencrypted (yes/no)? yes<br>file1<br>file2<br>file3<br><strong>Task:</strong><br>Subversion - система контроля версий.<br>В том же каталоге где и svnserve.conf (&lt;путь к репозиторию&gt;/conf/) создаем файл authz и вносим в него конфигурацию.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# vim /svn/myrepo/conf/authz<br>[root@kvmcentos ~]# cat /svn/myrepo/conf/authz<br>agents = james, piter<br>[/]<br>*=r<br>[/secret]<br>@agents = rw<br>*=<br>[/secret/public]<br>* = rw<br><strong>Task:</strong><br>Subversion - система контроля версий.<br>Системный пользователь, который является членом группы agents.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# svn list svn+ssh://james@tipcentos/svn/myrepo<br>james@linuxbox's password:<br>file1<br>file2<br>file3<br>secret/<br>[root@kvmcentos ~]# svn list svn+ssh://james@tipcentos/svn/myrepo/secret<br>james@linuxbox's password:<br>file1<br>file2<br>file3<br>public/<br>[root@kvmcentos ~]# svn list svn+ssh://james@tipcentos/svn/myrepo/secret/public<br>james@linuxbox’s password:<br>file3<br><strong>Source:</strong><br># https://www.youtube.com/playlist?list=PLtSGboPf3g50Aejrp6KjQsqqjxvAO4aKw<br># https://www.youtube.com/playlist?list=PLdEqf7lxtAH--exov42yypdvOi7bDqoBQ<br># https://losst.ru/proverka-linux-na-virusy<br># https://www.youtube.com/watch?v=t6wO3qsxrSo&list=PL76C3E97EB0FDB323&index=18&t=0s<br># https://linuxconfig.org/how-to-install-xinetd-service-in-redhat<br><strong>Task:</strong><br>Зайти в графическую настройку с командной строки в Ubuntu<br>Столкнулся у себя с такой проблемой в декстопной версии Ubuntu, что пропали в панели меню настройки, а мне захотелось изменить в настроках фона фотографию.<br>Зайти в настройки можно с помощью командной строки<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# gnome-control-center<br><strong>Task:</strong><br>узнать дистрибутив.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# cat /etc/*-release<br>DISTRIB_ID=Ubuntu<br>DISTRIB_RELEASE=20.04<br>DISTRIB_CODENAME=focal<br>DISTRIB_DESCRIPTION="Ubuntu 20.04.5 LTS"<br>NAME="Ubuntu"<br>VERSION="20.04.5 LTS (Focal Fossa)"<br>ID=ubuntu<br>ID_LIKE=debian<br>PRETTY_NAME="Ubuntu 20.04.5 LTS"<br>VERSION_ID="20.04"<br>HOME_URL="https://www.ubuntu.com/"<br>SUPPORT_URL="https://help.ubuntu.com/"<br>BUG_REPORT_URL="https://bugs.launchpad.net/ubuntu/"<br>PRIVACY_POLICY_URL="https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"<br>VERSION_CODENAME=focal<br>UBUNTU_CODENAME=focal<br><strong>Source:</strong><br># https://losst.pro/kak-uznat-versiyu-linux - Как узнать версию Linux?<br><strong>Task:</strong><br>Составьте crontab файл для следующих процессов: <br>1. daily1.sh - ежедневно в 23:55. <br>2. daily2.sh - ежедневно в 8:00 и 17:00 <br>3. hourly.sh - каждый час в рабочее время (пн-пт, 8:00-17:30) <br>4. happy_new_year.sh - в момент наступления нового года <br>5. quatre.sh - каждые 4 часа<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# crontab -l<br>...<br>55 23 * * * /tdir/daily1.sh &gt; /tdir/addtestfile<br>0 8-17 * * * /tdir/daily2.sh &gt; /tdir/addtestfile<br>0 8-17 * * 1-5 /tdir/hourly.sh &gt; /tdir/addtestfile<br>0 0 1 1 * /tdir/happy_new_year.sh &gt; /tdir/addtestfile<br>* */4 * * * /tdir/quatre.sh &gt; /tdir/addtestfile<br><strong>Task:</strong><br>допустим у нас есть файл testcron.sh.<br>- Выполнить тестовый скрипт каждую минуту.<br>- Выполнить тестовый скрипт каждую минуту и добавим вывод в лог.<br>- Отредактируем таблицу cron root. Мы перезагрузим сервер в 4:15, вывод в null. /dev/null - вывода не будет, чтобы не спамило журнал системы.<br>- Редактировать таблицу cron пользователя tuser.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# chmod +x testcron.sh<br>root@kvmubuntu:~# ./testcron.sh<br>It is now 08:04:32 on (date +%A)<br>root@kvmubuntu:~# crontab -e<br>No modification made<br>root@kvmubuntu:~# crontab -e<br>* * * * * /home/administrator/testcron.sh<br>root@kvmubuntu:~# crontab -e<br>* * * * * /home/administrator/testcron.sh &gt;&gt; /home/administrator/test.log<br>root@kvmubuntu:~# ls<br>examples.desktop Видео Изображения 'Рабочий стол'<br>testcron.sh Документы Музыка Шаблоны<br>test.log Загрузки Общедоступные<br>root@kvmubuntu:~# cat test.log<br>root@kvmubuntu:~# cat test.log<br>It is now 08:05:01 on (date +%A)<br>root@kvmubuntu:~# crontab -l<br># Edit this file to introduce tasks to be run by cron.<br>#<br># Each task to run has to be defined through a single line<br># indicating with different fields when the task will be run<br># and what command to run for the task<br>#<br># To define the time you can provide concrete values for<br># minute (m), hour (h), day of month (dom), month (mon),<br># and day of week (dow) or use '*' in these fields (for 'any').#<br># Notice that tasks will be started based on the cron's system<br># daemon's notion of time and timezones.<br>#<br># Output of the crontab jobs (including errors) is sent through<br># email to the user the crontab file belongs to (unless redirected).<br>#<br># For example, you can run a backup of all your user accounts<br># at 5 a.m every week with:<br># 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/<br>#<br># For more information see the manual pages of crontab(5) and cron(8)<br>#<br># m h dom mon dow command<br>* * * * * /home/tuser/testcron.sh &gt;&gt; /home/tuser/test.log<br>root@kvmubuntu:~# crontab -e<br>15 4 * * * /sbin/reboot &gt; /dev/null 2&gt;&1 #<br>0 */2 * * * /etc/init.d/nginx restart &gt;&gt; /dev/null 2&gt;&1 #Перезапустить nginx каждый чётный час - */2<br>root@kvmubuntu:~# crontab -l<br># Edit this file to introduce tasks to be run by cron.<br>#<br># Each task to run has to be defined through a single line<br># indicating with different fields when the task will be run<br># and what command to run for the task<br>#<br># To define the time you can provide concrete values for<br># minute (m), hour (h), day of month (dom), month (mon),<br># and day of week (dow) or use '*' in these fields (for 'any').#<br># Notice that tasks will be started based on the cron's system<br># daemon's notion of time and timezones.<br>#<br># Output of the crontab jobs (including errors) is sent through<br># email to the user the crontab file belongs to (unless redirected).<br>#<br># For example, you can run a backup of all your user accounts<br># at 5 a.m every week with:<br># 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/<br>#<br># For more information see the manual pages of crontab(5) and cron(8)<br>#<br># m h dom mon dow command<br>15 4 * * * /sbin/reboot &gt; /dev/null 2&gt;&1<br>0 */2 * * * /etc/init.d/nginx restart &gt;&gt; /dev/null 2&gt;&1<br>root@kvmubuntu:~# cat test.log<br>It is now 08:05:01 on (date +%A)<br>It is now 08:06:01 on (date +%A)<br>root@kvmubuntu:~# date<br>Сб мар 7 08:06:01 MSK 2020<br>root@kvmubuntu:~# journalctl -e<br> мар 07 08:03:19 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces<br> мар 07 08:03:19 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces<br> мар 07 08:03:24 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces<br> мар 07 08:03:24 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces<br> мар 07 08:03:30 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces<br> мар 07 08:03:30 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces<br> мар 07 08:03:30 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces<br> мар 07 08:03:30 VirtualBox rtkit-daemon[1069]: Supervising 4 threads of 2 proces<br> мар 07 08:03:30 VirtualBox rtkit-daemon[1069]: Successfully made thread 2635 of<br> мар 07 08:03:30 VirtualBox rtkit-daemon[1069]: Supervising 5 threads of 3 proces<br> мар 07 08:03:35 VirtualBox rtkit-daemon[1069]: Supervising 5 threads of 3 proces<br> мар 07 08:03:35 VirtualBox rtkit-daemon[1069]: Supervising 5 threads of 3 proces<br> мар 07 08:04:01 VirtualBox CRON[2678]: pam_unix(cron:session): session opened fo<br> мар 07 08:04:01 VirtualBox CRON[2679]: (tuser) CMD (/home/tuser/testcron.sh &gt;&gt; /<br> мар 07 08:04:01 VirtualBox CRON[2678]: (CRON) info (No MTA installed, discarding<br> мар 07 08:04:01 VirtualBox CRON[2678]: pam_unix(cron:session): session closed fo<br> мар 07 08:05:01 VirtualBox CRON[2699]: pam_unix(cron:session): session opened fo<br> мар 07 08:05:01 VirtualBox CRON[2700]: (tuser) CMD (/home/tuser/testcron.sh &gt;&gt; /<br> мар 07 08:05:01 VirtualBox CRON[2699]: pam_unix(cron:session): session closed fo<br> мар 07 08:05:09 VirtualBox gnome-shell[1033]: JS WARNING: [resource:///org/gnome<br> мар 07 08:06:01 VirtualBox CRON[2719]: pam_unix(cron:session): session opened fo<br> мар 07 08:06:01 VirtualBox CRON[2720]: (tuser) CMD (/home/tuser/testcron.sh &gt;&gt; /<br> мар 07 08:06:01 VirtualBox CRON[2719]: pam_unix(cron:session): session closed fo<br>root@kvmubuntu:~# cat /etc/crontab<br># /etc/crontab: system-wide crontab<br># Unlike any other crontab you don't have to run the `crontab'<br># command to install the new version when you edit this file<br># and files in /etc/cron.d. These files also have username fields,<br># that none of the other crontabs do.<br>SHELL=/bin/sh<br>PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin<br># m h dom mon dow user command<br>17 * * * * root cd / && run-parts --report /etc/cron.hourly<br>25 6 * * * root test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )<br>47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )<br>52 6 1 * * root test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )<br>root@kvmubuntu:~# crontab -u tuser -e<br><strong>Task:</strong><br>Создайте скрипт, который создаёт файл. Настройте запуск этого скрипта раз в минуту. Проверьте результат.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ./CronBash.sh<br>root@kvmubuntu:~# cp CronBash.sh /usr/bin/<br>root@kvmubuntu:~# CronBash.sh<br>root@kvmubuntu:~# ls -l testfile<br>-rw-rw-r--. 1 tuser tuser 0 мая  4 09:48 testfile<br>root@kvmubuntu:~# cat /etc/crontab<br>SHELL=/bin/bash<br>PATH=/sbin:/bin:/usr/sbin:/usr/bin<br>MAILTO=root<br># For details see man 4 crontabs<br># Example of job definition:<br># .---------------- minute (0 - 59)<br># |  .------------- hour (0 - 23)<br># |  |  .---------- day of month (1 - 31)<br># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...<br># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat<br># |  |  |  |  |<br># *  *  *  *  * tuser-name  command to be executed<br>root@kvmubuntu:~# crontab -e<br>no crontab for tuser - using an empty one<br>crontab: installing new crontab<br>root@kvmubuntu:~# crontab -l<br>*  *  *  *  *  /usr/bin/CronBash.sh<br>root@kvmubuntu:~# ls -l testfile<br>-rw-rw-r--. 1 tuser tuser 0 мая  4 09:58 testfile<br>root@kvmubuntu:~# ls -l testfile<br>-rw-rw-r--. 1 tuser tuser 0 мая  4 09:59 testfile<br><strong>Task:</strong><br>Создайте пользователя backup и настройте для него cron, чтобы тот раз в день находил файлы старее 5 дней в директории /data и добавлял эти файлы в архив /backup/archive.tar, после чего удалял из исходной директории. Настройте cron у пользователя tuser, чтобы он каждые 10 минут создавал файл в директории /data.<br>Также у пользователя root создайте cron, чтобы он каждую пятницу в 23:30 записывал содержимое директории /data и содержимое архива /backup/archive.tar в файл /var/log/reports/текущаядата.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# useradd backup2<br>root@kvmubuntu:~# passwd backup2<br>root@kvmubuntu:~# mkdir /backup/<br>root@kvmubuntu:~# ls -l /data<br>итого 0<br>-rw-r--r--. 1 root root 0 апр 14 13:14 testfile1<br>-rw-r--r--. 1 root root 0 апр 14 13:14 testfile2<br>-rw-r--r--. 1 root root 0 апр 14 13:14 testfile3<br>-rw-r--r--. 1 root root 0 апр 14 13:14 testfile4<br>-rw-r--r--. 1 root root 0 апр 14 13:14 testfile5<br>root@kvmubuntu:~# su - backup2<br>root@kvmubuntu:~# ls -l /data/<br>итого 0<br>-rw-r--r--. 1 root root 0 апр 14 13:14 testfile1<br>-rw-r--r--. 1 root root 0 апр 14 13:14 testfile2<br>-rw-r--r--. 1 root root 0 апр 14 13:14 testfile3<br>-rw-r--r--. 1 root root 0 апр 14 13:14 testfile4<br>-rw-r--r--. 1 root root 0 апр 14 13:14 testfile5<br>root@kvmubuntu:~# rm -rf /backup/archive.tar<br>root@kvmubuntu:~# ./CronBash2.sh<br>/data/testfile5<br>/data/testfile1<br>/data/testfile3<br>/data/testfile2<br>/data/testfile4<br>testfile1<br>testfile2<br>testfile3<br>testfile4<br>testfile5<br>root@kvmubuntu:~# ls -l /data/<br>итого 0<br>root@kvmubuntu:~# ls -l /backup/<br>итого 12<br>-rw-r--r--. 1 root root 10240 мая 11 11:19 archive.tar<br>root@kvmubuntu:~# tar -tf /backup/archive.tar<br>testfile1<br>testfile2<br>testfile3<br>testfile4<br>testfile5<br>root@kvmubuntu:~# crontab -e<br>no crontab for backup2 - using an empty one<br>crontab: installing new crontab<br>root@kvmubuntu:~# crontab -l<br>5 11 * * * tar --totals -cvf /backup/archive.tar /data/testfile{1..2} | rm -rf /data/testfile{1..2}<br>root@kvmubuntu:~# mv CronBash2.sh /usr/bin/<br>root@kvmubuntu:~# exit<br>root@kvmubuntu:~# vim /var/spool/cron/backup2<br>root@kvmubuntu:~# cat /var/spool/cron/backup2<br>@daily /usr/bin/CronBash2.sh<br>root@kvmubuntu:~# chown user:user /data<br>root@kvmubuntu:~# ls -l /<br>...<br>drwxr-xr-x.   2 user user  4096 мая 11 11:19 data<br>...<br>root@kvmubuntu:~# mv CronBash3.sh /usr/bin<br>root@kvmubuntu:~# whoami<br>user<br>root@kvmubuntu:~# crontab -e<br>crontab: installing new crontab<br>root@kvmubuntu:~# crontab -l<br>#*  *  *  *  *  /usr/bin/CronBash.sh<br>@reboot mkdir testdir<br>*/10  *  *  *  *  /usr/bin/CronBash3.sh<br>root@kvmubuntu:~# ls -l /data/<br>итого 0<br>-rw-r--r--. 1 user user 0 мая 12 08:57 testfile0<br>root@kvmubuntu:~# vim /var/spool/cron/root<br>root@kvmubuntu:~# cat /var/spool/cron/root<br>30  23  *  *  5  CronBash4.sh<br><strong>Source:</strong><br># https://basis.gnulinux.pro/ru/latest/<br><strong>Task:</strong><br>Packet Tracer Install Ubuntu<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# virsh start ubuntu22.04<br>root@kvmubuntu:~# ssh -X user@IpAddrUbuntu<br>root@kvmubuntu:~# google-chrome https://www.google.ru/search?q=cisco+account+create&newwindow=1&source=hp&ei=Z8eqYdOSEcTIrgSIwIeQDQ&iflsig=ALs-wAMAAAAAYarVd9Qob1A5NSTfBETDiQsuP3G5I7gv&ved=0ahUKEwiT4p6Jgsn0AhVEpIsKHQjgAdIQ4dUDCAY&uact=5&oq=cisco+account+create&gs_lcp=Cgdnd3Mtd2l6EAMyBQgAEIAEMgUIABCABDIGCAAQFhAeMgYIABAWEB4yBggAEBYQHjIGCAAQFhAeMgYIABAWEB4yBggAEBYQHjIGCAAQFhAeMgYIABAWEB5QAFgAYPgEaABwAHgAgAGBAYgBgQGSAQMwLjGYAQCgAQKgAQE&sclient=gws-wiz &<br>root@kvmubuntu:~# google-chrome https://id.cisco.com/signin/register &<br>root@kvmubuntu:~# google-chrome https://temp-mail.org/ &<br>xanaveb196@simdpi.com - https://id.cisco.com/signin/register - mail: xanaveb196@simdpi.com - https://temp-mail.org/ - <br>Активировать Аккаунт - https://id.cisco.com/signin/register - xanaveb196@simdpi.com<br>root@kvmubuntu:~# google-chrome https://www.google.ru/search?q=netacad+introduction+to+packet+tracer&newwindow=1&ei=Ks-qYZugA5a_rgTF_beoDw&oq=netacad+into+to+pa&gs_lcp=Cgdnd3Mtd2l6EAMYAjIGCAAQFhAeMgYIABAWEB4yBggAEBYQHjoHCAAQRxCwAzoNCC4QxwEQ0QMQsAMQQzoHCAAQsAMQQzoFCAAQgAQ6BQghEKABOgUIABDNAkoFCDwSATJKBAhBGABKBAhGGABQ96cZWMXDGWC44RloAnACeACAAZwBiAHGCpIBBDAuMTCYAQCgAQHIAQrAAQE&sclient=gws-wiz &<br>root@kvmubuntu:~# google-chrome https://www.netacad.com/portal/resources/packet-tracer &<br>root@kvmubuntu:~# wget https://www.netacad.com/portal/resources/file/71b29477-0abb-4a52-97eb-cc23d5771574<br>root@kvmubuntu:~# ls<br>CiscoPacketTracer_821_Ubuntu_64bit.deb<br>root@kvmubuntu:~# apt install -f<br>root@kvmubuntu:~# dpkg -i CiscoPacketTracer_821_Ubuntu_64bit.deb<br>root@kvmubuntu:~# packettracer &<br><strong>Task:</strong><br>Компиляция программ с помощью команд ./configure и make<br>Давайте что-нибудь скомпилируем. Для этого нам понадобятся некоторые инструменты, такие как компилятор, компоновщик и утилита make . Практически во всех системах Linux используется один и тот же компилятор языка C с именем gcc (GNU C Compiler). <br>Получение исходного кода<br>Ckомпилируем программу с названием diction из проекта GNU. Эта маленькая удобная программка проверяет качество и стиль содержимого текстовых файлов. А поскольку она невелика, она легко компилируется.<br>Следуя соглашениям, мы сначала создадим каталог src для исходного кода и затем загрузим в него исходный код с помощью команды ftp.<br>Поскольку мы сами управляем процессом компиляции исходного кода, поместим его в каталог ~/src. Исходный код, устанавливаемый дистрибутивом, помещается в каталог /usr/src, а исходный код, предназначенный для использования множеством пользователей, обычно устанавливается в /usr/local/src.<br>Исходный код обычно распространяется в виде сжатого tar-файла. Подключившись к FTP-сайту, мы получили список доступных tar-файлов и выбрали для загрузки самую свежую версию. При помощи команды get программы ftp скопировали файл с сервера FTP на локальную машину.<br>После загрузки tar-файла его нужно распаковать. Программа diction , подобно всем программам из проекта GNU, следует определенным стандартам упаковки исходного кода. Большая часть других исходных кодов, доступных в экосистеме Linux, также следует этому стандарту. Одним из элементов стандарта является создание каталога с деревом исходных текстов и именем project-x.xx после распаковывания tar-файла, то есть с именем, содержащим имя проекта и номер версии. Такая схема упрощает установку нескольких версий одной и той же программы. Однако перед распаковыванием хорошо бы исследовать организацию дерева. При распаковывании некоторых проектов каталог не создается, а файлы помещаются непосредственно в текущий каталог, что может вызвать неразбериху и путаницу в хорошо организованном каталоге src. Чтобы избежать этого, пользуйтесь следующей командой для исследования содержимого tar-файла.<br>Исследование дерева исходных текстов.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# which gcc<br>/usr/bin/gcc<br>root@kvmubuntu:~# mkdir src<br>root@kvmubuntu:~# cd src/<br>root@kvmubuntu:~# ftp ftp.gnu.org<br>&nbsp;&nbsp;Name (ftp.gnu.org:server): anonymous<br>&nbsp;&nbsp;...<br>&nbsp;&nbsp;230 Login successful.<br>&nbsp;&nbsp;Remote system type is UNIX.<br>&nbsp;&nbsp;Using binary mode to transfer files.<br>ftp&gt; cd gnu/diction<br>&nbsp;&nbsp;250 Directory successfully changed.<br>ftp&gt; ls<br>&nbsp;&nbsp;200 PORT command successful. Consider using PASV.<br>&nbsp;&nbsp;150 Here comes the directory listing.<br>&nbsp;&nbsp;-rw-r--r--&nbsp;&nbsp;1 3003&nbsp;&nbsp; 65534&nbsp;&nbsp;   68940 Aug 28  1998 diction-0.7.tar.gz<br>&nbsp;&nbsp;-rw-r--r--&nbsp;&nbsp;1 3003&nbsp;&nbsp; 65534&nbsp;&nbsp;   90957 Mar 04  2002 diction-1.02.tar.gz<br>&nbsp;&nbsp;-rw-r--r--&nbsp;&nbsp;1 3003&nbsp;&nbsp; 65534&nbsp;&nbsp;  141062 Sep 17  2007 diction-1.11.tar.gz<br>&nbsp;&nbsp;-rw-r--r--&nbsp;&nbsp;1 3003&nbsp;&nbsp; 65534&nbsp;&nbsp;&nbsp;&nbsp; 189 Sep 17  2007 diction-1.11.tar.gz.sig<br>&nbsp;&nbsp;226 Directory send OK.<br>ftp&gt; get diction-1.11.tar.gz<br>ftp&gt; bye<br>&nbsp;&nbsp;221 Goodbye.<br>root@kvmubuntu:~# tar tzvf diction-1.11.tar.gz | head<br>&nbsp;&nbsp;-rw-r--r-- michael/user  35068 2007-07-30 14:47 diction-1.11/COPYING<br>&nbsp;&nbsp;-rw-r--r-- michael/user   9416 2007-08-03 01:03 diction-1.11/INSTALL<br>&nbsp;&nbsp;-rw-r--r-- michael/user   3920 2007-08-03 04:05 diction-1.11/Makefile.in<br>&nbsp;&nbsp;-rw-r--r-- michael/user   1448 2007-08-30 04:20 diction-1.11/README<br>&nbsp;&nbsp;-rw-r--r-- michael/user&nbsp;&nbsp;152 2007-08-30 02:08 diction-1.11/NEWS<br>&nbsp;&nbsp;-rwxr-xr-x michael/user 144080 2007-08-30 02:06 diction-1.11/configure<br>&nbsp;&nbsp;-rwxr-xr-x michael/user  13184 2007-08-03 01:03 diction-1.11/install-sh<br>&nbsp;&nbsp;-rw-r--r-- michael/user   2621 2007-03-30 15:45 diction-1.11/de<br>&nbsp;&nbsp;-rw-r--r-- michael/user  24830 2007-03-30 15:45 diction-1.11/en<br>&nbsp;&nbsp;-rw-r--r-- michael/user  25043 2007-03-30 15:45 diction-1.11/en_GB<br>root@kvmubuntu:~# tar xzf diction-1.11.tar.gz<br>root@kvmubuntu:~# ls -l<br>&nbsp;&nbsp;total 144<br>&nbsp;&nbsp;drwxrwxr-x 3 s s   4096 Jan  3 20:55 diction-1.11<br>&nbsp;&nbsp;-rw-rw-r-- 1 s s 141062 Jan  3 20:47 diction-1.11.tar.gz<br>root@kvmubuntu:~# cd diction-1.11<br>root@kvmubuntu:~# ls -l<br>&nbsp;&nbsp;config.guess  de&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diction.spec.in  getopt.c&nbsp;&nbsp;  misc.c  sentence.c<br>&nbsp;&nbsp;config.h.in   de.po&nbsp;&nbsp;&nbsp;&nbsp; diction.texi.in  getopt.h&nbsp;&nbsp;  misc.h  sentence.h<br>&nbsp;&nbsp;config.sub&nbsp;&nbsp;diction.1.in  en&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   getopt_int.h  NEWS&nbsp;&nbsp;style.1.in<br>&nbsp;&nbsp;configure&nbsp;&nbsp; diction.c&nbsp;&nbsp; en_GB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSTALL&nbsp;&nbsp;   nl&nbsp;&nbsp;  style.c<br>&nbsp;&nbsp;configure.in  diction.pot   en_GB.po&nbsp;&nbsp;&nbsp;&nbsp; install-sh&nbsp;&nbsp;nl.po   test<br>&nbsp;&nbsp;COPYING&nbsp;&nbsp;   diction.spec  getopt1.c&nbsp;&nbsp;&nbsp;&nbsp;Makefile.in   README<br>root@kvmubuntu:~# ls *.c<br>&nbsp;&nbsp;diction.c  getopt1.c  getopt.c  misc.c  sentence.c  style.c<br>root@kvmubuntu:~# ls *.h<br>&nbsp;&nbsp;getopt.h  getopt_int.h  misc.h  sentence.h<br>root@kvmubuntu:~# ls /usr/include<br>&nbsp;&nbsp;aio.h&nbsp;&nbsp;&nbsp;&nbsp;fnmatch.h&nbsp;&nbsp;   mcheck.h&nbsp;&nbsp;&nbsp;&nbsp;pty.h&nbsp;&nbsp;&nbsp;&nbsp;  sysexits.h<br>&nbsp;&nbsp;aliases.h&nbsp;&nbsp;fstab.h&nbsp;&nbsp;&nbsp;&nbsp; memory.h&nbsp;&nbsp;&nbsp;&nbsp;pwd.h&nbsp;&nbsp;&nbsp;&nbsp;  syslog.h<br>&nbsp;&nbsp;alloca.h&nbsp;&nbsp; fts.h&nbsp;&nbsp;&nbsp;&nbsp;   misc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;python3.8&nbsp;&nbsp;  tar.h<br>&nbsp;&nbsp;argp.h&nbsp;&nbsp;   ftw.h&nbsp;&nbsp;&nbsp;&nbsp;   mlocate&nbsp;&nbsp;&nbsp;&nbsp; rdma&nbsp;&nbsp;&nbsp;&nbsp;   termio.h<br>&nbsp;&nbsp;argz.h&nbsp;&nbsp;   gcalc-2&nbsp;&nbsp;&nbsp;&nbsp; mntent.h&nbsp;&nbsp;&nbsp;&nbsp;re_comp.h&nbsp;&nbsp;  termios.h<br>&nbsp;&nbsp;ar.h&nbsp;&nbsp;&nbsp;&nbsp; gci-2&nbsp;&nbsp;&nbsp;&nbsp;   monetary.h&nbsp;&nbsp;  regex.h&nbsp;&nbsp;&nbsp;&nbsp;tgmath.h<br>&nbsp;&nbsp;arpa&nbsp;&nbsp;&nbsp;&nbsp; gconv.h&nbsp;&nbsp;&nbsp;&nbsp; mqueue.h&nbsp;&nbsp;&nbsp;&nbsp;regexp.h&nbsp;&nbsp;   thread_db.h<br>&nbsp;&nbsp;asm-generic  getopt.h&nbsp;&nbsp;&nbsp;&nbsp;mtd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reglib&nbsp;&nbsp;&nbsp;&nbsp; threads.h<br>&nbsp;&nbsp;assert.h&nbsp;&nbsp; GL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  net&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resolv.h&nbsp;&nbsp;   time.h<br>&nbsp;&nbsp;byteswap.h   glob.h&nbsp;&nbsp;&nbsp;&nbsp;  netash&nbsp;&nbsp;&nbsp;&nbsp;  rpc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ttyent.h<br>&nbsp;&nbsp;c++&nbsp;&nbsp;&nbsp;&nbsp;  gnumake.h&nbsp;&nbsp;   netatalk&nbsp;&nbsp;&nbsp;&nbsp;rpcsvc&nbsp;&nbsp;&nbsp;&nbsp; uchar.h<br>&nbsp;&nbsp;clif.h&nbsp;&nbsp;   gnu-versions.h  netax25&nbsp;&nbsp;&nbsp;&nbsp; sched.h&nbsp;&nbsp;&nbsp;&nbsp;ucontext.h<br>&nbsp;&nbsp;complex.h&nbsp;&nbsp;grp.h&nbsp;&nbsp;&nbsp;&nbsp;   netdb.h&nbsp;&nbsp;&nbsp;&nbsp; scsi&nbsp;&nbsp;&nbsp;&nbsp;   ulimit.h<br>&nbsp;&nbsp;cpio.h&nbsp;&nbsp;   gshadow.h&nbsp;&nbsp;   neteconet&nbsp;&nbsp;   search.h&nbsp;&nbsp;   unistd.h<br>&nbsp;&nbsp;crypt.h&nbsp;&nbsp;  iconv.h&nbsp;&nbsp;&nbsp;&nbsp; netinet&nbsp;&nbsp;&nbsp;&nbsp; semaphore.h&nbsp;&nbsp;utime.h<br>&nbsp;&nbsp;ctype.h&nbsp;&nbsp;  ifaddrs.h&nbsp;&nbsp;   netipx&nbsp;&nbsp;&nbsp;&nbsp;  setjmp.h&nbsp;&nbsp;   utmp.h<br>&nbsp;&nbsp;dirent.h&nbsp;&nbsp; inttypes.h&nbsp;&nbsp;  netiucv&nbsp;&nbsp;&nbsp;&nbsp; sgtty.h&nbsp;&nbsp;&nbsp;&nbsp;utmpx.h<br>&nbsp;&nbsp;dlfcn.h&nbsp;&nbsp;  iproute2&nbsp;&nbsp;&nbsp;&nbsp;netpacket&nbsp;&nbsp;   shadow.h&nbsp;&nbsp;   values.h<br>&nbsp;&nbsp;drm&nbsp;&nbsp;&nbsp;&nbsp;  KHR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; netrom&nbsp;&nbsp;&nbsp;&nbsp;  signal.h&nbsp;&nbsp;   video<br>&nbsp;&nbsp;elf.h&nbsp;&nbsp;&nbsp;&nbsp;langinfo.h&nbsp;&nbsp;  netrose&nbsp;&nbsp;&nbsp;&nbsp; sound&nbsp;&nbsp;&nbsp;&nbsp;  wait.h<br>&nbsp;&nbsp;endian.h&nbsp;&nbsp; lastlog.h&nbsp;&nbsp;   nfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; spawn.h&nbsp;&nbsp;&nbsp;&nbsp;wchar.h<br>&nbsp;&nbsp;envz.h&nbsp;&nbsp;   libdrm&nbsp;&nbsp;&nbsp;&nbsp;  nl_types.h&nbsp;&nbsp;  stab.h&nbsp;&nbsp;&nbsp;&nbsp; wctype.h<br>&nbsp;&nbsp;err.h&nbsp;&nbsp;&nbsp;&nbsp;libgen.h&nbsp;&nbsp;&nbsp;&nbsp;nss.h&nbsp;&nbsp;&nbsp;&nbsp;   stdc-predef.h  wordexp.h<br>&nbsp;&nbsp;errno.h&nbsp;&nbsp;  libintl.h&nbsp;&nbsp;   obstack.h&nbsp;&nbsp;   stdint.h&nbsp;&nbsp;   X11<br>&nbsp;&nbsp;error.h&nbsp;&nbsp;  libsync.h&nbsp;&nbsp;   openvpn&nbsp;&nbsp;&nbsp;&nbsp; stdio_ext.h&nbsp;&nbsp;x86_64-linux-gnu<br>&nbsp;&nbsp;execinfo.h   limits.h&nbsp;&nbsp;&nbsp;&nbsp;paths.h&nbsp;&nbsp;&nbsp;&nbsp; stdio.h&nbsp;&nbsp;&nbsp;&nbsp;xcb<br>&nbsp;&nbsp;fcntl.h&nbsp;&nbsp;  link.h&nbsp;&nbsp;&nbsp;&nbsp;  poll.h&nbsp;&nbsp;&nbsp;&nbsp;  stdlib.h&nbsp;&nbsp;   xen<br>&nbsp;&nbsp;features.h   linux&nbsp;&nbsp;&nbsp;&nbsp;   printf.h&nbsp;&nbsp;&nbsp;&nbsp;string.h&nbsp;&nbsp;   xf86drm.h<br>&nbsp;&nbsp;fenv.h&nbsp;&nbsp;   locale.h&nbsp;&nbsp;&nbsp;&nbsp;proc_service.h  strings.h&nbsp;&nbsp;  xf86drmMode.h<br>&nbsp;&nbsp;finclude&nbsp;&nbsp; malloc.h&nbsp;&nbsp;&nbsp;&nbsp;protocols&nbsp;&nbsp;   sudo_plugin.h  xorg<br>&nbsp;&nbsp;fmtmsg.h&nbsp;&nbsp; math.h&nbsp;&nbsp;&nbsp;&nbsp;  pthread.h&nbsp;&nbsp;   syscall.h<br><strong>Task:</strong><br>Сборка программ<br>- Давайте запустим configure . Так как эта программа находится не там, где командная оболочка обычно ищет выполняемые файлы, нужно явно сообщить ей местоположение программы, добавив в команду префикс ./ . Он указывает, что программа находится в текущем рабочем каталоге.<br>- давайте запустим make и соберем наши программы<br>- Мы только что скомпилировали первые программы из исходного кода! Но, исключительно ради любопытства, запустим make еще раз<br>- Во всем виновата make . Вместо того чтобы просто собрать все заново, make собирает только то, что нужно собрать. Так как все целевые файлы уже присутствуют в каталоге, make решила, что ничего больше делать не требуется. Продемонстрировать это можно, удалив одну из собранных целей и запустив make снова.<br>Воспользуемся программой touch , чтобы «обновить» один из файлов с исходным кодом, и посмотрим, к чему это приведет.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ./configure<br>&nbsp;&nbsp;...<br>&nbsp;&nbsp;configure: creating ./config.status<br>&nbsp;&nbsp;config.status: creating Makefile<br>&nbsp;&nbsp;config.status: creating diction.1<br>&nbsp;&nbsp;config.status: creating diction.texi<br>&nbsp;&nbsp;config.status: creating diction.spec<br>&nbsp;&nbsp;config.status: creating style.1<br>&nbsp;&nbsp;config.status: creating test/rundiction<br>&nbsp;&nbsp;config.status: creating config.h<br>root@kvmubuntu:~# cat Makefile<br>...<br>CC=&nbsp;&nbsp; gcc<br>...<br>diction:&nbsp;&nbsp;diction.o sentence.o misc.o getopt.o getopt1.o<br>&nbsp;&nbsp;&nbsp;&nbsp;$(CC) -o $@ $(LDFLAGS) diction.o sentence.o misc.o \<br>&nbsp;&nbsp;&nbsp;&nbsp;getopt.o getopt1.o $(LIBS)<br>...<br>.c.o:<br>&nbsp;&nbsp;&nbsp;&nbsp;$(CC) -c $(CPPFLAGS) $(CFLAGS) $&lt;<br>&nbsp;&nbsp;&nbsp;&nbsp;...<br>#{{{ dependencies<br>diction.o:  diction.c config.h getopt.h misc.h sentence.h<br>getopt.o:   getopt.c getopt.h getopt_int.h<br>getopt1.o:  getopt1.c getopt.h getopt_int.h<br>misc.o: misc.c config.h misc.h<br>sentence.o: sentence.c config.h misc.h sentence.h<br>style.o:&nbsp;&nbsp;style.c config.h getopt.h misc.h sentence.h<br>#}}}<br>root@kvmubuntu:~# make<br>root@kvmubuntu:~# ls<br>&nbsp;&nbsp;config.guess   de.po&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diction.texi.in  INSTALL&nbsp;&nbsp;  README<br>&nbsp;&nbsp;config.h&nbsp;&nbsp;   diction&nbsp;&nbsp;&nbsp;&nbsp;  en&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   install-sh   sentence.c<br>&nbsp;&nbsp;config.h.in&nbsp;&nbsp;diction.1&nbsp;&nbsp;&nbsp;&nbsp;en_GB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Makefile&nbsp;&nbsp; sentence.h<br>&nbsp;&nbsp;config.log&nbsp;&nbsp; diction.1.in&nbsp;&nbsp; en_GB.po&nbsp;&nbsp;&nbsp;&nbsp; Makefile.in  sentence.o<br>&nbsp;&nbsp;config.status  diction.c&nbsp;&nbsp;&nbsp;&nbsp;getopt1.c&nbsp;&nbsp;&nbsp;&nbsp;misc.c&nbsp;&nbsp;   style<br>&nbsp;&nbsp;config.sub&nbsp;&nbsp; diction.o&nbsp;&nbsp;&nbsp;&nbsp;getopt1.o&nbsp;&nbsp;&nbsp;&nbsp;misc.h&nbsp;&nbsp;   style.1<br>&nbsp;&nbsp;configure&nbsp;&nbsp;  diction.pot&nbsp;&nbsp;  getopt.c&nbsp;&nbsp;&nbsp;&nbsp; misc.o&nbsp;&nbsp;   style.1.in<br>&nbsp;&nbsp;configure.in   diction.spec&nbsp;&nbsp; getopt.h&nbsp;&nbsp;&nbsp;&nbsp; NEWS&nbsp;&nbsp;&nbsp;&nbsp; style.c<br>&nbsp;&nbsp;COPYING&nbsp;&nbsp;&nbsp;&nbsp;diction.spec.in  getopt_int.h&nbsp;&nbsp; nl&nbsp;&nbsp;&nbsp;&nbsp;   style.o<br>&nbsp;&nbsp;de&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; diction.texi&nbsp;&nbsp; getopt.o&nbsp;&nbsp;&nbsp;&nbsp; nl.po&nbsp;&nbsp;&nbsp;&nbsp;test<br>root@kvmubuntu:~# make<br>&nbsp;&nbsp;make: Nothing to be done for 'all'.<br>root@kvmubuntu:~# rm getopt.o<br>root@kvmubuntu:~# make<br>&nbsp;&nbsp;...<br>&nbsp;&nbsp;gcc -o diction -g diction.o sentence.o misc.o \<br>&nbsp;&nbsp;&nbsp;&nbsp;getopt.o getopt1.o<br>&nbsp;&nbsp;gcc -o style -g style.o sentence.o misc.o \<br>&nbsp;&nbsp;&nbsp;&nbsp;getopt.o getopt1.o -lm<br>root@kvmubuntu:~# ls -l diction getopt.c<br>&nbsp;&nbsp;-rwxrwxr-x 1 s s 68128 Jan  3 21:22 diction<br>&nbsp;&nbsp;-rw-r--r-- 1 s s 33125 Mar 30  2007 getopt.c<br>root@kvmubuntu:~# touch getopt.c<br>root@kvmubuntu:~# ls -l diction getopt.c<br>&nbsp;&nbsp;-rwxrwxr-x 1 s s 68128 Jan  3 21:22 diction<br>&nbsp;&nbsp;-rw-r--r-- 1 s s 33125 Jan  3 21:24 getopt.c<br>root@kvmubuntu:~# make<br>&nbsp;&nbsp;gcc -c -I. -DSHAREDIR=\"/usr/local/share\" -DLOCALEDIR=\"/usr/local/share/locale\" -g -O2 -pipe -Wno-unused -Wshadow -Wbad-function-cast -Wmissing-prototypes -Wstrict-prototypes -Wcast-align -Wcast-qual -Wpointer-arith -Wcast-align -Wwrite-strings -Wmissing-declarations -Wnested-externs -Wundef -pedantic -fno-common getopt.c<br>&nbsp;&nbsp;gcc -o diction -g diction.o sentence.o misc.o \<br>&nbsp;&nbsp;&nbsp;&nbsp;getopt.o getopt1.o<br>&nbsp;&nbsp;gcc -o style -g style.o sentence.o misc.o \<br>&nbsp;&nbsp;&nbsp;&nbsp;getopt.o getopt1.o -lm<br>root@kvmubuntu:~# ls -l diction getopt.c<br>&nbsp;&nbsp;-rwxrwxr-x 1 s s 68128 Jan  3 21:24 diction<br>&nbsp;&nbsp;-rw-r--r-- 1 s s 33125 Jan  3 21:24 getopt.c<br><strong>Task:</strong><br>Установка программ<br>Старательно упакованный исходный код часто включает специальную цель для make , которая называется install (установить). Эта цель выполняет установку готового программного продукта в системный каталог. Обычно это каталог /usr/local/bin, традиционное место для установки программного обеспечения, собранного в локальной системе. Однако этот каталог, как правило, недоступен рядовым пользователям для записи, поэтому, чтобы выполнить установку, вам потребуются привилегии суперпользователя. После установки проверим готовность программы к использованию<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# sudo make install<br>root@kvmubuntu:~# which diction<br>&nbsp;&nbsp;/usr/local/bin/diction<br><strong>Task:</strong><br>Исследуем Wi-Fi в канальном уровне.<br>Для исследования сетей Wi-Fi под винду можно использовать inSSIDer, а под линукс linssid. При этом должно быть соединение через wifi, а не роутер<br># Администрирование локальных сетей.<br><strong>Decision:</strong><br>root@kvmubuntu:~# apt update<br>root@kvmubuntu:~# apt install linssid<br>root@kvmubuntu:~# linssid<br>В  средней части программы - таблица с характеристиками сетей wifi, которая действует в зоне моего компьютера. В нижней части графическое представление использования спектра wifi в 2х диапазонах 2.4 Ггц и 5 ГГц.<br>Наш компьютер подключен к точке доступа domru, Сеть работает на 2ом канале и в графике мы увидим, что наша сеть работает во втором канале, Показан мак адрес.<br>В графике также увидим,что так как каналы пересекаются друг с другом (смотрим на нашу сеть), то наша сеть передает данные не только на 2 ом канале, но еще и на 1, 3, 4, 5, 6 каналах, хотя уровень на этих сигналах горадо ниже чем на 2ом.<br>На втором канале также работают еще три другие сети. Лучше выбрать такой канал, где нет сетей с высоким уровнем сигнала, например,7. Давайте сделаем это в настройках роутера. Сейчас у нас стоит автоматический выбор канала. Это лучший выбор, потому что сети могут появляться и исчезать. Если выберете конкретный канал, то появится сеть через некоторое время имменно на этом канале<br>с высоким уровнем сигнала и сеть перестанет работать.<br>То есть выбираем канал, в нашем случае 7, сохраняем настройки и перезапускаем нашу сеть в панеле на рабочем столе. В https://www.speedtest.net/ можно проверить скорость интернета.<br><strong>Source:</strong><br># https://www.asozykin.ru/courses/networks_online<br><strong>Task:</strong><br>Проанализируйте существующие поддомены основного домена компании cyber-ed.ru. Выявите домен, который похож на название домена для задания, и изучите его DNS TXT записи.<br>В качестве подтверждения успешной эксплуатации предоставьте флаг (секретную строку в формате 32 букв и цифр несвязного текста) из DNS записи типа TXT (Чтобы получить TXT записи для домена, выполните команду nslookup -q=TXT domain.name).<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# google-chrome https://crt.sh/?q=cyber-ed.ru<br>root@kvmubuntu:~# nslookup -q=TXT task.cyber-ed.ru<br>Server:   tip.1<br>Address: tip.1#53<br>Non-authoritative answer:<br>task.cyber-ed.ru text = "FLAG=ОТВЕТ"<br>Authoritative answers can be found from<br><strong>Task:</strong><br>Сборка Nginx из исходного кода (Ubuntu 20.04)<br># Администрирование Веб-серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# apt-get update<br>root@kvmubuntu:~# apt-get -y install build-essential<br>root@kvmubuntu:~# wget https://nginx.org/download/nginx-1.21.1.tar.gz<br>root@kvmubuntu:~# tar -zxvf nginx-1.21.1.tar.gz<br>root@kvmubuntu:~# cd nginx-1.21.1/&nbsp;&nbsp; <br>root@kvmubuntu:~# apt-get install libpcre3 libpcre3-dev libpcrecpp0v5 libssl-dev zlib1g-dev<br>root@kvmubuntu:~# ls -l<br>  total 812<br>  -rw-r--r-- 1 ubuntu ubuntu 313379 Jul  6 09:59 CHANGES<br>  -rw-r--r-- 1 ubuntu ubuntu 478586 Jul  6 09:59 CHANGES.ru<br>  -rw-r--r-- 1 ubuntu ubuntu   1397 Jul  6 09:59 Li-cENSE<br>  -rw-r--r-- 1 ubuntu ubuntu&nbsp;&nbsp; 49 Jul  6 09:59 README<br>  drwxr-xr-x 6 ubuntu ubuntu   4096 Jul 31 03:28 auto<br>  drwxr-xr-x 2 ubuntu ubuntu   4096 Jul 31 03:28 conf<br>  -rwxr-xr-x 1 ubuntu ubuntu   2590 Jul  6 09:59 configure<br>  drwxr-xr-x 4 ubuntu ubuntu   4096 Jul 31 03:28 contrib<br>  drwxr-xr-x 2 ubuntu ubuntu   4096 Jul 31 03:28 html<br>  drwxr-xr-x 2 ubuntu ubuntu   4096 Jul 31 03:28 man<br>  drwxr-xr-x 9 ubuntu ubuntu   4096 Jul 31 03:28 src<br>root@kvmubuntu:~# ./configure --sbin-path=/usr/bin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --with-debug --with-pcre --with-http_ssl_module<br>root@kvmubuntu:~# make<br>root@kvmubuntu:~# make install<br>root@kvmubuntu:~# ls -l /etc/nginx/<br>  total 68<br>  -rw-r--r-- 1 root root 1077 Jul 31 03:50 fastcgi.conf<br>  -rw-r--r-- 1 root root 1077 Jul 31 03:50 fastcgi.conf.default<br>  -rw-r--r-- 1 root root 1007 Jul 31 03:50 fastcgi_params<br>  -rw-r--r-- 1 root root 1007 Jul 31 03:50 fastcgi_params.default<br>  -rw-r--r-- 1 root root 2837 Jul 31 03:50 koi-utf<br>  -rw-r--r-- 1 root root 2223 Jul 31 03:50 koi-win<br>  -rw-r--r-- 1 root root 5290 Jul 31 03:50 mime.types<br>  -rw-r--r-- 1 root root 5290 Jul 31 03:50 mime.types.default<br>  -rw-r--r-- 1 root root 2656 Jul 31 03:50 nginx.conf<br>  -rw-r--r-- 1 root root 2656 Jul 31 03:50 nginx.conf.default<br>  -rw-r--r-- 1 root root  636 Jul 31 03:50 scgi_params<br>  -rw-r--r-- 1 root root  636 Jul 31 03:50 scgi_params.default<br>  -rw-r--r-- 1 root root  664 Jul 31 03:50 uwsgi_params<br>  -rw-r--r-- 1 root root  664 Jul 31 03:50 uwsgi_params.default<br>  -rw-r--r-- 1 root root 3610 Jul 31 03:50 win-utf<br>root@kvmubuntu:~# nginx<br>  nginx: [alert] could not open error log file: open() "/var/log/nginx/error.log" failed (13: Per-tission denied)<br>  2021/07/31 03:52:04 [emerg] 6512#0: mkdir() "/usr/local/nginx/client_body_temp" failed (13: Per-tission denied)<br>root@kvmubuntu:~# nginx<br>root@kvmubuntu:~# ifconfig<br>  enp0s3: flags=4163&lt;UP,BROADCAST,RUNNING,MULTi-cAST&gt;  mtu 1500<br>&nbsp;&nbsp;&nbsp;&nbsp;  inet tipubuntu<br>- Web - tipubuntu/<br><strong>Source:</strong><br># https://www.asozykin.ru/courses/sql<br><strong>Task:</strong><br>Установка веб сервера с помощью Nginx, Php-fpm, PhpMyAdmin, Vsftpd<br>- После установки в целях безопасности отключим cgi.fix_pathinfo. В файле /etc/php/7.2/fpm/php.ini<br>- Дальше посмотрим, сколько ядер имеется в нашей системе. И укажем это количество в качестве параметра worker_processes в файле /etc/nginx/nginx.conf<br>- Далее создадим папку для нашего сайта и в этой папке создадим файлик index.php.<br>- Далее поставим mariadb. Опять добавляем необходимый репозиторий, обновляем список пакетов и устанавливаем mariadb-server и mariadb-client<br>- В Ubuntu 18.04 вы можете столкнуться с ситуацией, что после установки mariadb прекрасно работает, но после перезагрузки сервера, внезапно перестает запускаться – очень долго думает, но не запускается. Наиболее вероятная причина подобного поведения – app ar-tor. Что бы его отключить для mariadb необходимо выполнить<br>- Теперь, давайте поставим phpMyAdmin, что бы упростить обслуживание баз данных. Ссылку на последнюю версию phpMyAdmin вы можете найти на сайте www.phpmyadmin.net.<br>- Скачаем архив, разарзхивируем его, создадим папку в папке с нашим сайтом и перенесем туда файлы.<br>- Теперь необходимо поставить ftp сервер. Если мы будем делать ftp сервер, с реальными пользователями, то будут проблемы с правами и владельцами файлов. Самый простой способ этого избежать – использовать виртуальных пользователей. Т.е. мы будем подключаться под пользователем vasya, но система будет считать, что работает пользователь www-data. Сегодня покажу, как такое сделать в vsftpd.Ставим vsftp и db-util. Обратите внимание, что на момент написания статьи актуальной версией является db5.3-util. Когда вы будете это читать, версия может быть другой. Нужно ставить актуальную версию.<br>- Отредактируем файл, тут первая строчка – имя пользователя, вторая – пароль, дальше по аналогии можно добавить несколько пользователей – сперва имя, ниже пароль.<br>- Захешируем наш файл и отредактируем разрешения на полученный<br>- Тут стоит обратить внимание на следующие параметры:<br>local_root=/var/www/ — коревая папка, куда будут попадать пользователя, после подключения к серверу.<br>guest_username=www-data – имя реального пользователя, который будет виден системе, от его имени будут происходить все операции с файлами.<br>root@kvmubuntu:~#pasv_address=1.2.3.4 – если у вас сервер за NAT, то тут нужно указать реальный, внешний адрес.<br>– создадим конфиг для pam.d, что бы наши виртуальные пользователи могли подключаться:<br># Администрирование Веб-серверов.<br><strong>Decision:</strong><br>В качестве веб сервера будет выступать Nginx с PHP-FPM, в качестве СУБД – MariaDB, в качестве ftp сервера – vsftpd настроенный на использование виртуальных пользователей, чтобы избежать проблем с правами и владельцами файлов при загрузке. А также поставим PHPMyAdmin<br>root@kvmubuntu:~# su<br>root@kvmubuntu:~# apt update<br>root@kvmubuntu:~# apt upgrade<br>root@kvmubuntu:~# add-apt-repository ppa:ondrej/php<br>root@kvmubuntu:~# add-apt-repository ppa:nginx/stable<br>root@kvmubuntu:~# apt update<br>root@kvmubuntu:~# apt install nginx<br>root@kvmubuntu:~# apt install php7.2-cli php7.2-fpm php7.2-curl php7.2-gd php7.2-mysql php7.2-mbstring zip unzip<br>root@kvmubuntu:~# vim /etc/php/7.2/fpm/php.ini<br>;cgi.fix_pathinfo=1<br>и меняем ее на<br>cgi.fix_pathinfo=0<br>root@kvmubuntu:~# mv /etc/nginx/sites-available/default ~/<br>root@kvmubuntu:~# vim /etc/nginx/sites-available/default<br>&nbsp;&nbsp;server {<br>&nbsp;&nbsp;&nbsp;&nbsp;listen   80;<br>&nbsp;&nbsp;&nbsp;&nbsp;root /var/www/default;<br>&nbsp;&nbsp;&nbsp;&nbsp;index index.php index.html index.htm;<br>&nbsp;&nbsp;&nbsp;&nbsp;server_name  example.com www.example.com;<br>&nbsp;&nbsp;&nbsp;&nbsp;location / {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try_files $uri $uri/ /index.html;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;error_page 404 /404.html;<br>&nbsp;&nbsp;&nbsp;&nbsp;error_page 500 502 503 504 /50x.html;<br>&nbsp;&nbsp;&nbsp;&nbsp;location = /50x.html {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  root /usr/share/nginx/www;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;location ~ .php$ {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try_files $uri =404;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fastcgi_pass unix:/var/run/php/php7.2-fpm.sock;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fastcgi_index index.php;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include fastcgi_params;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;}<br>root@kvmubuntu:~# cat /proc/cpuinfo | grep processor | wc -l<br>2<br>root@kvmubuntu:~# vim /etc/nginx/nginx.conf<br>worker_processes 2;<br>root@kvmubuntu:~# mkdir /var/www/default<br>root@kvmubuntu:~# chown -R www-data:www-data /var/www<br>root@kvmubuntu:~# /etc/init.d/nginx restart<br>[ ok ] Restarting nginx (via systemctl): nginx.servi-ce.<br>root@kvmubuntu:~# /etc/init.d/php7.2-fpm restart<br>[ ok ] Restarting php7.2-fpm (via systemctl): php7.2-fpm.servi-ce.<br>root@kvmubuntu:~# ifconfig<br>enp0s8: flags=4163 mtu 1500<br>inet 192.168.0.51 netmask 255.255.255.0 broadcast 192.168.0.255<br>inet6 fe80::8e4a:9ec8:8bb7:dd53 prefixlen 64 scopeid 0x20<br>ether 08:00:27:2f:ca:92 txqueuelen 1000 (Ethernet)<br>RX packets 52059 bytes 57651545 (57.6 MB)<br>RX errors 0 dropped 0 overruns 0 frame 0<br>TX packets 41290 bytes 5027564 (5.0 MB)<br>TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0<br>lo: flags=73 mtu 65536<br>inet 127.0.0.1 netmask 255.0.0.0<br>inet6 ::1 prefixlen 128 scopeid 0x10<br>loop txqueuelen 1000 (Локальная петля (Loopback))<br>RX packets 3202 bytes 323497 (323.4 KB)<br>RX errors 0 dropped 0 overruns 0 frame 0<br>TX packets 3202 bytes 323497 (323.4 KB)<br>TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0<br>Web - 192.168.0.51<br>root@kvmubuntu:~# sudo apt-key adv —recv-keys —keyserver hkp://keyserver.ubuntu.com:80 0xF1656F24C74CD1D8<br>root@kvmubuntu:~# sudo add-apt-repository ‘deb [arch=amd64,ar-t64,ppc64el] http://mirror.timeweb.ru/mariadb/repo/10.3/ubuntu bioni-c main’<br>root@kvmubuntu:~# apt update<br>root@kvmubuntu:~# apt install mariadb-server mariadb-client<br>root@kvmubuntu:~# /etc/init.d/mysql restart<br>[ ok ] Restarting mysql (via systemctl): mysql.servi-ce.<br>root@kvmubuntu:~# mysql -u root -p<br>Enter password:<br>Welcome to the MariaDB monitor. Commands end with ; or \g.<br>Your MariaDB connection id is 37<br>Server version: 10.3.20-MariaDB-1:10.3.20+maria~bioni-c-log mariadb.org binary distribution<br>Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.<br>Type ‘help;’ or ‘\h’ for help. Type ‘\c’ to clear the current input statement.<br>MariaDB [(none)]&gt; q<br>-&gt; Ctrl-C — exit!<br>Aborted<br>root@kvmubuntu:~# apt install appar-tor-utils<br>root@kvmubuntu:~# aa-disable /usr/sbin/mysqld<br>root@kvmubuntu:~# cd /tmp<br>root@kvmubuntu:~# wget https://files.phpmyadmin.net/phpMyAdmin/4.9.2/phpMyAdmin-4.9.2-all-languages.zip<br>root@kvmubuntu:~# unzip phpMyAdmin-4.9.2-all-languages.zip<br>root@kvmubuntu:~# mkdir /var/www/default/phpmyadmin<br>root@kvmubuntu:~# mv phpMyAdmin-4.9.2-all-languages/* /var/www/default/phpmyadmin/<br>root@kvmubuntu:~# cp /var/www/default/phpmyadmin/config.sample.inc.php /var/www/default/phpmyadmin/config.inc.php<br>root@kvmubuntu:~# vim /var/www/default/phpmyadmin/config.inc.php<br>#cfg[‘blowfish_secret’] = ‘af897a09df0897adf’;<br>root@kvmubuntu:~# chown -R www-data:www-data /var/www/default/phpmyadmin<br>- Web - 192.168.0.51/phpmyadmin/index.php<br>root@kvmubuntu:~# apt install vsftpd db5.3-util<br>root@kvmubuntu:~# mkdir /etc/vsftpd<br>root@kvmubuntu:~# touch /etc/vsftpd/vsftpdusers<br>root@kvmubuntu:~# chmod 0600 /etc/vsftpd/vsftpdusers<br>root@kvmubuntu:~# db5.3_load -T -t hash -f /etc/vsftpd/vsftpdusers /etc/vsftpd/users.db<br>root@kvmubuntu:~# chmod 0600 /etc/vsftpd/users.db<br>root@kvmubuntu:~# mv /etc/vsftpd.conf ~/<br>root@kvmubuntu:~# vim /etc/vsftpd.conf<br>listen=YES<br>anonymous_enable=NO<br>local_enable=YES<br>xferlog_enable=YES<br>user_sub_token=$USER<br>local_root=/var/www/<br>chroot_local_user=YES<br>hide_ids=YES<br>guest_enable=YES<br>guest_username=www-data<br>virtual_use_local_privs=YES<br>write_enable=YES<br>pasv_enable=YES<br>#если сервер за натом — реальный адрес<br>#pasv_address=1.2.3.4<br>pasv_max_port=20200<br>pasv_min_port=20400<br>pam_servi-ce_name=vsftpd.virtual<br>rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem<br>rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key<br>ssl_enable=NO<br>connect_from_port_20=YES<br>xferlog_file=/var/log/vsftpd.log<br>xferlog_std_for-tat=YES<br>idle_session_timeout=600<br>data_connection_timeout=120<br>ascii_upload_enable=YES<br>ascii_download_enable=YES<br>allow_writeable_chroot=YES<br>seccomp_sandbox=NO<br>local_umask=022<br>root@kvmubuntu:~# vim /etc/pam.d/vsftpd.virtual<br>auth&nbsp;&nbsp;   required&nbsp;&nbsp; pam_userdb.so db=/etc/vsftpd/users<br>account&nbsp;&nbsp;required&nbsp;&nbsp; pam_userdb.so db=/etc/vsftpd/users<br>session&nbsp;&nbsp;required&nbsp;&nbsp; pam_loginuid.so<br>root@kvmubuntu:~# /etc/init.d/vsftpd restart<br>[ ok ] Restarting vsftpd (via systemctl): vsftpd.servi-ce.<br><strong>Task:</strong><br>Установить Node.js в Ubuntu для настройки Webpack<br>Установим npm<br>удалить эту версию node js, ее нужно деактивировать<br># Администрирование Веб-серверов.<br><strong>Decision:</strong><br>Заранее подготовим проект вебпак:<br>root@kvmubuntu:~# ls<br>  assets  package.json  package-lock.json  public  README.md  src  webpack<br>root@kvmubuntu:~# dpkg --get-selections | grep node<br>root@kvmubuntu:~# apt update -y<br>root@kvmubuntu:~# apt -y install build-essential checkinstall<br>root@kvmubuntu:~# apt install libssl-dev<br>root@kvmubuntu:~# wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.2/install.sh | bash<br>root@kvmubuntu:~# source /etc/profile<br>root@kvmubuntu:~# nvm ls-remote<br>&nbsp;&nbsp;&nbsp;&nbsp;v0.1.14<br>&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;v15.1.0<br>&nbsp;&nbsp;&nbsp;&nbsp;v15.2.0<br>&nbsp;&nbsp;&nbsp;&nbsp;v15.2.1<br>root@kvmubuntu:~# nvm install 14.0<br>  v14.0.0 is already installed.<br>  Now using node v14.0.0 (npm v6.14.4)<br>root@kvmubuntu:~# nvm list<br>  -&gt;&nbsp;&nbsp;  v14.0.0<br>  default -&gt; 14.0 (-&gt; v14.0.0)<br>  node -&gt; stable (-&gt; v14.0.0) (default)<br>  stable -&gt; 14.0 (-&gt; v14.0.0) (default)<br>  iojs -&gt; N/A (default)<br>  lts/* -&gt; lts/fermium (-&gt; N/A)<br>  lts/argon -&gt; v4.9.1 (-&gt; N/A)<br>  lts/boron -&gt; v6.17.1 (-&gt; N/A)<br>  lts/carbon -&gt; v8.17.0 (-&gt; N/A)<br>  lts/dubnium -&gt; v10.23.0 (-&gt; N/A)<br>  lts/erbium -&gt; v12.19.1 (-&gt; N/A)<br>  lts/fermium -&gt; v14.15.1 (-&gt; N/A)<br>root@kvmubuntu:~# nvm use 14.0<br>  Now using node v14.0.0 (npm v6.14.4)<br>root@kvmubuntu:~# node -v<br>  v14.0.0<br>root@kvmubuntu:~# npm -v<br>  6.14.4<br>root@kvmubuntu:~# npm i<br>root@kvmubuntu:~# npm audit fix<br>root@kvmubuntu:~# npm start<br>  ...<br>  ｢wdm｣: Compiled successfully.<br>- chrome - localhost<br>root@kvmubuntu:~# nvm deactivate 14.0<br>root@kvmubuntu:~# nvm uninstall 14.0<br><strong>Source:</strong><br># https://losst.ru/ustanovka-node-js-ubuntu-18-04<br><strong>Task:</strong><br>Установка браузера chrome для тестирования Веб-приложений.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb<br>root@kvmubuntu:~# dpkg -i --force-depends google-chrome-stable_current_amd64.deb<br>tuser@kvmubuntu:~$ google-chrome<br><strong>Source:</strong><br># https://askubuntu.com/questions/510056/how-to-install-google-chrome - How to install Google Chrome.<br><strong>Task:</strong><br>Настройка SELinux.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# apt install policycoreutils selinux-utils selinux-basics<br>root@kvmubuntu:~# sestatus<br>SELinux status: disabled<br>root@kvmubuntu:~# selinux-activate<br>root@kvmubuntu:~# cat /etc/selinux/config <br>...<br>SELINUX=permissive<br>SELINUXTYPE=default<br>SETLOCALDEFS=0<br>root@kvmubuntu:~# reboot<br>root@kvmubuntu:~# sestatus<br>...<br>SELinux status: enabled<br>Current mode: permissive<br>Mode from config file: permissive<br>root@kvmubuntu:~# setenforce 1<br>root@kvmubuntu:~# getenforce<br>Enforcing<br>root@kvmubuntu:~# touch /.autolabel<br>root@kvmubuntu:~# reboot<br><strong>Source:</strong><br># https://ruvds.com/ru/helpcenter/vvedenie-v-selinux-pod-ubuntu-20-04/ - Инсталляция SELinux.<br># https://losst.pro/nastrojka-selinux - Настройка SELinux.<br># https://www.dmosk.ru/miniinstruktions.php?mini=selinux-setting&ysclid=lvn75pdsk3201545540#settings-policies - Диагностика проблем.<br><strong>Task:</strong><br>Change SSH Port on CentOS or RHEL or Fedora With SELinux.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# semanage port -l | grep ssh<br>ssh_port_t tcp 22<br>root@kvmubuntu:~# vim /etc/ssh/sshd_config<br>root@kvmubuntu:~# cat /etc/ssh/sshd_config<br>...<br>#Port 22<br>Port 2233<br>root@kvmubuntu:~# semanage port -a -t ssh_port_t -p tcp 2233<br>root@kvmubuntu:~# semanage port -l | grep ssh<br>ssh_port_t tcp 2233, 22<br>root@kvmubuntu:~# ufw allow 2233<br>root@kvmubuntu:~# systemctl restart sshd<br>root@kvmubuntu:~# netstat -tunl | grep 2233<br>tcp 0 0 0.0.0.0:2233 0.0.0.0:* LISTEN <br>tcp6 0 0 :::2233 :::* LISTEN<br>root@kvmubuntu:~# exit <br>root@aw:/# ssh -X tuser@tipubuntu<br>ssh: connect to host tipubuntu port 22: Connection refused<br>root@aw:/# ssh -Xp 2233 tuser@tipubuntu<br><strong>Source:</strong><br># https://computingforgeeks.com/change-ssh-port-centos-rhel-fedora-with-selinux/ - Change SSH Port on CentOS or RHEL or Fedora With SELinux.<br><strong>Task:</strong><br>Sftp сервер.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# groupadd sftpgroup<br>root@kvmubuntu:~# useradd --no-create-home --gid sftpgroup sftptuser<br>root@kvmubuntu:~# passwd sftptuser<br>root@kvmubuntu:~# mkdir /srv/sftp<br>root@kvmubuntu:~# chown root:root /srv/sftp<br>root@kvmubuntu:~# chmod 755 /srv/sftp<br>root@kvmubuntu:~# mkdir /srv/sftp/sftptuser<br>root@kvmubuntu:~# chown sftptuser:sftpgroup /srv/sftp/sftptuser<br>root@kvmubuntu:~# vim /etc/ssh/sshd_config<br>root@kvmubuntu:~# cat /etc/ssh/sshd_config<br>...<br>#Subsystem sftp /usr/lib/openssh/sftp-server<br># использовать встроенный sftp-сервер<br>Subsystem sftp internal-sftp<br>...<br># только для пользователей группы sftpgroup<br>Match Group sftpgroup<br># только работа с файлами, запрет shell<br>ForceCommand internal-sftp<br># разрешить аутентификацию по паролю<br>PasswordAuthentication yes<br># разрешить доступ только к /srv/sftp<br>ChrootDirectory /srv/sftp<br># запретить все, что не нужно для работы<br>PermitTunnel no<br>AllowAgentForwarding no<br>AllowTcpForwarding no<br>X11Forwarding no<br>root@kvmubuntu:~# systemctl restart sshd.service<br>root@kvmubuntu:~# touch /srv/sftp/sftptuser/test.txt<br>root@kvmubuntu:~# exit<br>root@aw:/# sftp -P 2233 sftptuser@tipubuntu<br>sftp&gt; ls<br>sftptuser <br>sftp&gt; lls mnt/<br>requirements.txt dato138it<br>sftp&gt; cd sftptuser/<br>sftp&gt; get test.txt<br>sftp&gt; put -r mnt/dato138it<br>sftp&gt; exit<br>root@aw:/# ls test.txt<br>test.txt<br>sftp&gt; exit<br><strong>Source:</strong><br># https://tokmakov.msk.ru/blog/item/484?ysclid=lvlnz4iz7m313316662 - Настройка SFTP-сервера.<br><strong>Task:</strong><br>Install and Use Rkhunter for Security.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# apt install rkhunter<br>root@kvmubuntu:~# vim /etc/rkhunter.conf<br>root@kvmubuntu:~# cat /etc/rkhunter.conf<br>...<br>#WEB_CMD="/bin/false"<br>UPDATE_MIRRORS=1<br>MIRRORS_MODE=0<br>root@kvmubuntu:~# rkhunter -C<br>root@kvmubuntu:~# rkhunter --update<br>[ Rootkit Hunter version 1.4.6 ]<br>Checking rkhunter data files...<br>Checking file mirrors.dat [ No update ]<br>Checking file programs_bad.dat [ No update ]<br>Checking file backdoorports.dat [ No update ]<br>Checking file suspscan.dat [ No update ]<br>Checking file i18n/cn [ Skipped ]<br>Checking file i18n/de [ Skipped ]<br>Checking file i18n/en [ No update ]<br>Checking file i18n/tr [ Skipped ]<br>Checking file i18n/tr.utf8 [ Skipped ]<br>Checking file i18n/zh [ Skipped ]<br>Checking file i18n/zh.utf8 [ Skipped ]<br>Checking file i18n/ja [ Skipped ]<br>root@kvmubuntu:~# rkhunter --propupd<br>root@kvmubuntu:~# vim /etc/cron.daily/rkhunter.sh<br>root@kvmubuntu:~# cat /etc/cron.daily/rkhunter.sh<br>#!/bin/sh<br>(<br>/usr/local/bin/rkhunter --versioncheck<br>/usr/local/bin/rkhunter --update<br>/usr/local/bin/rkhunter --cronjob --report-warnings-only<br>) | /bin/mail -s 'rkhunter Daily Run (tipubuntu)' tmail38@mail.ru<br>root@kvmubuntu:~# chmod 755 /etc/cron.daily/rkhunter.sh<br>root@kvmubuntu:~# rkhunter --list rootkits<br>root@kvmubuntu:~# rkhunter --check<br>root@kvmubuntu:~# cat /var/log/rkhunter.log | grep hidden<br>root@kvmubuntu:~# cat /var/log/rkhunter.log | grep -A5 "\[ Warning \]"<br><strong>Source:</strong><br># https://losst.pro/proverka-linux-na-virusy?ysclid=lv2diq667c645946178#poisk-virusov-s-pomoshchyu-rkhunter - Поиск вирусов с помощью RkHunter<br># https://vegastack.com/tutorials/how-to-install-and-use-rkhunter-for-security-on-ubuntu-22-04/ - Install and Use Rkhunter for Security<br># https://linux-notes.org/poisk-rutkitov-v-debian-ubuntu-linux-mint-i-red-hat-centos-fedora/?ysclid=lob3rn9gk6547904603<br># https://winitpro.ru/index.php/2020/04/21/planirovshhik-zadach-cron-v-linux/<br><strong>Task:</strong><br>Установка IDS.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# apt install tripwire<br>root@kvmubuntu:~# tripwire --init<br>...<br>### Warning: File system error.<br>### Filename: /proc/pci<br>### Нет такого файла или каталога<br>### Continuing...<br>...<br>root@kvmubuntu:~# vim /etc/tripwire/twpol.txt<br>root@kvmubuntu:~# cat /etc/tripwire/twpol.txt<br>...<br>{<br>  #/var/lock   -&gt; $(SEC_CONFIG) ;<br>  #/var/run   -&gt; $(SEC_CONFIG) ; # daemon PIDs<br>  /var/log&nbsp;&nbsp;-&gt; $(SEC_CONFIG) ;<br>}<br>...<br>{<br>  /root&nbsp;&nbsp;   -&gt; $(SEC_CRIT) ; # Catch all additions to /root<br>  #/root/mail&nbsp;&nbsp; -&gt; $(SEC_CONFIG) ;<br>  #/root/Mail&nbsp;&nbsp; -&gt; $(SEC_CONFIG) ;<br>  #/root/.xsession-errors   -&gt; $(SEC_CONFIG) ;<br>  #/root/.xauth&nbsp;&nbsp; -&gt; $(SEC_CONFIG) ;<br>  #/root/.tcshrc&nbsp;&nbsp; -&gt; $(SEC_CONFIG) ;<br>  #/root/.sawfish&nbsp;&nbsp; -&gt; $(SEC_CONFIG) ;<br>  #/root/.pinerc&nbsp;&nbsp; -&gt; $(SEC_CONFIG) ;<br>  #/root/.mc&nbsp;&nbsp; -&gt; $(SEC_CONFIG) ;<br>  #/root/.gnome_private   -&gt; $(SEC_CONFIG) ;<br>  #/root/.gnome-desktop   -&gt; $(SEC_CONFIG) ;<br>  #/root/.gnome&nbsp;&nbsp; -&gt; $(SEC_CONFIG) ;<br>  #/root/.esd_auth&nbsp;&nbsp;  -&gt; $(SEC_CONFIG) ;<br>  #/root/.elm&nbsp;&nbsp; -&gt; $(SEC_CONFIG) ;<br>  #/root/.cshrc&nbsp;&nbsp; -&gt; $(SEC_CONFIG) ;<br>  /root/.bashrc&nbsp;&nbsp; -&gt; $(SEC_CONFIG) ;<br>  #/root/.bash_profile   -&gt; $(SEC_CONFIG) ;<br>  #/root/.bash_logout   -&gt; $(SEC_CONFIG) ;<br>  /root/.bash_history   -&gt; $(SEC_CONFIG) ;<br>  #/root/.amandahosts   -&gt; $(SEC_CONFIG) ;<br>  #/root/.addressbook.lu   -&gt; $(SEC_CONFIG) ;<br>  #/root/.addressbook   -&gt; $(SEC_CONFIG) ;<br>  #/root/.Xresources   -&gt; $(SEC_CONFIG) ;<br>  #/root/.Xauthority   -&gt; $(SEC_CONFIG) -i ; # Changes Inode number on login<br>  #/root/.ICEauthority&nbsp;&nbsp;-&gt; $(SEC_CONFIG) ;<br>}<br>...<br>{<br>  /dev   -&gt; $(Device) ;<br>  /dev/pts  -&gt; $(Device) ;<br>  #/proc   -&gt; $(Device) ;<br>  /proc/devices -&gt; $(Device) ;<br>  /proc/net -&gt; $(Device) ;<br>  /proc/tty -&gt; $(Device) ;<br>  /proc/sys -&gt; $(Device) ;<br>  /proc/cpuinfo -&gt; $(Device) ;<br>  /proc/modules -&gt; $(Device) ;<br>  /proc/mounts -&gt; $(Device) ;<br>  /proc/dma -&gt; $(Device) ;<br>  /proc/filesystems -&gt; $(Device) ;<br>  /proc/interrupts  -&gt; $(Device) ;<br>  /proc/ioports -&gt; $(Device) ;<br>  /proc/scsi -&gt; $(Device) ;<br>  /proc/kcore -&gt; $(Device) ;<br>  /proc/self -&gt; $(Device) ;<br>  /proc/kmsg -&gt; $(Device) ;<br>  /proc/stat -&gt; $(Device) ;<br>  /proc/loadavg -&gt; $(Device) ;<br>  /proc/uptime -&gt; $(Device) ;<br>  /proc/locks -&gt; $(Device) ;<br>  /proc/meminfo -&gt; $(Device) ;<br>  /proc/misc -&gt; $(Device) ;<br>}<br>...<br>root@kvmubuntu:~# twadmin -m P /etc/tripwire/twpol.txt<br>root@kvmubuntu:~# tripwire --init<br>root@kvmubuntu:~# tripwire --check<br>...<br>Wrote report file: /var/lib/tripwire/report/kvmubuntu-20240817-222433.twr<br>...<br>Report generated by:   root<br>Report created on:   Sat 17 Aug 2024 10:24:33 PM EDT<br>Database last updated on: Never<br>===============================================================================<br>Report Summary:<br>===============================================================================<br>Host name:&nbsp;&nbsp; kvmubuntu<br>Host IP address:   127.0.1.1<br>Host ID:&nbsp;&nbsp; None<br>Policy file used:   /etc/tripwire/tw.pol<br>Configuration file used: /etc/tripwire/tw.cfg<br>Database file used:   /var/lib/tripwire/kvmubuntu.twd<br>Command line used:   tripwire --check<br>===============================================================================<br>Rule Summary:<br>===============================================================================<br>...<br>Rule Name&nbsp;&nbsp; Severity Level Added Removed Modified<br>---------&nbsp;&nbsp; -------------- ----- ------- --------<br>Other binaries&nbsp;&nbsp; 66&nbsp;&nbsp;0  0  0<br>Tripwire Binaries   100   0  0  0<br>Other libraries&nbsp;&nbsp; 66&nbsp;&nbsp;0  0  0<br>Root file-system executables 100   0  0  0<br>Tripwire Data Files   100   0  0  0<br>System boot changes   100   0  0  0<br>(/var/log)<br>Root file-system libraries 100   0  0  0<br>(/lib)<br>Critical system boot files 100   0  0  0<br>Other configuration files 66&nbsp;&nbsp;0  0  0<br>(/etc)<br>Boot Scripts&nbsp;&nbsp; 100   0  0  0<br>Security Control&nbsp;&nbsp;66&nbsp;&nbsp;0  0  0<br>Root config files   100   0  0  0<br>Devices & Kernel information 100   0  0  0<br>Invariant Directories   66&nbsp;&nbsp;0  0  0<br>...<br>===============================================================================<br>Object Summary:<br>===============================================================================<br>...<br>No violations.<br>===============================================================================<br>Error Report:<br>===============================================================================<br>No Errors<br>...<br>root@kvmubuntu:~# apt install mailutils<br>root@kvmubuntu:~# dpkg-reconfigure postfix<br>...<br>1. No configuration 2. Internet Site 3. Internet with smarthost 4. Satellite system 5. Local only<br>General mail configuration type: 2<br>...<br>System mail name: tmail38@mail.ru<br>...<br>Recipient for root and postmaster mail: tuser<br>...<br>Other destinations to accept mail for (blank for none): mail.ru<br>...<br>Force synchronous updates on mail queue? [yes/no] yes<br>...<br>Local networks: tipubuntu<br>...<br>Mailbox size limit (bytes): <br>...<br>Local address extension character: <br>all : use both IPv4 and IPv6 addresses;<br>ipv6: listen only on IPv6 addresses;<br>ipv4: listen only on IPv4 addresses.<br>1. all 2. ipv6 3. ipv4<br>...<br>Internet protocols to use: 1<br>root@kvmubuntu:~# systemctl reload postfix<br>root@kvmubuntu:~# tripwire --check | mail -s "Tripwire report for `uname -n`" tmail38@mail.ru<br><strong>Source:</strong><br># https://stackoverflow.com/questions/12867573/searching-from-end-of-file-using-vim - Базовый поиск.<br># https://www.8host.com/blog/ispolzovanie-tripwire-dlya-obnaruzheniya-vtorzhenij-na-server-ubuntu/ - ИСПОЛЬЗОВАНИЕ TRIPWIRE ДЛЯ ОБНАРУЖЕНИЯ ВТОРЖЕНИЙ НА СЕРВЕР UBUNTU.<br># https://computingforgeeks.com/install-and-configure-tripwire-on-ubuntu/ - Install and Configure Tripwire on Ubuntu 22.04|20.04|18.04.<br><strong>Task:</strong><br>Использование fail2ban.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# apt install fail2ban<br>root@kvmubuntu:~# systemctl enable fail2ban --now<br>root@kvmubuntu:~# faillog -a | grep tuser<br>tuser   0  0 12/31/69 19:00:00 -0500<br>sftptuser 0  0 12/31/69 19:00:00 -0500<br><strong>Task:</strong><br>Настройка ядра.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# vim /etc/sysctl.conf<br>root@kvmubuntu:~# cat /etc/sysctl.conf<br>...<br>net.ipv4.conf.all.rp_filter=1<br>net.ipv4.conf.all.accept_source_route = 0<br>net.ipv4.conf.all.log_martians = 1<br>kernel.randomize_va_space=1<br>net.ipv4.icmp_echo_ignore_broadcasts=1<br>net.ipv4.conf.all.log_martians = 1<br>root@kvmubuntu:~# sysctl -p /etc/sysctl.conf<br>net.ipv4.conf.all.rp_filter = 1<br>net.ipv4.conf.all.accept_source_route = 0<br>net.ipv4.conf.all.log_martians = 1<br>kernel.randomize_va_space = 1<br>net.ipv4.icmp_echo_ignore_broadcasts = 1<br>net.ipv4.conf.all.log_martians = 1<br><strong>Task:</strong> <br>Программы с SUID и SGID битами.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# find / \( -perm -4000 -o -perm -2000 \) -print<br><strong>Source:</strong><br># https://unix.stackexchange.com/questions/180867/how-to-search-for-all-suid-sgid-files - How to search for all SUID/SGID files?<br><strong>Task:</strong><br>Общедоступные файлы.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# find / -xdev -type d \( -perm -0002 -a ! -perm -1000 \) -print<br>root@kvmubuntu:~# find / -xdev \( -nouser -o -nogroup \) -print<br><strong>Task:</strong><br>Логирование и аудит.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# apt install logwatch<br>General mail configuration type: 1<br>root@kvmubuntu:~# cp /usr/share/logwatch/default.conf/logwatch.conf /etc/logwatch/conf/<br>root@kvmubuntu:~# vim /etc/logwatch/conf/logwatch.conf<br>root@kvmubuntu:~# cat /etc/logwatch/conf/logwatch.conf | grep Output<br>...<br>#Output = stdout<br>Output = mail<br>root@kvmubuntu:~# cat /etc/logwatch/conf/logwatch.conf | grep MailTo<br>#MailTo = root<br>MailTo = tmail38@mail.ru<br>root@kvmubuntu:~# cat /etc/logwatch/conf/logwatch.conf | grep LogDir<br>LogDir = /var/log<br>root@kvmubuntu:~# apt install postfix<br>root@kvmubuntu:~# logwatch --detail Low --range today<br>root@kvmubuntu:~# vim /etc/cron.daily/00logwatch<br>root@kvmubuntu:~# cat /etc/cron.daily/00logwatch | grep /usr/sbin/logwatch<br>#/usr/sbin/logwatch --output mail<br>/usr/sbin/logwatch --output mail --mailto tmail38@mail.ru --detail high<br>root@kvmubuntu:~# apt install logcheck<br>root@kvmubuntu:~# vim /etc/aliases<br>root@kvmubuntu:~# cat /etc/aliases<br>postmaster: tmail38@mail.ru<br>logcheck: tuser<br>root@kvmubuntu:~# vim /etc/logcheck/logcheck.conf<br>root@kvmubuntu:~# cat /etc/logcheck/logcheck.conf<br>...<br>INTRO=1<br>REPORTLEVEL="kvmubuntu"<br>SENDMAILTO="tmail38@mail.ru"<br>ADDTAG="yes"<br>root@kvmubuntu:~# ls /etc/logcheck/<br>cracking.d ignore.d.paranoid logcheck.conf violations.d<br>cracking.ignore.d ignore.d.server logcheck.logfiles violations.ignore.d<br>header.txt ignore.d.workstation logcheck.logfiles.d<br>root@kvmubuntu:~# vim /etc/logcheck/ignore.d.server/local-rules<br>root@kvmubuntu:~# cat /etc/logcheck/ignore.d.server/local-rules<br>^\w{3} [ :[:digit:]]{11} [._[:alnum:]-]+ sshd\[[[:digit:]]+\]: Disconnected from (user [^[:space:]]+ )?[[:xdigit:]:.]+ port [[:digit:]]+?( \[preauth\])?$<br>^\w{3} [ :[:digit:]]{11} [._[:alnum:]-]+ sshd\[[[:digit:]]+\]: user cronuser login class \[preauth\]$<br>root@kvmubuntu:~# egrep -f /etc/logcheck/ignore.d.server/local-rules /var/log/syslog<br>root@kvmubuntu:~# su -s /bin/bash -c "/usr/sbin/logcheck" logcheck<br><strong>Source:</strong><br># https://ubuntu.com/server/docs/how-to-install-and-configure-logwatch - Настроить logwatch.<br># https://habr.com/ru/companies/rootwelt/articles/303462/ - Logwatch.<br># http://snakeproject.ru/rubric/article.php?art=logcheck_15.04.2019 - Настроить logcheck.<br><strong>Task:</strong><br>Настройка брандмауэра.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# vim /etc/ufw/sysctl.conf<br>root@kvmubuntu:~# cat /etc/ufw/sysctl.conf | grep ip_forward=1<br>...<br>#net/ipv4/ip_forward=1<br>net/ipv4/ip_forward=1<br>root@kvmubuntu:~# vim /etc/ufw/before.rules<br>root@kvmubuntu:~# cat /etc/ufw/before.rules<br>...<br>*nat<br>:PREROUTING ACCEPT [0:0]<br>-A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8033<br>COMMIT<br>root@kvmubuntu:~# ufw enable<br>root@kvmubuntu:~# ufw allow 8033/tcp<br>Rule added<br>Rule added (v6)<br>root@kvmubuntu:~# systemctl restart ufw<br>root@kvmubuntu:~# ufw status numbered<br>...<br>[ 1] 8033 ALLOW IN Anywhere<br>[ 2] 2233/tcp ALLOW IN tipubuntu.1<br>[ 3] 2233/tcp ALLOW IN tipubuntu<br>[ 4] 2233 ALLOW IN Anywhere<br>[ 5] 2233 (v6) ALLOW IN Anywhere (v6)<br>root@kvmubuntu:~# ufw delete 3<br>root@kvmubuntu:~# ufw delete 2<br>root@kvmubuntu:~# systemctl restart ufw<br>root@kvmubuntu:~# vim firewall.sh<br>root@kvmubuntu:~# cat firewall.sh<br>#!/bin/bash<br>IPT="/sbin/iptables"<br># Очищаем правила и удаляем цепочки.<br>$IPT -F<br>$IPT -X<br># По умолчанию доступ запрещен.<br>$IPT -P INPUT DROP<br>$IPT -P FORWARD DROP<br>$IPT -P OUTPUT DROP<br># Список разрешенных TCP и UDP портов.<br>TCP_PORTS="2233,8033"<br># Разрешаем пакеты для интерфейса обратной петли.<br>$IPT -A INPUT -i lo -j ACCEPT<br>$IPT -A OUTPUT -o lo -j ACCEPT<br># Разрешаем пакеты для установленных соединений.<br>$IPT -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT<br># Разрешаем исходящие соединения.<br>$IPT -A OUTPUT -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT<br># Разрешаем доступ к портам, описанным в переменных TCP_PORTS.<br>$IPT -A INPUT -p tcp -m multiport --dport $TCP_PORTS -j ACCEPT<br># Разрешаем исходящий ping.<br>$IPT -A INPUT -p icmp -m icmp --icmp-type echo-reply -j ACCEPT<br>root@kvmubuntu:~# ./firewall.sh<br>root@kvmubuntu:~# iptables -L<br>Chain INPUT (policy DROP)<br>target prot opt source destination<br>ACCEPT all -- anywhere anywhere<br>ACCEPT all -- anywhere anywhere state RELATED,ESTABLISHED<br>ACCEPT tcp -- anywhere anywhere multiport dports 2233,8033<br>ACCEPT icmp -- anywhere anywhere icmp echo-reply<br>Chain FORWARD (policy DROP)<br>target prot opt source destination<br>Chain OUTPUT (policy DROP)<br>target prot opt source destination<br>ACCEPT all -- anywhere anywhere<br>ACCEPT all -- anywhere anywhere state NEW,RELATED,ESTABLISHED<br>root@kvmubuntu:~# /sbin/iptables -A INPUT -p tcp --dport 5432 -j ACCEPT<br>root@kvmubuntu:~# iptables -t nat -A PREROUTING -i enp1s0 -p tcp --dport 80 -m conntrack --ctstate NEW -j DNAT --to tipubuntu:8033<br>root@kvmubuntu:~# iptables -t nat -A PREROUTING -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT<br>root@kvmubuntu:~# iptables -A POSTROUTING -t nat -j MASQUERADE -o enp1s0<br>root@kvmubuntu:~# iptables-save &gt; /etc/iptables.rules<br>root@kvmubuntu:~# /sbin/iptables-save<br>root@kvmubuntu:~# reboot<br>root@kvmubuntu:~# iptables-restore &lt; /etc/iptables.rules<br>root@kvmubuntu:~# apt install iptables-persistent<br>root@kvmubuntu:~# netfilter-persistent save<br><strong>Source:</strong><br># https://serverspace.ru/support/help/osnovnye-komandy-ufw/?utm_source=yandex.ru&utm_medium=organic&utm_campaign=yandex.ru&utm_referrer=yandex.ru - Удалить правило брандмауэра.<br># https://serverfault.com/questions/411538/configure-ufw-to-redirect-http-traffic-to-another-ip - Configure ufw to redirect http traffic to another IP.<br># https://habr.com/ru/articles/747186/ - Вывод хоста в интернет.<br># https://www.dmosk.ru/instruktions.php?object=iptables-settings - Сохранение правил (permanent).<br><strong>Task:</strong><br>Установить vscode.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# wget https://vscode.download.prss.microsoft.com/dbazure/download/stable/903b1e9d8990623e3d7da1df3d33db3e42d80eda/code_1.86.2-1707854558_amd64.deb<br>root@kvmubuntu:~# apt install ./code_1.86.2-1707854558_amd64.deb<br><strong>Source:</strong><br># https://code.visualstudio.com/docs/setup/linux - Debian and Ubuntu based distributions.<br><strong>Task:</strong><br>Изменить порт Apache.<br># Администрирование Веб-серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# semanage port -l | grep -w http_port_t<br>http_port_t tcp 80, 443, 488, 8008, 8009, 8443, 8448<br>root@kvmubuntu:~# vim /etc/apache2/sites-enabled/dato138it.conf<br>root@kvmubuntu:~# cat /etc/apache2/sites-enabled/dato138it.conf<br>&lt;VirtualHost *:8033&gt;<br>...<br>root@kvmubuntu:~# vim /etc/apache2/ports.conf <br>root@kvmubuntu:~# cat /etc/apache2/ports.conf <br>...<br>Listen 8033<br>root@kvmubuntu:~# systemctl restart apache2<br>root@kvmubuntu:~# netstat -tlpn | grep apache<br>tcp6 0 0 :::8033 :::* LISTEN 2452/apache2 <br>root@kvmubuntu:~# semanage port -a -t http_port_t -p tcp 8033<br>root@kvmubuntu:~# semanage port -l | grep -w http_port_t<br>http_port_t tcp 8033, 80, 443, 488, 8008, 8009, 8443, 8448<br>root@kvmubuntu:~# ufw allow 8033<br>root@kvmubuntu:~# systemctl restart apache2<br>root@kvmubuntu:~# google-chrome http://tipubuntu:8033/<br>root@kvmubuntu:~# a2enconf phpmyadmin.conf<br>root@kvmubuntu:~# systemctl reload apache2<br>root@kvmubuntu:~# apt-get install php8.1-mbstring<br>root@kvmubuntu:~# cat /etc/php/8.1/apache2/php.ini | grep extension=<br>...<br>;extension=curl<br>;extension=ffi<br>...<br>root@kvmubuntu:~# vim /etc/php/8.1/apache2/php.ini<br>...<br>;extension=curl<br>extension=ctype<br>;extension=ffi<br>...<br>root@kvmubuntu:~# cat /etc/php/8.1/apache2/php.ini | grep extension=<br>root@kvmubuntu:~# service apache2 restart<br>root@kvmubuntu:~# google-chrome http://tipubuntu:8033/phpmyadmin/<br><strong>Source:</strong><br># https://losst.pro/kak-izmenit-port-apache?ysclid=lwgcvc9brc641723993 - Как изменить порт Apache.<br># https://linux-notes.org/nastrojka-selinux-dlya-apache-nginx-v-unix-linux/?ysclid=lwgc6svixb429450995 - Настройка SELinux для Apache/Nginx в Unix/Linux.<br><strong>Task:</strong><br>How to Install SELinux to Harden Apache Webserver.<br># Администрирование Веб-серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# mkdir /var/www/dato138it/cache<br>root@kvmubuntu:~# mkdir /var/www/dato138it/logs<br>root@kvmubuntu:~# tree /var/www/dato138it/<br>/var/www/dato138it/<br>├── cache<br>├── css<br>│ └── style.css<br>├── index.php<br>├── js<br>│ ├── jquery.js<br>│ └── main.js<br>└── logs<br>root@kvmubuntu:~# cd /var/www/<br>root@kvmubuntu:~# setenforce 0<br>root@kvmubuntu:~# semanage fcontext -a -t httpd_sys_content_t "/var/www/dato138it(/.*)?"<br>root@kvmubuntu:~# semanage fcontext -a -t httpd_log_t "/var/www/dato138it/logs(/.*)?"<br>root@kvmubuntu:~# semanage fcontext -a -t httpd_cache_t "/var/www/dato138it/cache(/.*)?"<br>root@kvmubuntu:~# semanage fcontext -a -t httpd_sys_rw_content_t "/var/www/dato138it/index.php"<br>root@kvmubuntu:~# restorecon -Rv /var/www/dato138it<br>Relabeled /var/www/dato138it/index.php from system_u:object_r:httpd_sys_content_t:s0 to system_u:object_r:httpd_sys_rw_content_t:s0<br>Relabeled /var/www/dato138it/cache from unconfined_u:object_r:httpd_sys_content_t:s0 to unconfined_u:object_r:httpd_cache_t:s0<br>Relabeled /var/www/dato138it/logs from unconfined_u:object_r:httpd_sys_content_t:s0 to unconfined_u:object_r:httpd_log_t:s0<br>root@kvmubuntu:~# ls -lZ /var/www/dato138it<br>total 24<br>drwxr-xr-x. 2 root root unconfined_u:object_r:httpd_cache_t:s0 4096 may 21 07:33 cache<br>drwxrwxr-x. 2 tuser tuser system_u:object_r:httpd_sys_content_t:s0 4096 mar 9 07:10 css<br>-rw-rw-r--. 1 tuser tuser system_u:object_r:httpd_sys_rw_content_t:s0 4180 abr 9 14:44 index.php<br>drwxrwxr-x. 2 tuser tuser system_u:object_r:httpd_sys_content_t:s0 4096 mar 9 07:10 js<br>drwxr-xr-x. 2 root root unconfined_u:object_r:httpd_log_t:s0 4096 may 21 07:33 logs<br>root@kvmubuntu:~# semanage fcontext -l | grep '/var/www/dato138it'<br>/var/www/dato138it(/.*)? all files system_u:object_r:httpd_sys_content_t:s0 <br>/var/www/dato138it/cache(/.*)? all files system_u:object_r:httpd_cache_t:s0 <br>/var/www/dato138it/index.php all files system_u:object_r:httpd_sys_rw_content_t:s0 <br>/var/www/dato138it/logs(/.*)? all files system_u:object_r:httpd_log_t:s0<br><strong>Source:</strong><br># https://www.ubuntumint.com/selinux-harden-apache-webserver/ - How to Install SELinux to Harden Apache Webserver.<br><strong>Task:</strong><br>Установить и настроить node.js сервер.<br># Администрирование Веб-серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# apt install npm<br>root@kvmubuntu:~# npm cache clean -f <br>root@kvmubuntu:~# npm install -g n<br>root@kvmubuntu:~# n latest<br>root@kvmubuntu:~# reboot<br><strong>Task:</strong><br>Добавить проект в node.js.<br># Администрирование Веб-серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# npx create-react-app frontend<br>root@kvmubuntu:~# cd frontend<br>root@kvmubuntu:~# npm install -D tailwindcss postcss autoprefixer<br>root@kvmubuntu:~# npx tailwindcss init -p<br><strong>Task:</strong><br>Запуск Веб-сайта.<br># Администрирование Веб-серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# cd frontend<br>root@kvmubuntu:~# python frontend/manage.py runserver tipubuntu:8000 &<br>root@kvmubuntu:~# google-chrome http://tipubuntu:8000/ &<br>root@kvmubuntu:~# cd frontend<br>root@kvmubuntu:~# npm run start &<br><strong>Source:</strong><br># https://www.youtube.com/playlist?list=PLPSM8rIid1a06M7kDOE6WMTXc9CpBskBg - DRF & React Portfolio Website<br><strong>Task:</strong><br>Настройка SSH сервера.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@aw:/# cat /root/.ssh/known_hosts<br>root@aw:/# cd keys <br>root@aw:/# ssh-keygen<br>root@aw:/# ls<br>wslkvmubuntu wslkvmubuntu.pub<br>root@aw:/# ssh-copy-id -i wslkvmubuntu.pub tuser@tipubuntu<br>root@aw:/# cat /root/.ssh/known_hosts<br>root@aw:/# ssh tuser@tipubuntu<br><strong>Source:</strong><br># https://timeweb.cloud/docs/unix-guides/ssh-key-authentication - Авторизация по SSH-ключу.<br><strong>Task:</strong><br>Создание пользователя.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>tuser@kvmubuntu:~$ sudo passwd root<br>tuser@kvmubuntu:~$ su -<br>root@kvmubuntu:~# useradd -m -d /home/tuser -u 1001 -s /bin/bash tuser<br>root@kvmubuntu:~# passwd tuser<br>root@kvmubuntu:~# cat /etc/passwd | grep tuser<br>tuser:x:1001:1001::/home/tuser:/bin/bash<br>root@kvmubuntu:~# id tuser<br>uid=1001(tuser) gid=1001(tuser) groups=1001(tuser)<br>root@kvmubuntu:~# usermod -aG sudo tuser<br><strong>Source:</strong><br># https://www.inp.nsk.su/~bolkhov/teach/inpunix/setup_users.ru.html - Манипуляции с пользователями.<br># https://losst.pro/kak-sozdat-polzovatelya-linux - Команда useradd.<br><strong>Task:</strong><br>Переименовать имя хоста.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# hostname<br>UBUNTU.twc1.net<br>root@kvmubuntu:~# hostname kvmubuntu.twc1.net<br>root@kvmubuntu:~# cat /etc/hosts<br>127.0.0.1 UBUNTU.twc1.net<br>root@kvmubuntu:~# vim /etc/hosts<br>root@kvmubuntu:~# cat /etc/hosts<br>127.0.0.1 kvmubuntu.twc1.net<br>root@kvmubuntu:~# cat /etc/hostname<br>UBUNTU.twc1.net<br>root@kvmubuntu:~# vim /etc/hostname<br>root@kvmubuntu:~# cat /etc/hostname<br>kvmubuntu.twc1.net<br>root@kvmubuntu:~# reboot<br><strong>Task:</strong><br>Удаление пользователя из группы Linux.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# groups tuser<br>tuser : tuser adm cdrom sudo dip plugdev lpadmin lxd sambashare<br>root@kvmubuntu:~# deluser tuser adm<br>Removing user `tuser' from group `adm' ...<br>Done.<br>root@kvmubuntu:~# deluser tuser cdrom<br>Removing user `tuser' from group `cdrom' ...<br>Done.<br>root@kvmubuntu:~# deluser tuser dip<br>Removing user `tuser' from group `dip' ...<br>Done.<br>root@kvmubuntu:~# deluser tuser plugdev<br>Removing user `tuser' from group `plugdev' ...<br>Done.<br>root@kvmubuntu:~# deluser tuser lpadmin<br>Removing user `tuser' from group `lpadmin' ...<br>Done.<br>root@kvmubuntu:~# deluser tuser lxd<br>Removing user `tuser' from group `lxd' ...<br>Done.<br>root@kvmubuntu:~# deluser tuser sambashare<br>Removing user `tuser' from group `sambashare' ...<br>Done.<br>root@kvmubuntu:~# deluser tuser sudo<br>Removing user `tuser' from group `sudo' ...<br>Done.<br>root@kvmubuntu:~# groups tuser<br>tuser : tuser<br>tuser@kvmubuntu:~$ sudo apt update<br>tuser is not in the sudoers file. This incident will be reported.<br><strong>Source:</strong><br># https://losst.pro/udalit-polzovatelya-iz-gruppy-linux?ysclid=lxbdgff7yz225601747 - Удаление пользователя из группы Linux.<br><strong>Task:</strong><br>Отключение входа для суперпользователя ssh.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin no/' /etc/ssh/sshd_config<br>root@kvmubuntu:~# sed -i 's/PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config<br>root@kvmubuntu:~# sed -i 's/UsePAM yes/UsePAM no/' /etc/ssh/sshd_config<br>root@kvmubuntu:~# vim /etc/ssh/sshd_config<br>root@kvmubuntu:~# cat /etc/ssh/sshd_config | grep PermitRootLogin<br>#PermitRootLogin yes<br>PermitRootLogin no<br># the setting of "PermitRootLogin without-password".<br>root@kvmubuntu:~# cat /etc/ssh/sshd_config | grep PasswordAuthentication<br>#PasswordAuthentication yes<br>PasswordAuthentication no<br># PasswordAuthentication. Depending on your PAM configuration,<br># PAM authentication, then enable this but set PasswordAuthentication<br>  PasswordAuthentication yes<br>root@kvmubuntu:~# vim /etc/ssh/sshd_config<br>root@kvmubuntu:~# cat /etc/ssh/sshd_config | grep UsePAM<br>#UsePAM yes<br>UsePAM no<br>root@kvmubuntu:~# cat /etc/ssh/sshd_config | grep ChallengeResponseAuthentication<br>ChallengeResponseAuthentication no<br>root@kvmubuntu:~# systemctl restart ssh<br><strong>Source:</strong><br># https://linuxconfig.org/allow-ssh-root-login-on-ubuntu-22-04-jammy-jellyfish-linux?ysclid=lxbo86izx4139346766 - Allowing SSH root login on Ubuntu 22.04 step by step instructions. <br># https://losst.pro/bezopasnost-servera-linux#toc-13-programmy-s-suid-i-sgid-bitami - Настройка SSH сервера.<br><strong>Task:</strong><br>Регулярная смена пароля.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# chage -M 7 -m 6 -W 5 tuser<br><strong>Source:</strong><br># https://manpages.ubuntu.com/manpages/trusty/ru/man1/chage.1.html - ПАРАМЕТРЫ.<br><strong>Task:</strong><br>Создать директорию или файл с пробелом в названии.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# mkdir /mnt/Program\ Files<br><strong>Task:</strong><br>Скопировать файлы с теми же правами.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# cp -pr /var/lib/postgresql/14.backup /var/lib/postgresql/14/<br><strong>Source:</strong><br># https://www.linux.org.ru/forum/general/8186570 - Копирование файлов с правами и пользователямию<br><strong>Task:</strong><br>Общие папки Linux.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# mkdir /var/share<br>root@kvmubuntu:~# chmod ugo+rw -R /var/share<br><strong>Source:</strong><br># https://losst.pro/obshhie-papki-linux - Общие папки в Linux.<br><strong>Task:</strong><br>Создать ссылку на директорию tdir1.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# mkdir tdir1<br>root@kvmubuntu:~# mkdir tdir2<br>root@kvmubuntu:~# touch tdir1/tfile1<br>root@kvmubuntu:~# ln -s /home/tuser/tdir1 /home/tuser/tdir2<br><strong>Task:</strong><br>Установка Sftp сервера.<br># Администрирование локальных серверов. <br><strong>Decision:</strong><br>root@kvmubuntu:~# virsh start Windows10<br>- Панель управления - Система - Настройка удаленного доступа - +разрешить подключения удаленного помощника к этому компьютеру - +разрешить удаленные подключения к этому компьютеру - -Разрешить подключение только с компьютеров ...<br>PS C:\Windows\system32&gt; Add-WindowsCapability -Online -Name OpenSSH.Client~~~~0.0.1.0<br>PS C:\Windows\system32&gt; Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0<br>PS C:\Windows\system32&gt; Get-WindowsCapability -Online | Where-Object Name -like 'OpenSSH*'<br>Name : OpenSSH.Client~~~~0.0.1.0<br>State : Installed<br>Name : OpenSSH.Server~~~~0.0.1.0<br>State : Installed<br>C:\Users\tuser&gt; ipconfig<br>...<br>tipubuntu<br>PS C:\Windows\system32&gt; Start-Service sshd<br>PS C:\Windows\system32&gt; Set-Service -Name sshd -StartupType 'Automatic'<br>PS C:\Windows\system32&gt; notepad.exe C:\ProgramData\ssh\sshd_config<br>PS C:\Windows\system32&gt; type C:\ProgramData\ssh\sshd_config<br>...<br>PasswordAuthentication yes<br>...<br># override default of no subsystems<br>Subsystem sftp sftp-server.exe<br>...<br>Match User tuser<br>ChrootDirectory C:\Users\tuser\Documents<br># ForceCommand internal-sftp<br>X11Forwarding yes<br>...<br>PS C:\Windows\system32&gt; Restart-Service sshd<br>root@kvmubuntu:~# ssh tuser@tipubuntu<br>tuser@KVM-TWINDOWS C:\Users\tuser&gt; exit<br>root@kvmubuntu:~# ls<br>DataProcessingInCpp Drivers ReceivingDataFromSatellite<br>root@kvmubuntu:~# sftp tuser@tipubuntu<br>sftp&gt; put -r ReceivingDataFromSatellite<br>sftp&gt; put -r DataProcessingInCpp<br>sftp&gt; ls<br>DataProcessingInCpp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <br>ReceivingDataFromSatellite <br>sftp&gt; exit<br><strong>Task:</strong><br>Install and configure an FTP server. Securing the connection to the FTP server. Запрещаем доступ к фтп всем пользователям, кроме пользователя с MAC-адресом tmacubuntu.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# dnf update -y<br>[root@kvmcentos ~]# dnf install vsftpd -y<br>[root@kvmcentos ~]# systemctl enable vsftpd --now<br>[root@kvmcentos ~]# systemctl status vsftpd<br>[root@kvmcentos ~]# useradd -m -d "/home/ftpuser" ftpuser<br>[root@kvmcentos ~]# passwd ftpuser<br>[root@kvmcentos ~]# mkdir -p /home/ftpuser/shared<br>[root@kvmcentos ~]# chmod -R 750 /home/ftpuser/shared<br>[root@kvmcentos ~]# chown ftpuser: /home/ftpuser/shared<br>[root@kvmcentos ~]# vim /etc/vsftpd/user_list<br>[root@kvmcentos ~]# cat /etc/vsftpd/user_list | grep ftp<br>ftpuser<br>[root@kvmcentos ~]# vim /etc/vsftpd/vsftpd.conf<br>[root@kvmcentos ~]# cat /etc/vsftpd/vsftpd.conf<br>...<br>anonymous_enable=NO<br>local_enable=YES<br>write_enable=YES<br>chroot_local_user=YES<br>allow_writeable_chroot=YES<br>pasv_min_port=31500<br>pasv_max_port=32500<br>userlist_file=/etc/vsftpd/user_list<br>userlist_deny=NO<br>[root@kvmcentos ~]# systemctl restart vsftpd<br>[root@kvmcentos ~]# openssl req -x509 -nodes -days 3650 \<br>-newkey rsa:2048 -keyout /etc/vsftpd.pem \<br>-out /etc/vsftpd/vsftpd.pem<br>[root@kvmcentos ~]# vim /etc/vsftpd/vsftpd.conf<br>[root@kvmcentos ~]# cat /etc/vsftpd/vsftpd.conf<br>...<br>#rsa_cert_file=/etc/vsftpd/vsftpd.pem<br>#rsa_private_key_file=/etc/vsftpd.pem<br>#ssl_enable=YES<br>[root@kvmcentos ~]# systemctl restart vsftpd<br>[root@kvmcentos ~]# cat /etc/sysconfig/iptables<br># Generated by iptables-save v1.8.8 (nf_tables) on Sun Oct 22 12:10:33 2023<br>*mangle<br>:PREROUTING ACCEPT [45:3316]<br>:INPUT ACCEPT [45:3316]<br>:FORWARD ACCEPT [0:0]<br>:OUTPUT ACCEPT [34:5048]<br>:POSTROUTING ACCEPT [34:5048]<br>COMMIT<br># Completed on Sun Oct 22 12:10:33 2023<br># Generated by iptables-save v1.8.8 (nf_tables) on Sun Oct 22 12:10:33 2023<br>*raw<br>:PREROUTING ACCEPT [45:3316]<br>:OUTPUT ACCEPT [34:5048]<br>COMMIT<br># Completed on Sun Oct 22 12:10:33 2023<br># Generated by iptables-save v1.8.8 (nf_tables) on Sun Oct 22 12:10:33 2023<br>*filter<br>:INPUT DROP [0:0]<br>:FORWARD DROP [0:0]<br>:OUTPUT DROP [0:0]<br>-A INPUT -i lo -j ACCEPT<br>-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT<br>-A INPUT -p tcp -m multiport --dports 21,22,25,53,80,143,443 -j ACCEPT<br>-A INPUT -p udp -m multiport --dports 53,21,20 -j ACCEPT<br>-A INPUT -p icmp -m icmp --icmp-type 0 -j ACCEPT<br>-A OUTPUT -o lo -j ACCEPT<br>-A OUTPUT -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT<br>COMMIT<br># Completed on Sun Oct 22 12:10:33 2023<br># Generated by iptables-save v1.8.8 (nf_tables) on Sun Oct 22 12:10:33 2023<br>*nat<br>:PREROUTING ACCEPT [0:0]<br>:INPUT ACCEPT [0:0]<br>:OUTPUT ACCEPT [0:0]<br>:POSTROUTING ACCEPT [0:0]<br>COMMIT<br># Completed on Sun Oct 22 12:10:33 2023<br>[root@kvmcentos ~]# iptables -t filter -A INPUT -p tcp --dport 20:21 -j ACCEPT<br>[root@kvmcentos ~]# iptables -t filter -A INPUT -p tcp --dport 31500:32500 -j ACCEPT<br>[root@kvmcentos ~]# service iptables save<br>[root@kvmcentos ~]# systemctl restart iptables<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ telnet tipcentos 21<br>USER ftpuser<br>PASS tpassword<br>PWD<br>PASV<br>227 Entering Passive Mode (tipcentos,126,61).<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ 126*256+61 <br>32317<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ telnet tipcentos 32317<br>LIST<br>drwxr-x--- 2 1001 1001 6 Oct 21 03:06 shared<br>QUIT<br><strong>Task:</strong><br>Запрещаем доступ к ftp всем пользователям, кроме пользователя с MAC-адресом tmacubuntu.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ifconfig | grep tmacubuntu<br>ether tmacubuntu txqueuelen 1000 (Ethernet)<br>[root@kvmcentos ~]# iptables -I INPUT -p tcp --dport 21 -m mac ! --mac-source tmacubuntu -j REJECT<br>[root@kvmcentos ~]# service iptables save<br>[root@kvmcentos ~]# systemctl restart iptables<br>root@kvmubuntu:~# ftp tipcentos<br>Name (tipcentos:user): ftpuser<br>Password:<br>ftp&gt; ls<br>drwxr-x--- 2 1001 1001 6 Oct 21 03:06 shared<br>ftp&gt; exit<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ ftp tipcentos<br>ftp: Can't connect to `tipcentos:21': Connection refused<br>ftp: Can't connect to `tipcentos:ftp'<br>ftp&gt; exit<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ telnet tipcentos 21<br>Trying tipcentos...<br>telnet: Unable to connect to remote host: Connection refused<br><strong>Source:</strong><br># https://unixcop.com/how-to-install-and-configure-an-ftp-server-on-centos-9-stream/<br># https://losst.pro/kak-otkryt-port-iptables?ysclid=lnvrpgxwj8175390861<br># https://techviewleo.com/configure-vsftpd-ftp-server-on-ubuntu-linux/<br># https://stackoverflow.com/questions/38523250/vsftpd-login-is-not-successful<br><strong>Task:</strong><br>Install Nginx.<br>Администрирование Веб-серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# dnf update -y<br>[root@kvmcentos ~]# dnf install nginx<br>[root@kvmcentos ~]# systemctl start nginx<br>[root@kvmcentos ~]# systemctl enable nginx<br>[root@kvmcentos ~]# nginx -v<br>[root@kvmcentos ~]# firefox http://tipcentos:80/<br><strong>Source:</strong><br># https://devcoops.com/install-nginx-on-centos-9-stream/ - Install Nginx.<br><strong>Task:</strong><br>Configure Squid Proxy Kali.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>┌──(tuser㉿kvmkali)-[~]<br>└─$ apt update<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ apt install squid<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ systemctl start squid<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ systemctl enable squid<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ grep -Eiv '(^#|^$)' /etc/squid/squid.conf<br>acl localnet src 0.0.0.1-0.255.255.255 # RFC 1122 "this" network (LAN)<br>acl localnet src 10.0.0.0/8 # RFC 1918 local private network (LAN)<br>acl localnet src 100.64.0.0/10 # RFC 6598 shared address space (CGN)<br>acl localnet src 169.254.0.0/16 # RFC 3927 link-local (directly plugged) machines<br>acl localnet src 172.16.0.0/12 # RFC 1918 local private network (LAN)<br>acl localnet src tipkali.0.0/16 # RFC 1918 local private network (LAN)<br>acl localnet src fc00::/7 # RFC 4193 local private network range<br>acl localnet src fe80::/10 # RFC 4291 link-local (directly plugged) machines<br>acl SSL_ports port 443<br>acl Safe_ports port 80 # http<br>acl Safe_ports port 21 # ftp<br>acl Safe_ports port 443 # https<br>acl Safe_ports port 70 # gopher<br>acl Safe_ports port 210 # wais<br>acl Safe_ports port 1025-65535 # unregistered ports<br>acl Safe_ports port 280 # http-mgmt<br>acl Safe_ports port 488 # gss-http<br>acl Safe_ports port 591 # filemaker<br>acl Safe_ports port 777 # multiling http<br>http_access deny !Safe_ports<br>http_access deny CONNECT !SSL_ports<br>http_access allow localhost manager<br>http_access deny manager<br>http_access allow localhost<br>http_access deny to_localhost<br>http_access deny to_linklocal<br>include /etc/squid/conf.d/*.conf<br>http_access deny all<br>http_port 3128<br>coredump_dir /var/spool/squid<br>refresh_pattern ^ftp: 1440 20% 10080<br>refresh_pattern -i (/cgi-bin/|\?) 0 0% 0<br>refresh_pattern . 0 20% 4320<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ mv /etc/squid/squid.conf /etc/squid/squid.conf.bac<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ vim /etc/squid/squid.conf<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ cat /etc/squid/squid.conf<br>acl localnet src tipkali<br>http_access allow localnet<br>http_port 3128<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ systemctl restart squid<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ cat /var/log/squid/access.log<br>1698153952.395 1 tipkali NONE_NONE/400 3816 - / - HIER_NONE/- text/html<br>1698153953.958 7 tipkali TCP_DENIED/403 4185 GET http://kali:3128/squid-internal-static/icons/SN.png - HIER_NONE/- text/html<br>...<br>1698154905.087 2 tipkali TCP_MISS/400 3889 GET http://tipkali:3128/ - HIER_DIRECT/tipkali text/html<br>1698154906.698 149 tipkali TCP_TUNNEL/200 39 CONNECT static.vk.com:443 - HIER_DIRECT/87.240.137.164 -<br>1698154906.796 0 tipkali NONE_NONE/400 3838 - /favicon.ico - HIER_NONE/- text/html<br>1698154906.797 2 tipkali TCP_MISS/400 3911 GET http://tipkali:3128/favicon.ico - HIER_DIRECT/tipkali text/html<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ apt install apache2-utils<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ htpasswd -c /etc/squid/passwd user<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ vim /etc/squid/squid.conf<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ cat /etc/squid/squid.conf<br>#acl localnet src tipkali<br>#http_access allow localnet<br>http_port 3128<br>via off<br>auth_param basic program /usr/lib/squid/basic_ncsa_auth /etc/squid/passwd<br>auth_param basic children 5<br>auth_param basic credentialsttl 2 hours<br>auth_param basic casesensitive on<br>auth_param basic realm Squid proxy for kali<br>acl auth_users proxy_auth REQUIRED<br>http_access allow auth_users<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ systemctl restart squid<br><strong>Task:</strong><br>Configure Squid Proxy Centos.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# dnf install squid<br>[root@kvmcentos ~]# systemctl enable --now squid<br>[root@kvmcentos ~]# grep -Eiv '(^#|^$)' /etc/squid/squid.conf<br>acl localnet src 0.0.0.1-0.255.255.255 # RFC 1122 "this" network (LAN)<br>acl localnet src 10.0.0.0/8 # RFC 1918 local private network (LAN)<br>acl localnet src 100.64.0.0/10 # RFC 6598 shared address space (CGN)<br>acl localnet src 169.254.0.0/16 # RFC 3927 link-local (directly plugged) machines<br>acl localnet src 172.16.0.0/12 # RFC 1918 local private network (LAN)<br>acl localnet src tipcentos/16 # RFC 1918 local private network (LAN)<br>acl localnet src fc00::/7 # RFC 4193 local private network range<br>acl localnet src fe80::/10 # RFC 4291 link-local (directly plugged) machines<br>acl SSL_ports port 443<br>acl Safe_ports port 80 # http<br>acl Safe_ports port 21 # ftp<br>acl Safe_ports port 443 # https<br>acl Safe_ports port 70 # gopher<br>acl Safe_ports port 210 # wais<br>acl Safe_ports port 1025-65535 # unregistered ports<br>acl Safe_ports port 280 # http-mgmt<br>acl Safe_ports port 488 # gss-http<br>acl Safe_ports port 591 # filemaker<br>acl Safe_ports port 777 # multiling http<br>http_access deny !Safe_ports<br>http_access deny CONNECT !SSL_ports<br>http_access allow localhost manager<br>http_access deny manager<br>http_access allow localnet<br>http_access allow localhost<br>http_access deny all<br>http_port 3128<br>coredump_dir /var/spool/squid<br>refresh_pattern ^ftp: 1440 20% 10080<br>refresh_pattern ^gopher: 1440 0% 1440<br>refresh_pattern -i (/cgi-bin/|\?) 0 0% 0<br>refresh_pattern . 0 20% 4320<br>[root@kvmcentos ~]# mv /etc/squid/squid.conf /etc/squid/squid.conf.bac<br>[root@kvmcentos ~]# vim /etc/squid/squid.conf<br>[root@kvmcentos ~]# cat /etc/squid/squid.conf<br>acl localnet src tipcentos<br>acl localnet src tipcentos.0/32<br>acl Safe_ports port 80<br>acl Safe_ports port 443<br>cache_dir ufs /var/spool/squid 1000 16 256<br>http_access allow localnet<br>http_port 3128<br>[root@kvmcentos ~]# systemctl restart squid<br>[root@kvmcentos ~]# iptables -t filter -A INPUT -p tcp --dport 3128 -j ACCEPT<br>[root@kvmcentos ~]# service iptables save<br>[root@kvmcentos ~]# systemctl restart iptables.service<br>[root@kvmcentos ~]# curl -O -L "https://www.redhat.com/index.html" -x "tipcentos:3128"<br>% Total % Received % Xferd Average Speed Time Time Time Current<br>  Dload Upload Total Spent Left Speed<br>0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0<br>100 156k 0 156k 0 0 147k 0 --:--:-- 0:00:01 --:--:-- 795k<br>┌──(tuser㉿kvmkali)-[~]<br>└─$ nmap tipcentos<br>...<br>PORT STATE SERVICE<br>20/tcp closed ftp-data<br>21/tcp open ftp<br>22/tcp open ssh<br>25/tcp closed smtp<br>53/tcp closed domain<br>80/tcp open http<br>143/tcp closed imap<br>443/tcp closed https<br>3128/tcp open squid-http<br>...<br>[root@kvmcentos ~]# dnf install httpd-tools<br>[root@kvmcentos ~]# touch /etc/squid/passwd<br>[root@kvmcentos ~]# chown squid /etc/squid/passwd<br>[root@kvmcentos ~]# htpasswd /etc/squid/passwd proxyuser<br>[root@kvmcentos ~]# vim /etc/squid/squid.conf<br>[root@kvmcentos ~]# cat /etc/squid/squid.conf<br>#acl localnet src tipcentos<br>#acl localnet src tip.0/32<br>#acl Safe_ports port 80<br>#acl Safe_ports port 443<br>#cache_dir ufs /var/spool/squid 1000 16 256<br>#http_access allow localnet<br>http_port 3128<br>auth_param basic program /usr/lib64/squid/basic_ncsa_auth /etc/squid/passwd<br>auth_param basic children 5<br>auth_param basic realm Squid Basic Authentication<br>auth_param basic credentialsttl 2 hours<br>acl auth_users proxy_auth REQUIRED<br>http_access allow auth_users<br>[root@kvmcentos ~]# systemctl restart squid<br>[root@kvmcentos ~]# curl -O -L "https://www.redhat.com/index.html" -x "proxyuser:tpassword@tipcentos:3128"<br>% Total % Received % Xferd Average Speed Time Time Time Current<br>  Dload Upload Total Spent Left Speed<br>0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0<br>100 156k 0 156k 0 0 124k 0 --:--:-- 0:00:01 --:--:-- 562k<br><strong>Source:</strong><br># https://support.mozilla.org/ru/kb/parametry-soedineniya-v-firefox<br># https://techviewleo.com/configure-squid-proxy-on-centos-almalinux-rhel/<br><strong>Task:</strong><br>Перенаправление пакетов, идущих на 80-й порт, на стандартный порт прокси-сервера.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# iptables -t nat -A PREROUTING -s tipcentos.0 -p tcp --dport 80 -j REDIRECT --to-port 3128<br>[root@kvmcentos ~]# service iptables save<br>[root@kvmcentos ~]# systemctl restart iptables.service<br><strong>Task:</strong><br>Предоставляем доступ из Интернет к веб-серверу, который расположен в локальной сети (проброс порта). Вместо tipubuntu укажите IP-адрес вашего веб-сервера.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination tipubuntu:80<br>[root@kvmcentos ~]# service iptables save<br>[root@kvmcentos ~]# systemctl restart iptables.service<br><strong>Task:</strong><br>Настройка Proxy-сервера. Включаем маскарадинг для доступа в Интернет пользователей локальной сети.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# iptables -t nat -A POSTROUTING -o enp1s0 -s tipubuntu.0/32 -j MASQUERADE<br>[root@kvmcentos ~]# service iptables save<br>[root@kvmcentos ~]# systemctl restart iptables.service<br><strong>Task:</strong><br>Блокировка подозрительных IP-адресов.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# iptables -A INPUT -s tipkali -j DROP<br>[root@kvmcentos ~]# service iptables save<br>[root@kvmcentos ~]# systemctl restart iptables.service<br><strong>Task:</strong><br>Установка и настройка tripwire.<br>- Создаем конфигурацию, Создаем базу данных.<br>- Проверим на работоспособность утилиты Tripwire. Создав файл в системе, утилита должна показать, что добавлен был файл.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@kvmcentos ~]# dnf -y install epel-releasey<br>[root@kvmcentos ~]# dnf -y install tripwire<br>[root@kvmcentos ~]# tripwire-setup-keyfiles<br>[root@kvmcentos ~]# tripwire --init<br>...<br>### Warning: File system error.<br>### Filename: /proc/pci<br>### Нет такого файла или каталога<br>### Continuing...<br>...<br>[root@kvmcentos ~]# cat /etc/tripwire/twpol.txt<br>...<br>/proc/pci -&gt; root@aw:/#(Device) ;<br>...<br>[root@kvmcentos ~]# vim /etc/tripwire/twpol.txt<br>[root@kvmcentos ~]# cat /etc/tripwire/twpol.txt<br>...<br>#/proc/pci -&gt; root@aw:/#(Device) ;<br>...<br>[root@kvmcentos ~]# tripwire --update-policy --secure-mode low /etc/tripwire/twpol.txt<br>[root@kvmcentos ~]# tripwire --check —interactive<br>[root@kvmcentos ~]# ls /etc/tripwire/<br>centos-local.key site.key tw.cfg twcfg.txt tw.pol tw.pol.bak twpol.txt<br>[root@kvmcentos ~]# twadmin -m F -c /etc/tripwire/tw.cfg -S /etc/tripwire/site.key /etc/tripwire/twcfg.txt<br>[root@kvmcentos ~]# vim /etc/tripwire/twpolmake.pl<br>[root@kvmcentos ~]# cat /etc/tripwire/twpolmake.pl<br>#!/usr/bin/perl<br># Tripwire Policy File customize tool<br># ----------------------------------------------------------------<br># Copyright (C) 2003 Hiroaki Izumi<br># This program is free software; you can redistribute it and/or<br># modify it under the terms of the GNU General Public License<br># as published by the Free Software Foundation; either version 2<br># of the License, or (at your option) any later version.<br># This program is distributed in the hope that it will be useful,<br># but WITHOUT ANY WARRANTY; without even the implied warranty of<br># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the<br># GNU General Public License for more details.<br># You should have received a copy of the GNU General Public License<br># along with this program; if not, write to the Free Software<br># Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.<br># ----------------------------------------------------------------<br># Usage:<br># perl twpolmake.pl {Pol file}<br># ----------------------------------------------------------------<br>#<br>root@aw:/#POLFILE=root@aw:/#ARGV[0];<br>open(POL,"root@aw:/#POLFILE") or die "open error: root@aw:/#POLFILE" ;<br>my(root@aw:/#myhost,$kvm-tcentos) ;<br>my(root@aw:/#sharp,root@aw:/#tpath,root@aw:/#cond) ;<br>my(root@aw:/#INRULE) = 0 ;<br>while (&lt;POL&gt;) {<br>chomp;<br>if (($kvm-tcentos) = /^HOSTNAME\s*=\s*(.*)\s*;/) {<br>root@aw:/#myhost = `hostname` ; chomp(root@aw:/#myhost) ;<br>if ($kvm-tcentos ne root@aw:/#myhost) {<br>root@aw:/#_="HOSTNAME=\"root@aw:/#myhost\";" ;<br>}<br>}<br>elsif ( /^{/ ) {<br>root@aw:/#INRULE=1 ;<br>}<br>elsif ( /^}/ ) {<br>root@aw:/#INRULE=0 ;<br>}<br>elsif (root@aw:/#INRULE == 1 and (root@aw:/#sharp,root@aw:/#tpath,root@aw:/#cond) = /^(\s*\#?\s*)(\/\S+)\b(\s+-&gt;\s+.+)root@aw:/#/) {<br>root@aw:/#ret = (root@aw:/#sharp =~ s/\#//g) ;<br>if (root@aw:/#tpath eq '/sbin/e2fsadm' ) {<br>root@aw:/#cond =~ s/;\s+(tune2fs.*)root@aw:/#/; \#root@aw:/#1/ ;<br>}<br>if (! -s root@aw:/#tpath) {<br>root@aw:/#_ = "root@aw:/#sharp#root@aw:/#tpathroot@aw:/#cond" if (root@aw:/#ret == 0) ;<br>}<br>else {<br>root@aw:/#_ = "root@aw:/#sharproot@aw:/#tpathroot@aw:/#cond" ;<br>}<br>}<br>print "root@aw:/#_\n" ;<br>}<br>close(POL) ;<br>[root@kvmcentos ~]# perl /etc/tripwire/twpolmake.pl /etc/tripwire/twpol.txt &gt; /etc/tripwire/twpol.txt.new<br>[root@kvmcentos ~]# twadmin -m P -c /etc/tripwire/tw.cfg -p /etc/tripwire/tw.pol -S /etc/tripwire/site.key /etc/tripwire/twpol.txt.new<br>[root@kvmcentos ~]# tripwire -m i -s -c /etc/tripwire/tw.cfg<br>[root@kvmcentos ~]# tripwire -m c -s -c /etc/tripwire/tw.cfg<br>Open Source Tripwire(R) 2.4.3.7 Integrity Check Report<br>Report generated by: root<br>Report created on: Вс 29 окт 2023 14:26:04<br>Database last updated on: Never<br>...<br>===============================================================================<br>Object Summary:<br>===============================================================================<br>-------------------------------------------------------------------------------<br># Section: Unix File System<br>-------------------------------------------------------------------------------<br>No violations.<br>===============================================================================<br>Error Report:<br>===============================================================================<br>...<br>[root@kvmcentos ~]# ls /var/lib/tripwire/report<br>итого 28<br>-rw-r--r--. 1 root root 350 окт 29 13:55 centos-20231029-135511.twr<br>-rw-r--r--. 1 root root 350 окт 29 13:57 centos-20231029-135712.twr<br>-rw-r--r--. 1 root root 350 окт 29 14:00 centos-20231029-140029.twr<br>-rw-r--r--. 1 root root 350 окт 29 14:08 centos-20231029-140853.twr<br>-rw-r--r--. 1 root root 350 окт 29 14:09 centos-20231029-140919.twr<br>-rw-r--r--. 1 root root 6446 окт 29 14:27 centos-20231029-142604.twr<br>[root@kvmcentos ~]# touch /var/lib/tripwire/tfile.txt<br>[root@kvmcentos ~]# tripwire -m c -s -c /etc/tripwire/tw.cfg<br>Open Source Tripwire(R) 2.4.3.7 Integrity Check Report<br>...<br>-------------------------------------------------------------------------------<br>Rule Name: Tripwire Data Files (/var/lib/tripwire)<br>Severity Level: 100<br>-------------------------------------------------------------------------------<br>Added:<br>"/var/lib/tripwire/tfile.txt"<br>===============================================================================<br>Error Report:<br>===============================================================================<br>...<br><strong>Source:</strong><br># https://linux-notes.org/ustanovka-i-nastrojka-tripwire-v-centos-redhat-fedora/?ysclid=loazeq8vjc96566460<br># https://www.server-world.info/en/note?os=CentOS_7&p=tripwire<br># https://www.lisenet.com/2017/configure-tripwire-on-centos-7/<br><strong>Task:</strong><br>Протестировать диск.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# apt update <br>root@kvmubuntu:~# apt install testdisk<br>root@kvmubuntu:~# lsblk<br> ...<br> sdc&nbsp;&nbsp;  8:32   0 931,5G  0 disk <br>└─sdc1   8:33   0 931,5G  0 part /media/dato/Файлы<br>root@kvmubuntu:~# testdisk<br>...<br>&gt;[ Create ] Create a new log file<br>...<br>Select a media (use Arrow keys, then press Enter):<br>...<br>&gt;Disk /dev/sdc - 1000 GB / 931 GiB - ST1000LM 035-1RK172<br>...<br> [Previous]  [  Next  ] &gt;[Proceed ]  [  Quit  ]<br>...<br>Please select the partition table type, press Enter when done.<br>...<br>&gt;[EFI GPT] EFI GPT partition map (Mac i386, some x86_64...)<br>...<br>&gt;[ Analyse  ] Analyse current partition structure and search for lost partitions<br>...<br>&gt;[Quick Search]  [ Backup ]<br>...<br>&gt;P MS Data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2048 1953523711 1953521664<br>...<br> 1 P MS Data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2048 1953523711 1953521664<br>...<br> [  Quit  ]  [ Return ] &gt;[Deeper Search]  [ Write  ]<br><strong>Source:</strong><br># https://www.8host.com/blog/ustanovka-testdisk-i-vosstanovlenie-fajlov/?ysclid=lwwuyo1ydf377479189<br><strong>Task:</strong><br>Вытащить последние 1000 строк лога, первые 1200 строк логов.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# tail -n 1000 /var/log/syslog<br>root@kvmubuntu:~# head -n 1200 /var/log/syslog<br><strong>Task:</strong><br>Посмотреть адрес в mx записи linux.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# dig @сервер доменное.имя тип записи флаги<br><strong>Task:</strong><br>Управление процессами.<br>- Сохраните в отдельном файле и прокомментируйте данные о процессе init.<br>- Сохраните листинг самых ресурсоемких процессов и прокомментируйте его.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# ps aux -p 1 &gt; processes.txt<br># выводим содержимое файла processes.txt на экран. поле USER отображает имя пользователя, запустившего процесс, PID - идентификатор процесса, %CPU - уровень использования процессора, %MEM - уровень использования памяти, VSZ - объём используемой виртуальной памяти, RSS - объём используемой реальной памяти, TTY - терминал, с которым связан процесс("?" потому, что init это первый системный процесс и он не связан ни с одним терминалом), STAT - состояние выполнения("S" - означает, что процесс бездействует, "s" - то что процесс лидер сеанса), START - время старта, TIME - время исполнения (на процессоре), COMMAND - имя программы.<br>root@kvmubuntu:~# cat processes.txt<br>USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND<br>root 1 0.7 0.0 1628 536 ? Ss 13:53 0:01 /sbin/init splash<br>root@kvmubuntu:~# ps aux --sort -pcpu | head -n 3<br>USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND<br>root 4997 5.5 3.8 127632 40044 ? SLl 11:56 0:16 amarok<br>root 5304 3.9 0.0 1852 776 ? RN 12:00 0:01 /usr/bin/updatedb<br># поле USER отображает имя пользователя, запустившего процесс, PID - идентификатор процесса, %CPU - уровень использования процессора, %MEM - уровень использования памяти, VSZ - объём используемой виртуальной памяти, RSS - объём используемой реальной памяти, TTY - терминал, с которым связан процесс, STAT - состояние выполнения, START - время старта, TIME - время исполнения (на процессоре), COMMAND - имя программы.<br># в выводе этого листинга видно, что процесс amarok с PID 4997, созданный пользователем root является самым ресурсоемким по использованию процессора. он использует процессор на 5.5, память на 3.8, его виртуальная память 127632, реальная память 40044, он не прикреплен ни к одному терминалу, его статус: "S" - означает, что процесс бездействует(ожидает выполнения), "L" - означает что это real-time процесс, имеются страницы заблокированные в памяти, время запуска процесса 11 часов 56 минут, время выполнения 16 секунд.<br>root@kvmubuntu:~# ps aux --sort -pmem | head -n 3<br>USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND<br>root 1 0.2 0.1 1628 536 ? Ss 11:54 0:02 /sbin/init splash<br>root 2 0.0 0.0 0 0 ? S 11:54 0:00 [migration/0]<br># поле USER отображает имя пользователя, запустившего процесс, PID - идентификатор процесса, %CPU - уровень использования процессора, %MEM - уровень использования памяти, VSZ - объём используемой виртуальной памяти, RSS - объём используемой реальной памяти, TTY - терминал, с которым связан процесс, STAT - состояние выполнения, START - время старта, TIME - время исполнения (на процессоре), COMMAND - имя программы.<br># в выводе этого листинга видно, что процесс "/sbin/init splash" с PID 1, созданный пользователем root является самым ресурсоемким по использованию оперативной памяти. он использует процессор на 0.2, память на 0.1, его виртуальная память 1628, реальная память 536, он не прикреплен ни к одному терминалу, его статус: "S" - означает, что процесс бездействует, "s" - то что процесс лидер сеанса, время запуска процесса 11 часов 54 минуты, время выполнения 2 секунды.<br><strong>Task:</strong><br>Создайте сжатый архив файлов, измененных за последнюю неделю (tar, gzip, find, cpio).<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# find / -type f -mtime -7 &gt; files.txt 2&gt;/dev/null<br>root@kvmubuntu:~# tar -cf arch.tar -T files.txt 2&gt;/dev/null<br>root@kvmubuntu:~# gzip arch.tar<br>root@kvmubuntu:~# gzip -l arch.tar.gz<br>compressed uncompressed ratio uncompressed_name<br>60560158 163093504 62.9% arch.tar<br><strong>Task:</strong><br>Переведите часы на зимнее время (на 1 час назад).<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# date<br>Fri Nov 30 15:58:48 2007<br>root@kvmubuntu:~# date --s -1hour<br>Fri Nov 30 14:58:54 2007<br><strong>Task:</strong><br>Настроить диск с файловой системой exfat.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# apt install exfat-fuse<br>root@kvmubuntu:~# mkfs -t exfat /dev/sdc1<br><strong>Task:</strong><br>Установить Visualstudio в Linux.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# rpm --import https://packages.microsoft.com/keys/microsoft.asc<br>root@kvmubuntu:~# sh -c 'echo -e "[code]\nname=Visual Studio Code\nbaseurl=https://packages.microsoft.com/yumrepos/vscode\nenabled=1\ngpgcheck=1\ngpgkey=https://packages.microsoft.com/keys/microsoft.asc" &gt; /etc/yum.repos.d/vscode.repo'<br>root@kvmubuntu:~# dnf check-update<br>root@kvmubuntu:~# dnf install code -y<br>root@kvmubuntu:~# code<br><strong>Source:</strong><br># https://code.visualstudio.com/docs/setup/linux<br><strong>Task:</strong><br>Для подготовки стенда:<br>1. Необходимо скачать архив по ссылке: courses-shop.zip (Зеркало: courses-shop.zip Яндекс.Диск)<br>2. Распаковать данный архив и перейти в появившуюся директорию courses-shop-prod в терминальной оболочке вашей ОС. Выполнить команду (при запущенном сервисе docker): docker-compose up -d. По адресу http://localhost:1337 появится приложение лабораторного стенда.<br>Возможные проблемы:<br>1. На некоторых компьютерах приложение может долго ожидать подключения к базе данных. Это зависит от мощностей вашего компьютера.<br>2. По той же причине бот (администратор приложения) может не запуститься, если база данных запускалась дольше 15 секунд. В таком случае вы можете перезагрузить сервис бота из папки приложения после загрузки базы данных командой:<br>docker-compose restart bot<br>Необходимо находиться в директории приложения, в одном месте с файлом docker-compose.yml<br>Проанализируйте защищенность механизмов аутентификации административной панели и проэксплуатируйте найденные уязвимости.<br>В качестве подтверждения успешной эксплуатации предоставьте флаг (секретную строку в формате 32 букв и цифр) из кода страницы панели администратора.<br>Вопрос для самопроверки на протяжении работы с данным лабораторным стендом:<br>Что опасного в этой информационной системе может сделать злоумышленник? Какие риски он мог бы реализовать?<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# firefox https://disk.yandex.ru/d/bXfeC1DM4vrUsw<br>root@kvmubuntu:~# unzip Downloads/courses-shop.zip<br>root@kvmubuntu:~# cd courses-shop-prod<br>root@kvmubuntu:~# docker-compose up -d<br>root@kvmubuntu:~# firefox https://portswigger.net/burp/releases/professional-community-2023-9-4?requestededition=community&requestedplatform=<br>root@kvmubuntu:~# chmod ugo+x burpsuite_community_linux_v2023_9_4.sh<br>root@kvmubuntu:~# ./burpsuite_community_linux_v2023_9_4.sh<br>root@kvmubuntu:~# /home/tuser/BurpSuiteCommunity/BurpSuiteCommunity &<br>root@kvmubuntu:~# firefox https://github.com/empty-jack/YAWR/blob/master/brute/passwords/realyBest.txt <br><strong>Source:</strong><br># https://portswigger.net/burp/documentation/desktop/getting-started/download-and-install<br># https://losst.pro/zapusk-skripta-sh-v-linux<br><strong>Task:</strong><br>Установить Sublimetext<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>root@kvmubuntu:~# rpm -v --import https://download.sublimetext.com/sublimehq-rpm-pub.gpg<br>root@kvmubuntu:~# dnf config-manager --add-repo https://download.sublimetext.com/rpm/stable/x86_64/sublime-text.repo<br>root@kvmubuntu:~# dnf -y install sublime-text<br><strong>Source:</strong><br># https://www.sublimetext.com/docs/linux_repositories.html#dnf<br><strong>Task:</strong><br>Установка Gimp.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# yum provides gimp<br>[root@hvredos ~]# yum list | grep gimp<br>gimp.hvredos86 2:2.8.22-2.el7 base<br>[root@hvredos ~]# yum -y install gimp<br><strong>Task:</strong><br>Запись дисков Linux в терминале.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# ls<br>13 'MyTestX Tests'<br>[root@hvredos ~]# pwd<br>/home/tuser@tdomain.ru/Documents<br>[root@hvredos ~]# mkisofs -o first.iso /home/tuser@tdomain.ru/Documents/13<br>[root@hvredos ~]# ls<br>13 first.iso 'MyTestX Tests'<br>[root@hvredos ~]# mkisofs -l -o first.iso /home/tuser@tdomain.ru/Documents/13<br>[root@hvredos ~]# ls<br>13 first.iso 'MyTestX Tests'<br>[root@hvredos ~]# mkisofs -D -l -o first.iso /home/tuser@tdomain.ru/Documents/13<br>[root@hvredos ~]# mkisofs -J -l -o first.iso /home/tuser@tdomain.ru/Documents/13<br>Warning: creating filesystem with Joliet extensions but without Rock Ridge<br>extensions. It is highly recommended to add Rock Ridge.<br>...<br>Joliet tree sort failed. The -joliet-long switch may help you.<br>[root@hvredos ~]# -joliet-long<br>[root@hvredos ~]# mkisofs -J -joliet-long -l -o first.iso /home/tuser@tdomain.ru/Documents/13<br>Warning: creating filesystem with Joliet extensions but without Rock Ridge<br>extensions. It is highly recommended to add Rock Ridge.<br>...<br>99.90% done, estimate finish Fri Jan 15 11:29:00 2021<br>Total translation table size: 0<br>Total rockridge attributes bytes: 0<br>Total directory bytes: 0<br>Path table size(bytes): 10<br><strong>Task:</strong><br>Если вы собираетесь записать образ на диск ubuntu DVD-RW/CD-RW необходимо сначала его очистить.<br>Здесь и ниже /dev/sr0 - адрес файла вашего привода.<br>first.iso - это файл образа, 16 - скорость записи, а опция -eject - заставляет извлечь диск из привода после записи.<br>Можно указывать скорость 4, 8 и 16. Желательно выбирать минимальную скорость, так диск запишется более качественно.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# cdrecord -dev=/dev/sr0 -v blank=fast<br>[root@hvredos ~]# cd Documents/<br>[root@hvredos ~]# ls<br>13 first.iso 'MyTestX Tests'<br>[root@hvredos ~]# cdrecord -dev=/dev/sr0 -speed=16 -eject -v first.iso<br><strong>Task:</strong><br>Установка клиента 1С.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# yum -y install webkitgtk3<br>[root@hvredos ~]# ls<br>1C_Enterprise83-client-8.3.14-17.x86_64.rpm<br>1C_Enterprise83-common-8.3.14-17.x86_64.rpm<br>1C_Enterprise83-server-8.3.14-17.x86_64.rpm<br>[root@hvredos ~]# yum -y install 1C_Enterprise83-*<br><strong>Task:</strong><br>Установка аналога paint.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# yum list | grep paint<br>kolourpaint.hvredos86 17.12.1-2.el7 base<br>kolourpaint.x86_64 17.12.1-2.el7 base<br>kolourpaint-libs.hvredos86 17.12.1-2.el7 base<br>kolourpaint-libs.x86_64 17.12.1-2.el7 base<br>[root@hvredos ~]# yum -y install kolourpaint<br><strong>Task:</strong><br>Установка Anydesk.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# tee /etc/yum.repos.d/AnyDesk-RHEL.repo &lt;&lt;EOF<br>&gt; [anydesk]<br>&gt; name=AnyDesk RHEL - stable<br>&gt; baseurl=http://rpm.anydesk.com/rhel/\$basearch/<br>&gt; gpgcheck=1<br>&gt; repo_gpgcheck=1<br>&gt; gpgkey=https://keys.anydesk.com/repos/RPM-GPG-KEY<br>&gt; EOF<br>[root@hvredos ~]# dnf makecache<br>[root@hvredos ~]# dnf install -y redhat-lsb-core<br>[root@hvredos ~]# dnf install anydesk<br>[root@hvredos ~]# rpm -qi anydesk<br>[root@hvredos ~]# systemctl status anydesk.service<br>[root@hvredos ~]# exit<br>[root@hvredos ~]# anydesk<br><strong>Task:</strong><br>Создание загрузочных носителей.<br># Администрирование локальных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# fdisk -l<br>...<br>Диск /dev/sdb: 3,61 GiB, 3880452096 байт, 7579008 секторов<br>Disk model: Silicon-Power4G<br>Единицы: секторов по 1 * 512 = 512 байт<br>Размер сектора (логический/физический): 512 байт / 512 байт<br>Размер I/O (минимальный/оптимальный): 512 байт / 512 байт<br>Тип метки диска: gpt<br>Идентификатор диска: 2BAC44AA-F36D-461C-B12A-D251E7E9373F<br>Устр-во  начало Конец Секторы Размер Тип<br>/dev/sdb1  2048 7578974 7576927 3,6G Microsoft basic data<br>[root@hvredos ~]# ls<br>Zorin-OS-16.1-Core-64-bit.iso<br>[root@hvredos ~]# dd if=Zorin-OS-16.1-Core-64-bit.iso of=/dev/sdb1 bs=8MB status=progress oflag=direct<br>3058237440 байт (3,1 GB, 2,8 GiB) скопирован, 659 s, 4,6 MB/s<br>382+1 записей получено<br>382+1 записей отправлено<br>3058237440 байт (3,1 GB, 2,8 GiB) скопирован, 659,39 s, 4,6 MB/s</p>