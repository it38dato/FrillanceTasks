<p>Services:<br># Interview<br># Администрирование баз данных.<br># Разработка баз данных.<br># Написание Sql запросов.<br><strong>Task:</strong><br>Выборка данных.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# SELECT * FROM travelers LIMIT 25;<br>starter=# SELECT surname FROM travelers OFFSET 15;<br>starter=# SELECT name, email FROM travelers FETCH FIRST 20 ROW ONLY;<br>starter=# SELECT name, surname FROM travelers ORDER BY name ASC;<br>starter=# SELECT name, email FROM travelers WHERE gender = 'Female';<br>starter=# SELECT * FROM travelers WHERE name IN ('Mark', 'Trisha', 'Raymond');<br>starter=# SELECT country, email FROM travelers WHERE name BETWEEN 'A' AND 'S';<br>starter=# SELECT email, surname FROM travelers WHERE email LIKE '%.net';<br><strong>Task:</strong><br>Базовая арифметика.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# SELECT min(price) FROM booking_n WHERE name LIKE '%sia';<br>starter=# SELECT max(price) FROM booking_n WHERE surname BETWEEN 'S' AND 'X';<br>starter=# SELECT avg(price) from booking_n;<br>starter=# SELECT sum(price) FROM booking_n;<br><strong>Task:</strong><br>Дата и время.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# SELECT * FROM NOW();<br>starter=# SELECT EXTRACT (SECOND FROM NOW());<br><strong>Task:</strong><br>Первичный ключ.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# ALTER TABLE travelers ADD login VARCHAR(25);<br>starter=# ALTER TABLE travelers DROP login;<br><strong>Task:</strong><br>Ограничения.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# ALTER TABLE travelers ADD CONSTRAINT id_unique UNIQUE(id);<br>starter=# ALTER TABLE travelers ADD CONSTRAINT gender_check CHECK(gender = 'Female' OR gender = 'Male');<br><strong>Task:</strong><br>UPSERT и обновление таблиц.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# UPDATE booking_n SET name  = 'Max' WHERE id = 1;<br>starter=# UPDATE booking_n SET departure_from  = 'Russia', arriving_to = 'Kazakhstan' WHERE id = 1;<br>starter=# INSERT INTO booking_n (id,name,surname,departure_from,arriving_to,price) VALUES (1,'John','Doe','USA','UK','$200') ON CONFLICT (id) DO NOTHING;<br>starter=# INSERT INTO booking_n (id,name,surname,departure_from,arriving_to,price) VALUES (1,'John','Doe','USA','UK','$200') ON CONFLICT (id) DO UPDATE SET departure_from = 'EXCLUDED.departure_from;<br><strong>Task:</strong><br>Внешние ключи.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# ALTER TABLE booking_n ADD new_booking_id BIGSERIAL REFERENCES booking(id);<br><strong>Task:</strong><br>соединение таблиц<br>Таблица "Прайс-лист":<br>Товар |      Цена<br>Стол красный | 5000<br>Стол синий | 6000<br>Стул черный | 1500<br>Кресло зеленое | 4500<br>Кресло оранжевое | 6500<br>Остатки номенклатуры:<br>Товар | Количество<br>Кресло оранжевое | 15<br>Стул черный | 20<br>Стул коричневый | 1<br>Итоговая таблица:      <br>Товар   Количество | Цена<br><strong>Task:</strong><br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# SELECT * FROM travelers LEFT JOIN booking_n ON travelers.id = booking_n.id;<br>Товар | Количество | Цена  <br>Стол красный |  | 5000    <br>Стол синий |  | 6000      <br>Стул черный | 20 | 1500   <br>Кресло зеленое | 4500     <br>Кресло оранжевое | 15 | 6500    <br>starter=# SELECT * FROM travelers RIGHT JOIN booking_n ON travelers.id = booking_n.id;<br>Товар | Количество | Цена <br>Кресло оранжевое | 15 | 6500    <br>Стул черный | 20 | 1500   <br>Стул коричневый | 1 |     <br>Внутреннее:<br>Товар | Количество | Цена    <br>Стул черный | 20 | 1500   <br>Кресло оранжевое | 15 | 6500    <br>starter=# SELECT * FROM travelers FULL JOIN booking_n ON travelers.id = booking_n.id;       <br>Стул черный | 20 | 1500   <br>Кресло оранжевое | 15 | 6500    <br>Стол красный |  | 5000    <br>Стол синий |  | 6000      <br>Кресло зеленое |  | 4500  <br>Стул коричневый | 1 |     <br>starter=# SELECT * FROM travelers CROSS JOIN booking_n ON travelers.id = booking_n.id;<br>Товар Л | Цена | Товар П | Количество<br>Стол красный | 5000 | Кресло оранжевое | 15<br>Стол красный | 5000 | Стул черный | 20<br>Стол красный | 5000 | Стул коричневый | 1<br>Стол синий | 6000 | Кресло оранжевое | 15<br>Стол синий | 6000 | Стул черный | 20<br>Стол синий | 6000 | Стул коричневый | 1<br>Стул черный | 1500 | Кресло оранжевое | 15<br>Стул черный | 1500 | Стул черный | 20<br>Стул черный | 1500 | Стул коричневый | 1<br>Кресло зеленое | 4500 | Кресло оранжевое | 15<br>Кресло зеленое | 4500 | Стул черный | 20<br>Кресло зеленое | 4500 | Стул коричневый | 1<br>Кресло оранжевое | 6500 | Кресло оранжевое | 15<br>Кресло оранжевое | 6500 | Стул черный | 20<br>Кресло оранжевое | 6500 |  Стул коричневый | 1<br><strong>Task:</strong><br>Экспорт в CSV.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# SELECT * FROM travelers WHERE id &lt; 50;<br>starter=# \copy (SELECT * FROM travelers WHERE id &lt; 50) TO 'C:\Users\david\Documents\EngineerOfThe2ndCategory\Sberbank\Basics of the PostgreSQL language'  DELIMITER ','  CSV HEADER;<br>starter=# \copy (SELECT * FROM travelers WHERE id &lt; 50) TO 'C:/Users/david/Documents/EngineerOfThe2ndCategory/Sberbank/Basics of the PostgreSQL language/sample.csv'  DELIMITER ','  CSV HEADER;<br><strong>Task:</strong><br>Строковые функции.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>select UPPER('Vasya') up_name, LOWER('Vasya') lo_name,<br>&nbsp;&nbsp;  '!'||'&nbsp;&nbsp;Vasya&nbsp;&nbsp; '||'!' no_trim,<br>&nbsp;&nbsp;  '!'||TRIM('&nbsp;&nbsp;Vasya&nbsp;&nbsp; ')||'!' tr_name, <br>&nbsp;&nbsp;  '!'||LTRIM('&nbsp;&nbsp;Vasya&nbsp;&nbsp; ')||'!' ltr, <br>&nbsp;&nbsp;  '!'||RTRIM('&nbsp;&nbsp;Vasya&nbsp;&nbsp; ')||'!' rtr,<br>&nbsp;&nbsp;  'Vasya'||' '||'Petrov' name<br>select substr('123456',2) sub_1,<br>&nbsp;&nbsp;  substr('123456',2,3) sub_2,<br>&nbsp;&nbsp;  substr('123456',-2) sub_3,<br>&nbsp;&nbsp;  substr('123456',4,-2) sub_4<br>select replace('HeLLo worlld','ll','!!') rep, length('123456') len<br><strong>Task:</strong><br>Предположите, какую базу данных вы бы выбрали для приложения —  многопользовательской онлайн-стратегии в средневековом сеттинге, где можно развивать замки и захватывать территории противников?<br># Interview.<br><strong>Decision:</strong><br>стоит учитывать несколько факторов: возможность легко масштабировать систему; структура данных — если вы планируете активно развивать свое приложение, то она вряд ли будет жёсткой; необходимость реализации транзакций; отсутствие (или очень небольшое число) сложных аналитических запросов; работа под смешанной нагрузкой.<br><strong>Task:</strong><br>Чем Реляционная бд отличается от Нереляционной бд?<br># Interview.<br><strong>Decision:</strong><br>Реляционные предназначены для хранения структурированных данных, способных представлять объекты из окружающего физического мира. К примеру, в такую БД можно включить сведения о конкретном человеке или о товарах, добавленных потенциальным покупателем в корзину. Такие данные можно группировать в специальных таблицах.<br>Нереляционные базы хранящаяся информация напрямую зависит от особенностей самой базы данных. К примеру, в случае с документоориентированной БД информация может быть представлена в виде иерархии и описывать различные объекты с разными параметрами.<br>В этом заключается главное отличие NoSQL от SQL и ее же преимущество. Такие базы дают возможность хранить почти неограниченные по объему данные в виде одной сущности. В SQL для хранения большого объема данных необходимо создание множества отдельных, но связанных между собой таблиц.<br><strong>Task:</strong><br>Перенести базу данных на другой физический диск.<br># Администрирование баз данных.<br><strong>Decision:</strong><br>root@aw:/# systemctl stop postgresql<br>root@aw:/# -i -u postgres<br>root@aw:/# cp -r 14 14.backup<br>root@aw:/# ls -l<br>итого 8<br>drwxr-xr-x 3 postgres postgres 4096 фев 25 19:33 14<br>drwxr-xr-x 3 postgres postgres 4096 фев 25 19:57 14.backup<br>root@aw:/# mount /dev/sdc1 /var/lib/postgresql/14<br>root@aw:/# cp -pr /var/lib/postgresql/14.backup /var/lib/postgresql/14/<br>root@aw:/# mv /var/lib/postgresql/14/14.backup /var/lib/postgresql/14/14<br>root@aw:/# ls -l /var/lib/postgresql/14<br>итого 87992628<br>drwxr-xr-x 3 postgres postgres4096 фев 25 19:57 14<br>drwx------ 2 root root 16384 фев 21 20:50 lost+found<br>-rw------- 1 tuser tuser 90104397824 фев 24 19:44 ubuntu22.04.qcow2<br>root@aw:/# umount /var/lib/postgresql/14<br>root@aw:/# mount /dev/sdc1 /var/lib/postgresql<br>root@aw:/# systemctl start postgresql<br>root@aw:/# -u tuser psql -d tdb<br># \d<br> List of relations<br>Schema | Name | Type | Owner<br>--------+--------+-------+-------<br>public | cities | table | tuser<br>(1 row)<br># CREATE TABLE countries (<br> namevarchar(80),<br> locationpoint<br>);<br># exit<br>root@aw:/# systemctl stop postgresql<br>root@aw:/# umount /var/lib/postgresql<br>root@aw:/# systemctl start postgresql<br><strong>Source:</strong><br># https://etogeek.dev/posts/move-psql/ - Перенос базы.<br># https://www.linux.org.ru/forum/general/8186570 - копирование файлов с правами и пользователями. <br><strong>Task:</strong><br>Создание и подключение к БД.<br># Администрирование баз данных.<br><strong>Decision:</strong><br>postgres-# \! chcp 1251<br>postgres-# \l<br>postgres-# CREATE DATABASE starter;<br>postgres-# DROP DATABASE starter;<br>postgres-# CREATE DATABASE starter;<br>postgres-# \c starter<br><strong>Task:</strong><br>Создание и удаление таблиц.<br># Разработка баз данных.<br><strong>Decision:</strong><br>starter-# CREATE TABLE student_auto (<br>id INT,<br>name VARCHAR(50),<br>surname VARCHAR(50),<br>gender VARCHAR(50),<br>mobile VARCHAR(50),<br>birthday DATE<br>);<br>starter-# DROP TABLE student_auto;<br>starter-# CREATE TABLE student_auto (<br>id INT,<br>name VARCHAR(50),<br>surname VARCHAR(50),<br>gender VARCHAR(50),<br>mobile VARCHAR(50),<br>birthday DATE<br>);<br>starter-# \d student_auto;<br><strong>Task:</strong><br>Наполнение данными.<br># Разработка баз данных.<br><strong>Decision:</strong><br>starter=# SELECT * FROM student;<br>starter=# INSERT INTO student(name, surname) VALUES ('Michael', 'Scott');<br>starter=# SELECT * FROM student;<br><strong>Task:</strong><br>Изменить пароль в базе.<br># Администрирование баз данных.<br><strong>Decision:</strong><br>tuser@kvmubuntu:~$ mysql -u root -p<br>mysql&gt; SELECT user,authentication_string,plugin,host FROM mysql.user;<br>mysql&gt; ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'tP@ssw0rd';<br>mysql&gt; \q<br><strong>Task:</strong><br>Миграция базы. <br>- Бэкап.<br>- Перенос.<br>- Восстановление.<br># Администрирование баз данных.<br><strong>Decision:</strong><br>tuser@kvmubuntu:~$ mysql -V<br>mysql Ver 8.0.39-0ubuntu0.22.04.1 for Linux on x86_64 ((Ubuntu))<br>tuser@kvmubuntu:~$ mysql -u tuser -p<br>mysql&gt; SELECT User, Host FROM mysql.user;<br>+------------------+-----------+<br>| User | Host |<br>+------------------+-----------+<br>| root | localhost |<br>| tuser | localhost |<br>+------------------+-----------+<br>6 rows in set (0.43 sec)<br>mysql&gt; SHOW DATABASES;<br>+--------------------+<br>| Database |<br>+--------------------+<br>| tbase |<br>+--------------------+<br>6 rows in set (0.80 sec)<br>mysql&gt; exit<br>root@kvmubuntu:~# mysqldump -u tuser -p --opt tbase &gt; datamysql.sql<br>root@kvmubuntu:~# ls datamysql.sql<br>datamysql.sql<br>root@aw:/# scp -r datamysql.sql tuser@tipubuntu:/var/www/dato138it/<br>tuser@kvmubuntu:~$ mysql -V<br>mysql Ver 8.0.34-0ubuntu0.22.04.1 for Linux on x86_64 ((Ubuntu))<br>tuser@kvmubuntu:~$ mysql -u tuser -p<br>tuser@kvmubuntu:~$ mysql -u tuser -p tbase &lt; datamysql.sql<br>tuser@kvmubuntu:~$ mysql -u tuser -p<br>mysql&gt; show databases;<br>+--------------------+<br>| Database |<br>+--------------------+<br>| tbase |<br>| information_schema |<br>| performance_schema |<br>+--------------------+<br>mysql&gt; USE tbase;<br><strong>Source:</strong><br># https://www.digitalocean.com/community/tutorials/how-to-install-linux-apache-mysql-php-lamp-stack-on-ubuntu-22-04<br># https://losst.pro/ustanovka-chrome-v-ubuntu-18-04?ysclid=lmdflkvc3v463974954<br># https://qna.habr.com/q/439469?ysclid=lmdgkb49q827401606<br># https://steptuser.org/course/63054/syllabus<br># https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-phpmyadmin-on-ubuntu-20-04<br># https://www.tutsmake.com/how-to-install-lamp-apache-mysql-php-in-ubuntu-22-04/<br># https://www.php.net/manual/ru/faq.html.php<br># https://www.8host.com/blog/kak-rabotayut-stroki-v-php/<br># https://www.youtube.com/watch?v=FxwPQkP3OGY&t=611s<br># https://timeweb.com/ru/community/articles/kak-ustanovit-stek-lamp-na-ubuntu-20-04<br># https://wiki.merionet.ru/articles/perenos-bazy-dannyx-mysql-so-starogo-na-novyj-server<br><strong>Task:</strong><br>Запустить Sqlite3.<br># Администрирование баз данных.<br><strong>Decision:</strong><br>root@kvmubuntu:~# apt install sqlite3<br>root@kvmubuntu:~# sqlite3 db.sqlite3<br>sqlite&gt; .tables<br>auth_group django_content_type <br>auth_group_permissions django_migrations <br>auth_permission django_session <br>auth_user portfolio_category <br>auth_user_groups portfolio_place <br>auth_user_user_permissions portfolio_portfolio <br>django_admin_log <br>sqlite&gt; select * from portfolio_place;<br>...<br>sqlite&gt; .q<br><strong>Source:</strong><br># https://www.guru99.com/ru/sqlite-database.html - SQLite СОЗДАТЬ базу данных.<br><strong>Task:</strong><br>нагрузка с БД<br># Interview<br><strong>Decision:</strong><br>Все запросы, которые можно прочитать select будут отправлять в read replica. А запросы update - отправлять в мастер.<br><strong>Task:</strong><br>лимит БД<br># Interview<br><strong>Decision:</strong><br>Сделать нагрузочный тест со средним sql запросом.<br><strong>Task:</strong><br>функции СУБД<br># Interview<br><strong>Decision:</strong><br>Обновление ПО.<br>Мониторинг хостов и БД.<br>Резервное копирование БД.<br>Репликация данных.<br><strong>Task:</strong><br>Синхронная репликация<br># Interview<br><strong>Decision:</strong><br>медленнее асинхронной.<br>надёжнее для сохранения данных.<br><strong>Task:</strong><br>репликация моментального снимка<br># Interview<br><strong>Decision:</strong><br>позволяет распространять данные на определенный момент времени. Снимок пересылается и более не обновляется процессом репликации, пока не будет сделан новый снимок, который будет отправлен подписчику. Репликация моментального снимка обычно используется для формирования схемы статей и связанных с ней данных у подписчика для репликации транзакций и репликации слиянием.<br><strong>Task:</strong><br>репликация транзакций<br># Interview<br><strong>Decision:</strong><br>может обеспечивать потоковое изменение данных с низким уровнем задержек, выполняемое издателем для одного или более подписчиков.<br><strong>Task:</strong><br>репликация слиянием<br># Interview<br><strong>Decision:</strong><br>позволяет подписчику напрямую модифицировать данные подписки (статьи) и затем синхронизировать модифицированные строки с издателем. Как указывалось ранее, подписчики могут быть некоторое время отключены от коммуникаций, периодически подключаться и синхронизировать данные по запросу. В этот момент их изменения синхронизируются с издателем и наоборот. Это может привести к конфликту данных, когда издатель и один или более подписчиков пытаются модифицировать одни и те же данные.<br><strong>Task:</strong><br>Таблица students.<br>Создадим таблицу students, задав атрибуты group_id (числовое значение), name (строковый тип) и dept_id (числовое значение)<br># Разработка Баз данных.<br><strong>Decision:</strong><br>starter=# create table students (<br>starter(# group_id integer,<br>starter(# name varchar(50),<br>starter(# dept_id int);<br><strong>Task:</strong><br>Создать таблицу da_course<br>с 5 полями:<br>course_nm -&gt; тип строка<br>student_id -&gt; тип число<br>course_begin_dt -&gt; тип дата<br>course_end_dt -&gt; тип дата<br>schedule_time -&gt; тип время<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# create table da_course (<br>starter(# cours_nm varchar,<br>starter(# student_id int,<br>starter(# course_begin_dt date,<br>starter(# cours_end_dt date,<br>starter(# shedule_time time);<br><strong>Task:</strong><br>Создать таблицу da_course_new, по аналогии с da_course, но сразу заполнить строку данными.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# create table<br>starter-# da_course_new_1 as select<br>starter-#   'DE13 SQL' course_nm,<br>starter-#   100 student_id,<br>starter-#   '2022-11-18' course_begin_dt,<br>starter-#   null course_end_dt,<br>starter-#   '19:00' schedule_time;<br>SELECT 1<br>starter=# select * from da_course_new_1;<br>course_nm | student_id | course_begin_dt | course_end_dt | schedule_time<br>-----------+------------+-----------------+---------------+---------------<br>DE13 SQL |&nbsp;&nbsp;100 | 2022-11-18   |&nbsp;&nbsp;   | 19:00<br>(1 строка)<br><strong>Task:</strong><br>Создать таблицу students_new по аналогии с таблицей students и загрузить в нее сотрудников из таблицы employees, работающих в 30 и 60 департаментах. Зачислить их в группу номер 1.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>create table<br>students_new as select<br>  1 group_id,<br>  first_name name,<br>  department_id dept_id<br>from employees<br>where dept_id in (30, 60);<br><strong>Task:</strong><br>Добавьте в таблицу da_course поле my_name тип строка длиной 50 и значением по умолчанию.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>alter table da_course add my_name varchar(50) default 'unnamed';<br><strong>Task:</strong><br>Переименуйте поле my_name в student_nm.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# alter table da_course<br>starter-# rename column my_name to student_nm;<br><strong>Task:</strong><br>Переименуйте табличку da_course в da08_course<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# alter table da_course<br>starter-# rename to da08_course;<br><strong>Task:</strong><br>Добавить в таблицу students студента по имени Alex из 100 департамента и зачислить его во 2 группу<br># Написание Sql запросов.<br><strong>Decision:</strong><br>INSERT INTO students<br>(group_id, name, dept_id)<br>VALUES (2, 'Alex', 100)<br><strong>Task:</strong><br>Вставьте в таблицу da08_course 1 строку<br>course_nm -&gt; 'SQL Base'<br>student_cnt -&gt; 30<br>course_begin_dt -&gt; '2022-10-10'<br>course_end_dt -&gt; '5999-12-31'<br>schedule_time -&gt; '10:00:00'<br>Придумайте и вставьте еще одну строку<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# insert into da08_course (cours_nm, student_id, course_begin_dt, cours_end_dt, shedule_time)<br>starter-# values ('SQL Base', 30, '2022-10-10', '2999-12-31', '10:00');<br>starter=# insert into da08_course (cours_nm, student_id, course_begin_dt, cours_end_dt, shedule_time)<br>starter-# values ('SQL Edv', 40, '2022-11-18', '2999-12-31', '19:00');<br>starter=# insert into da08_course (cours_nm, student_id, course_begin_dt, cours_end_dt, shedule_time)<br>starter-# values ('Python Base', 30, '2022-12-10', '2999-12-31', '10:00'),<br>starter-# ('Python Edv', 40, '2023-01-18', '2999-12-31', '19:00');<br><strong>Task:</strong><br>Изменить группу, в которой обучается Алекс, на 3 (таблица students)<br># Написание Sql запросов.<br><strong>Decision:</strong><br>UPDATE students<br>SET group_id = 3<br>WHERE name = 'Alex';<br><strong>Task:</strong><br>В таблице da08_course обновите название курса 'SQL Base' на 'Base SQL'<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# update da08_course<br>starter-# set cours_nm = 'Base SQL'<br>starter-# where cours_nm='SQL Base';<br><strong>Task:</strong><br>В таблице da08_course обновите для всех строк поле окончания курса на '2999-12-31'<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# update da08_course set cours_end_dt = '2888-12-31';<br><strong>Task:</strong><br>Вставим в таблицу students новую запись (3, 'Barankin', 10);<br>Удалим из таблицы students все строки, где номер департамента больше 30;<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# insert into students<br>starter-# values (3, 'Barankin', 10);<br>starter=# delete from students<br>starter-# where dept_id&gt;30;<br><strong>Task:</strong><br>Удалите из таблицы da08_course все записи<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# delete from da08_course;<br><strong>Task:</strong><br>Таблица persons. необходимо создать таблицу persons с полями:<br>-id,<br>-name,<br>-age,<br>-order_total<br>-добавьте 5 записей;<br>удалите записи, в которых возраст менее 18 лет ;<br>для конкретного id увеличьте order_total на 500;<br>уменьшите возраст на 2 года всем тем, у кого последняя буква в имени а;<br>удалите таблицу persons;<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# create table persons (<br>starter(# id serial,<br>starter(# name varchar(50),<br>starter(# age smallint,<br>starter(# order_total int<br>starter(# );<br>starter=# insert into persons<br>starter-#   (name,<br>starter(#   age,<br>starter(#   order_total)<br>starter-# values<br>starter-#   ('Dmitry', 34, 200),<br>starter-#   ('Monika', 24, 205),<br>starter-#   ('Moko', 45, 234),<br>starter-#   ('Yoko', 52, 213),<br>starter-#   ('Amy', 27, 231);<br>starter=# delete from persons where age&lt;30;<br>starter=# update persons<br>starter-# set order_total = order_total + 500<br>starter-# where id = 2;<br>starter=# UPDATE persons SET age = age - 2 WHERE name like '%o' ;<br><strong>Task:</strong><br>Таблица Алфавит. Создать таблицу alphabet c полем letter char(1);<br>Вставить в нее все буквы русского алфавита;<br>Добавить новое поле letter_type varchar(20);<br>Заполните это поле типом буквы (гласная или согласная);<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# create table alphabet (letter char(1));<br>starter=# insert into alphabet (letter) values ('А');<br>starter=# insert into alphabet (letter) values ('Б');<br>starter=# insert into alphabet (letter) values ('В');<br>starter=# insert into alphabet (letter) values ('Г');<br>starter=# insert into alphabet (letter) values ('Д');<br>starter=# insert into alphabet (letter) values ('Ё');<br>starter=# insert into alphabet (letter) values ('Е');<br>starter=# insert into alphabet (letter) values ('Ж');<br>starter=# insert into alphabet (letter) values ('З');<br>starter=# insert into alphabet (letter) values ('И');<br>starter=# insert into alphabet (letter) values ('Й');<br>starter=# insert into alphabet (letter) values ('К');<br>starter=# insert into alphabet (letter) values ('Л');<br>starter=# insert into alphabet (letter) values ('М');<br>starter=# insert into alphabet (letter) values ('Н');<br>starter=# insert into alphabet (letter) values ('О');<br>starter=# insert into alphabet (letter) values ('П');<br>starter=# insert into alphabet (letter) values ('Р');<br>starter=# insert into alphabet (letter) values ('С');<br>starter=# insert into alphabet (letter) values ('Т');<br>starter=# insert into alphabet (letter) values ('У');<br>starter=# insert into alphabet (letter) values ('Ф');<br>starter=# insert into alphabet (letter) values ('Х');<br>starter=# insert into alphabet (letter) values ('Ц');<br>starter=# insert into alphabet (letter) values ('Ч');<br>starter=# insert into alphabet (letter) values ('Ш');<br>starter=# insert into alphabet (letter) values ('Щ');<br>starter=# insert into alphabet (letter) values ('Ъ');<br>starter=# insert into alphabet (letter) values ('Ы');<br>starter=# insert into alphabet (letter) values ('Ь');<br>starter=# insert into alphabet (letter) values ('Э');<br>starter=# insert into alphabet (letter) values ('Ю');<br>starter=# insert into alphabet (letter) values ('Я');<br>starter=# ALTER TABLE alphabet<br>starter-# add letter_type varchar(20);<br>starter=# select * from alphabet;<br>letter | letter_type<br>--------+-------------<br>А   | гласная<br>Б   | согласная<br>В   | согласная<br>Г   | согласная<br>Д   | согласная<br>Ё   | гласная<br>Е   | гласная<br>Ж   | согласная<br>З   | согласная<br>И   | гласная<br>Й   | согласная<br>К   | согласная<br>Л   | согласная<br>М   | согласная<br>Н   | согласная<br>О   | гласная<br>П   | согласная<br>Р   | согласная<br>С   | согласная<br>Т   | согласная<br>У   | гласная<br>Ф   | согласная<br>Х   | согласная<br>Ц   | согласная<br>Ч   | согласная<br>Ш   | согласная<br>Щ   | согласная<br>Ъ   | нет звуков<br>Ы   | гласная<br>Ь   | нет звуков<br>Э   | гласная<br>Ю   | гласная<br>Я   | гласная<br>(33 строки)<br><strong>Task:</strong><br>Таблица Классы.<br>Создать таблицу classes;<br>Вставьте в нее все записи из приложенного файла (для таблицы classes);<br>Для каждого класса выведите уровень успеваемости. Если среднегодовая отметка  выше 3, то уровень успеваемости принимает значение 'выше среднего', иначе 'ниже   среднего';<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# create table classes<br>starter-# (class_num varchar(4),<br>starter(# avg_year_mark int,<br>starter(# avg_month_mark int,<br>starter(# avg_term_mark int);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('1 А', 4, 4, 5);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('1 Б', 5, 5, 4);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('2 А', 5, 5, 4);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('2 Б', NULL, 5, 5);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('3 А', 4, 4, 5);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('3 Б', 4, 3, 4);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('4 А', 5, 4, 3);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('4 Б', 5, 4, 4);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('5 А', 5, 4, 5);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('5 Б', 4, 5, 3);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('6 А', 3, 3, 3);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('6 Б', 4, 5, 4);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('7 А', 5, 5, 4);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('7 Б', 4, 3, 4);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('8 А', 3, 3, 4);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('8 Б', 5, 4, 5);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('9 А', 3, 3, 4);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('9 Б', NULL, 5, 5);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('10 А', 3, 4, 3);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('10 Б', 5, 5, 4);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('11 А', 5, 4, 4);<br>starter=# insert into classes (class_num, avg_year_mark, avg_month_mark, avg_term_mark) values ('11 Б', 5, 5, 5);<br>starter=# select * from classes;<br>class_num | avg_year_mark | avg_month_mark | avg_term_mark<br>-----------+---------------+----------------+---------------<br>1 А   |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   5<br>1 Б   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4<br>2 А   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4<br>2 Б   |&nbsp;&nbsp;   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5<br>3 А   |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   5<br>3 Б   |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   4<br>4 А   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   3<br>4 Б   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   4<br>5 А   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   5<br>5 Б   |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   3<br>6 А   |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   3<br>6 Б   |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4<br>7 А   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4<br>7 Б   |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   4<br>8 А   |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   4<br>8 Б   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   5<br>9 А   |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   4<br>9 Б   |&nbsp;&nbsp;   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5<br>10 А   |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   3<br>10 Б   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4<br>11 А   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   4<br>11 Б   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5<br>(22 строки)<br>starter=# select<br>starter-# class_num,<br>starter-# avg_year_mark,<br>starter-# case<br>starter-#   when avg_year_mark&gt;3 and avg_year_mark&lt;=5<br>starter-#   then 'выше среднего'<br>starter-#   when avg_year_mark&lt;=3 and avg_year_mark&gt;=1<br>starter-#   then 'ниже среднего'<br>starter-#   when avg_year_mark is null<br>starter-#   then 'отметка не выставлена'<br>starter-#   else 'ошибка значения'<br>starter-# end as progress<br>starter-# from classes;<br>class_num | avg_year_mark |   progress<br>-----------+---------------+-----------------------<br>1 А   |&nbsp;&nbsp;   4 | выше среднего<br>1 Б   |&nbsp;&nbsp;   5 | выше среднего<br>2 А   |&nbsp;&nbsp;   5 | выше среднего<br>2 Б   |&nbsp;&nbsp;   | отметка не выставлена<br>3 А   |&nbsp;&nbsp;   4 | выше среднего<br>3 Б   |&nbsp;&nbsp;   4 | выше среднего<br>4 А   |&nbsp;&nbsp;   5 | выше среднего<br>4 Б   |&nbsp;&nbsp;   5 | выше среднего<br>5 А   |&nbsp;&nbsp;   5 | выше среднего<br>5 Б   |&nbsp;&nbsp;   4 | выше среднего<br>6 А   |&nbsp;&nbsp;   3 | ниже среднего<br>6 Б   |&nbsp;&nbsp;   4 | выше среднего<br>7 А   |&nbsp;&nbsp;   5 | выше среднего<br>7 Б   |&nbsp;&nbsp;   4 | выше среднего<br>8 А   |&nbsp;&nbsp;   3 | ниже среднего<br>8 Б   |&nbsp;&nbsp;   5 | выше среднего<br>9 А   |&nbsp;&nbsp;   3 | ниже среднего<br>9 Б   |&nbsp;&nbsp;   | отметка не выставлена<br>10 А   |&nbsp;&nbsp;   3 | ниже среднего<br>10 Б   |&nbsp;&nbsp;   5 | выше среднего<br>11 А   |&nbsp;&nbsp;   5 | выше среднего<br>11 Б   |&nbsp;&nbsp;   5 | выше среднего<br>(22 строки)<br><strong>Task:</strong><br>Для каждого класса из таблицы classes выведите наименьшее из трех средних значений (Если число не заполнено, то вместо него используется число 3)<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# select<br>starter-# class_num,<br>starter-# avg_year_mark,<br>starter-# avg_month_mark,<br>starter-# avg_term_mark,<br>starter-# case<br>starter-#   when coalesce(avg_year_mark,3)&lt;=coalesce(avg_month_mark ,3)<br>starter-#   and coalesce(avg_year_mark,3)&lt;=coalesce(avg_term_mark,3)<br>starter-#&nbsp;&nbsp; then coalesce(avg_year_mark,3)<br>starter-#   when coalesce(avg_month_mark,3)&lt;=coalesce(avg_year_mark ,3)<br>starter-#   and coalesce(avg_month_mark,3)&lt;=coalesce(avg_term_mark,3)<br>starter-#&nbsp;&nbsp; then coalesce(avg_month_mark,3)<br>starter-#   else coalesce(avg_term_mark,3)<br>starter-# end min_val<br>starter-# from classes;<br>class_num | avg_year_mark | avg_month_mark | avg_term_mark | min_val<br>-----------+---------------+----------------+---------------+---------<br>1 А   |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   5 |   4<br>1 Б   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |   4<br>2 А   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |   4<br>2 Б   |&nbsp;&nbsp;   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5 |   3<br>3 А   |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   5 |   4<br>3 Б   |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   4 |   3<br>4 А   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   3 |   3<br>4 Б   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   4 |   4<br>5 А   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   5 |   4<br>5 Б   |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   3 |   3<br>6 А   |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   3 |   3<br>6 Б   |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |   4<br>7 А   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |   4<br>7 Б   |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   4 |   3<br>8 А   |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   4 |   3<br>8 Б   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   5 |   4<br>9 А   |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   4 |   3<br>9 Б   |&nbsp;&nbsp;   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5 |   3<br>10 А   |&nbsp;&nbsp;   3 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   3 |   3<br>10 Б   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |   4<br>11 А   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   4 |&nbsp;&nbsp;   4 |   4<br>11 Б   |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5 |&nbsp;&nbsp;   5 |   5<br>starter=# select<br>starter-# case<br>starter-#   when avg_year_mark&lt;=avg_month_mark<br>starter-#   and coalesce(avg_year_mark,3)&lt;=coalesce(avg_term_mark,3)<br>starter-#&nbsp;&nbsp; then coalesce(avg_year_mark,3)<br>starter-#   when coalesce(avg_month_mark,3)&lt;=coalesce(avg_year_mark ,3)<br>starter-#   and coalesce(avg_month_mark,3)&lt;=coalesce(avg_term_mark,3)<br>starter-#&nbsp;&nbsp; then coalesce(avg_month_mark,3)<br>starter-#   when coalesce(avg_term_mark,3)&lt;=coalesce(avg_month_mark ,3)<br>starter-#   and coalesce(avg_term_mark,3)&lt;=coalesce(avg_year_mark,3)<br>starter-#&nbsp;&nbsp; then coalesce(avg_term_mark,3)<br>starter-# end min_val<br>starter-# from<br>starter-# (select<br>starter(#   class_num,<br>starter(#   coalesce(avg_year_mark,3) as avg_year_mark,<br>starter(#   coalesce(avg_month_mark,3) as avg_month_mark,<br>starter(#   coalesce(avg_term_mark,3) as avg_term_mark<br>starter(# from classes) as minval;<br>min_val<br>---------<br>4<br>4<br>4<br>3<br>4<br>3<br>3<br>4<br>4<br>3<br>3<br>4<br>4<br>3<br>3<br>4<br>3<br>3<br>3<br>4<br>4<br>5<br>(22 строки)<br><strong>Task:</strong><br>Таблица circles.<br>Создать таблицу circles;<br>Вставьте в нее все записи из приложенного файла (для таблицы circles);<br>Для каждого круга рассчитайте и выведите требуемый показатель:<br>l (или L) – длина окружности (2*pi*R);<br>s (или S) – площадь круга (pi*R*R)<br>v (или V) – объем шара ((4/3)*pi*R*R*R)<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# create table circles<br>starter-# (id varchar(20),<br>starter(# radius int,<br>starter(# value_cd varchar(5));<br>starter=# insert into circles (id, radius, value_cd) values ('MU0000000020', 40, 's');<br>starter=# insert into circles (id, radius, value_cd) values ('MU0000000060', 44, 'L');<br>starter=# insert into circles (id, radius, value_cd) values ('MT0000000075', 15, 'V');<br>starter=# insert into circles (id, radius, value_cd) values ('MT0000000010', 17, 's');<br>starter=# insert into circles (id, radius, value_cd) values ('MU0000000048', 36, 'v');<br>starter=# insert into circles (id, radius, value_cd) values ('MU0000000077', 33, 'l');<br>starter=# insert into circles (id, radius, value_cd) values ('MU0000000088', 46, 's');<br>starter=# insert into circles (id, radius, value_cd) values ('MU0000000056', 19, 'V');<br>starter=# insert into circles (id, radius, value_cd) values ('MP0000000090', 42, 'v');<br>starter=# insert into circles (id, radius, value_cd) values ('MU0000000084', 49, 'S');<br>starter=# insert into circles (id, radius, value_cd) values ('MU0000000030', 45, 'v');<br>starter=# insert into circles (id, radius, value_cd) values ('MP0000000018', 37, 'S');<br>starter=# insert into circles (id, radius, value_cd) values ('MU0000000026', 37, 'l');<br>starter=# insert into circles (id, radius, value_cd) values ('MU0000000053', 24, 'V');<br>starter=# insert into circles (id, radius, value_cd) values ('MB0000000079', 8, 'NULL');<br>starter=# insert into circles (id, radius, value_cd) values ('MU0000000042', 47, 's');<br>starter=# insert into circles (id, radius, value_cd) values ('MU0000000056', 42, 'l');<br>starter=# insert into circles (id, radius, value_cd) values ('MT0000000142', 40, 'v');<br>starter=# insert into circles (id, radius, value_cd) values ('MT0000000065', 34, 'V');<br>starter=# insert into circles (id, radius, value_cd) values ('MT000000006', 47, 's');<br>starter=# insert into circles (id, radius, value_cd) values ('MU000000009', 28, 'S');<br>starter=# insert into circles (id, radius, value_cd) values ('MU0000000039', 20, 'L');<br>starter=# select * from circles;<br>id   | radius | value_cd<br>--------------+--------+----------<br>MU0000000020 |   40 | s<br>MU0000000060 |   44 | L<br>MT0000000075 |   15 | V<br>MT0000000010 |   17 | s<br>MU0000000048 |   36 | v<br>MU0000000077 |   33 | l<br>MU0000000088 |   46 | s<br>MU0000000056 |   19 | V<br>MP0000000090 |   42 | v<br>MU0000000084 |   49 | S<br>MU0000000030 |   45 | v<br>MP0000000018 |   37 | S<br>MU0000000026 |   37 | l<br>MU0000000053 |   24 | V<br>MB0000000079 |   8 | NULL<br>MU0000000042 |   47 | s<br>MU0000000056 |   42 | l<br>MT0000000142 |   40 | v<br>MT0000000065 |   34 | V<br>MT000000006 |   47 | s<br>MU000000009 |   28 | S<br>MU0000000039 |   20 | L<br>(22 строки)<br>starter=# select<br>starter-# id,<br>starter-# case<br>starter-#   when value_cd in ('l','L')<br>starter-#   then radius*3.14*2<br>starter-#   when value_cd in ('s','S')<br>starter-#   then radius*radius*3.14<br>starter-#   when value_cd in ('v','V')<br>starter-#   then radius*radius*radius*3.14*(4/3)<br>starter-#   else value_cd<br>starter-# end as result<br>starter-# from circles;<br>id result<br>MU0000000020  5024<br>MU0000000060  276.32<br>MT0000000075  10597.5<br>MT0000000010  907.46<br>MU0000000048  146499.84<br>MU0000000077  207.24<br>MU0000000088  6644.240000000001<br>MU0000000056  21537.260000000002<br>MP0000000090  232636.32<br>MU0000000084  7539.14<br>MU0000000030  286132.5<br>MP0000000018  4298.66<br>MU0000000026  232.36<br>MU0000000053  43407.36<br>MB0000000079  NULL<br>MU0000000042  6936.26<br>MU0000000056  263.76<br>MT0000000142  200960<br>MT0000000065  123414.56<br>MT000000006 6936.26<br>MU000000009 2461.76<br>MU0000000039  125.60000000000001<br><strong>Task:</strong><br>Для таблицы circles определить систему источника данных и номер круга: MU0000000001<br>MU - система источника, 1 - номер круга<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# select<br>starter-# id,<br>starter-# rtrim(substr(id,1,2),'0') source_system,<br>starter-# ltrim(substr(id,3), '0') circle_number<br>starter-# from circles;<br>id   | source_system | circle_number<br>--------------+---------------+---------------<br>MU0000000020 | MU&nbsp;&nbsp;  | 20<br>MU0000000060 | MU&nbsp;&nbsp;  | 60<br>MT0000000075 | MT&nbsp;&nbsp;  | 75<br>MT0000000010 | MT&nbsp;&nbsp;  | 10<br>MU0000000048 | MU&nbsp;&nbsp;  | 48<br>MU0000000077 | MU&nbsp;&nbsp;  | 77<br>MU0000000088 | MU&nbsp;&nbsp;  | 88<br>MU0000000056 | MU&nbsp;&nbsp;  | 56<br>MP0000000090 | MP&nbsp;&nbsp;  | 90<br>MU0000000084 | MU&nbsp;&nbsp;  | 84<br>MU0000000030 | MU&nbsp;&nbsp;  | 30<br>MP0000000018 | MP&nbsp;&nbsp;  | 18<br>MU0000000026 | MU&nbsp;&nbsp;  | 26<br>MU0000000053 | MU&nbsp;&nbsp;  | 53<br>MB0000000079 | MB&nbsp;&nbsp;  | 79<br>MU0000000042 | MU&nbsp;&nbsp;  | 42<br>MU0000000056 | MU&nbsp;&nbsp;  | 56<br>MT0000000142 | MT&nbsp;&nbsp;  | 142<br>MT0000000065 | MT&nbsp;&nbsp;  | 65<br>MT000000006 | MT&nbsp;&nbsp;  | 6<br>MU000000009 | MU&nbsp;&nbsp;  | 9<br>MU0000000039 | MU&nbsp;&nbsp;  | 39<br>(22 строки)<br>starter=# SELECT<br>starter-# SUBSTR(LTRIM(id),1, 2) AS source_system,<br>starter-# cast(SUBSTR(id,3) as int) AS num_circle<br>starter-# FROM circles;SELECT<br>source_system | num_circle<br>---------------+------------<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 20<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 60<br>MT&nbsp;&nbsp;  |&nbsp;&nbsp; 75<br>MT&nbsp;&nbsp;  |&nbsp;&nbsp; 10<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 48<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 77<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 88<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 56<br>MP&nbsp;&nbsp;  |&nbsp;&nbsp; 90<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 84<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 30<br>MP&nbsp;&nbsp;  |&nbsp;&nbsp; 18<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 26<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 53<br>MB&nbsp;&nbsp;  |&nbsp;&nbsp; 79<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 42<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 56<br>MT&nbsp;&nbsp;  |&nbsp;&nbsp;142<br>MT&nbsp;&nbsp;  |&nbsp;&nbsp; 65<br>MT&nbsp;&nbsp;  |&nbsp;&nbsp; 6<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 9<br>MU&nbsp;&nbsp;  |&nbsp;&nbsp; 39<br>(22 строки)<br><strong>Task:</strong><br>Таблица Покупки.<br>Создать таблицу purchases;<br>Вставьте в нее все записи из приложенного файла (для таблицы purchases);<br>Выведите уникальные города клиентов;<br># Разработка баз данных.<br><strong>Decision:</strong><br>starter=# create table purchases (<br>starter(# surname varchar(50),<br>starter(# name varchar(50),<br>starter(# second_name varchar(50),<br>starter(# region varchar(50),<br>starter(# city varchar(50),<br>starter(# street_type varchar(50),<br>starter(# street_nm varchar(50),<br>starter(# house_num varchar(10),<br>starter(# phone_number bigint,<br>starter(# email varchar(50),<br>starter(# purchase_dt varchar(50),<br>starter(# product_cnt int,<br>starter(# purchase_amt int,<br>starter(# currency_nm varchar(50),<br>starter(# current_discount varchar(50));<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Смирнов', 'Александр', 'Александрович', 'Москва', 'Москва', 'улица', 'Шмидте', '2', 74950054758, 'smirnov@ya.ru ', '01.11.2021', 4, 125, 'US', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Иванов', 'Сергей', 'Алексеевич', 'Московская область', 'Химки', 'проспект', '50 лет октября', '17', 79061793723, 'ivanov@gmail.com', '02.11.2021', 5, 5679, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Кузнецов', 'Владимир', 'Анатольевич', 'Ростовская область', 'Ростов-на-Дону', 'переулок', 'Дружбы', '51', 79036038662, 'kuznecov@yandex.ru', '03.11.2021', 10, 9211, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Соколова', 'Елена', 'Андреевна', 'Свердловская область', 'Екатеринбург', 'бульвар', 'Цветной', '64', 74951752838, 'sokolova@mail.com', '01.01.2022', 12, 5476, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Попова ', 'Татьяна', 'Александровна', 'Санкт-Петербург', 'Санкт-Петербург', 'улица', 'Ленина', '11', 79209217902, 'popova@yahoo.com', '03.02.2022', 6, 242, 'EUR', '10');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Лебедев', 'Андрей', 'Аркадьевич', 'Ростовская область', 'Ростов-на-Дону', 'переулок', 'Смирновский', '100', 74999545208, 'lebedev@yahoo.com', '04.02.2022', 18, 9925, 'RUR', '12');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Козлов', 'Алексей', 'Артемович', 'Москва', 'Москва', 'улица', 'Ленина', '3', 74999545205, 'kozlov@ya.ru', '05.02.2022', 8, 7218, 'RUR', '10');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Новикова', 'Ольга', 'Андреевна', 'Санкт-Петербург', 'Санкт-Петербург', 'бульвар', 'Петровский', '45', 74999545202, 'novikova@yandex.ru', '06.02.2022', 11, 34, 'EUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values (' Морозов', 'Николай', 'Богданович', 'Рязанская область', 'Рязань', 'проспект', 'Московский', '67', NULL, 'morozov@gmail.com', '07.02.2022', 2, 4101, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Петров', 'Наталья', 'Александровна', 'Ростовская область', 'Ростов-на-Дону', 'улица', 'Ленина', '65', 74999937334, 'PETROV@GMAIL.COM', '08.02.2022', 4, 8013, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Волкова', 'Анна', 'Валентиновна', 'Москва', 'Москва', 'улица', 'Ленина', '73', 74950692731, 'volkova@gmail.com', '11.11.2021', 9, 7733, 'RUR', '10');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Соловьёв', 'Иван', 'Валерьевич', 'Москва', 'Москва', 'переулок', 'Глинки', '33', 77767813970, 'soloviyev@gmail.com', '08.02.2022', 9, 7566, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Васильев', 'Дмитрий', 'Васильевич', 'Ростовская область', 'Ростов-на-Дону', 'улица', 'Ленина', '25', 74951662623, 'vasiliyev@mail.com', '13.11.2021', 18, 2608, 'CNY', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Зайцева', 'Ирина', 'Викторовна', 'Санкт-Петербург', 'Санкт-Петербург', 'бульвар', 'Волжский', '74', 79093871696, 'zayceva@ya.ru', '08.02.2022', 12, 8694, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Павлова ', 'Мария', 'Витальевна', 'Москва', 'Москва', 'проспект', 'Свободы', '81', 74953740142, 'PAVLOVA@GMAIL.COM', '09.02.2022', 12, 5291, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Семёнов', 'Михаил', 'Владимирович', 'Свердловская область', 'Екатеринбург', 'переулок', 'Некрасовский', '44', NULL, 'semenov@mail.com', '10.02.2022', 9, 7087, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Голубева', 'Светлана', 'Владиславовна', 'Ростовская область', 'Ростов-на-Дону', 'улица', 'Ленина', '44', 74995861301, 'golubeva@gmail.com', '11.02.2022', 11, 3282, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Виноградова', 'Екатерина', 'Владиславовна', 'Москва', 'Москва', 'бульвар', 'Победы', '85', 74995860591, 'vinogradova@ya.ru', '18.11.2021', 20, 123, 'US', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Богданов', 'Евгений', 'Вячеславович', 'Санкт-Петербург', 'Санкт-Петербург', 'проспект', 'Революции', '3', 74995861296, 'BOGDANOV@gmail.com', '19.11.2021', 6, 6563, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Воробьёв', 'Виктор', 'Геннадиевич', 'Ростовская область', 'Ростов-на-Дону', 'улица', 'Дзержинского', '20', 74953741652, 'vorobiyev@gmail.com', '20.11.2021', 8, 3867, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Фёдорова', 'Анастасия', 'Георгиевна', 'Рязанская область', 'Рязань', 'улица', 'Победы', '55', 74950097648, 'NULL', '21.11.2021', 5, 56, 'EUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Михайлов', 'Юрий', 'Григорьевич', 'Москва', 'Москва', 'переулок', 'Лермонтовский', '45', 74992166013, 'mikhaylov@mail.com ', '08.02.2022', 8, 6283, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Беляева', 'Юлия', 'Валентиновна', 'Рязанская область', 'Рязань', 'бульвар', 'Гагарина', '50', 78002220480, 'NULL', '09.02.2022', 18, 7535, 'RUR', '10%');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Тарасова', 'Валентина', 'Денисовна', 'Москва', 'Москва', 'улица', 'Ленина', '54', 73432203735, 'belova@gmail.com', '10.02.2022', 1, 2247, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Белова', 'Галина', 'Валентиновна', 'Санкт-Петербург', 'Санкт-Петербург', 'проспект', 'Невский', '30', 73432203718, 'NULL', '25.11.2021', 15, 4612, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Комарова', 'Людмила', 'Евгеньевна', 'Рязанская область', 'Рязань', 'улица', 'Ленина', '15', 74993506931, ' KOMAROVA@MAIL.COM', '08.02.2022', 7, 7808, 'RUR', '25%');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Орлов', 'Василий', 'Егорович', 'Ростовская область', 'Ростов-на-Дону', 'бульвар', 'Дзержинского', '19', 79031193345, 'orlov@gmail.com', '27.11.2021', 17, 321, 'US', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Киселёв', 'Игорь', 'Ефимович', 'Москва', 'Москва', 'проспект', 'Красный', '10', 74996382013, 'NULL', '08.02.2022', 1, 1207, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Макаров', 'Анатолий', 'Иванович', 'Санкт-Петербург', 'Санкт-Петербург', 'улица', 'Ленина', '27', 79253628473, 'makarov@mail.com', '29.11.2021', 6, 7138, 'RUR', 'NULL');<br>starter=# insert into purchases (surname, name, second_name, region, city, street_type, street_nm, house_num, phone_number, email, purchase_dt, product_cnt, purchase_amt, currency_nm, current_discount) values ('Андреев ', 'Олег', 'Иваныч', 'Москва', 'Москва', 'переулок', 'Тургеневский', '79', 74951203035, 'andreev@gmail.com ', '30.11.2021', 16, 1022, 'RUR', 'NULL');<br>starter=# select distinct city<br>starter-# from purchases<br>starter-# where city is not null;<br>city<br>-----------------<br>Химки<br>Рязань<br>Екатеринбург<br>Москва<br>Санкт-Петербург<br>Ростов-на-Дону<br>(6 строк)<br><strong>Task:</strong><br>Выведите для каждого клиента из таблицы purchases полные ФИО (фамилия, имя и отчество должны находиться в одном поле) и адрес клиента (все адресные атрибуты также должны находиться в одном поле). Не забудьте выполнить проверку на пробелы;<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# select<br>starter-# surname || ' ' || name || ' ' || second_name as FIO,<br>starter-# CASE<br>starter-#   when trim(region) = trim(city)<br>starter-#   then city ||', '|| street_type ||' '|| street_nm || ', '|| house_num<br>starter-#   else region ||', '|| city ||', '|| street_type ||' '|| street_nm || ', '|| house_num<br>starter-# end as address<br>starter-# from purchases;<br>&nbsp;&nbsp;  fio&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  address<br>-------------------------------------+---------------------------------------------------------------<br>Смирнов Александр Александрович   | Москва, улица Шмидте, 2<br>Иванов Сергей Алексеевич&nbsp;&nbsp;  | Московская область, Химки, проспект 50 лет октября, 17<br>Кузнецов Владимир Анатольевич   | Ростовская область, Ростов-на-Дону, переулок Дружбы, 51<br>Соколова Елена Андреевна&nbsp;&nbsp;  | Свердловская область, Екатеринбург, бульвар Цветной, 64<br>Попова Татьяна Александровна   | Санкт-Петербург, улица Ленина, 11<br>Лебедев Андрей Аркадьевич&nbsp;&nbsp; | Ростовская область, Ростов-на-Дону, переулок Смирновский, 100<br>Козлов Алексей Артемович&nbsp;&nbsp;  | Москва, улица Ленина, 3<br>Новикова Ольга Андреевна&nbsp;&nbsp;  | Санкт-Петербург, бульвар Петровский, 45<br>Морозов Николай Богданович&nbsp;&nbsp; | Рязанская область, Рязань, проспект Московский, 67<br>Петров Наталья Александровна&nbsp;&nbsp;| Ростовская область, Ростов-на-Дону, улица Ленина, 65<br>Волкова Анна Валентиновна&nbsp;&nbsp; | Москва, улица Ленина, 73<br>Соловьёв Иван Валерьевич&nbsp;&nbsp;  | Москва, переулок Глинки, 33<br>Васильев Дмитрий Васильевич&nbsp;&nbsp; | Ростовская область, Ростов-на-Дону, улица Ленина, 25<br>Зайцева Ирина Викторовна&nbsp;&nbsp;  | Санкт-Петербург, бульвар Волжский, 74<br>Павлова Мария Витальевна&nbsp;&nbsp; | Москва, проспект Свободы, 81<br>Семёнов Михаил Владимирович&nbsp;&nbsp; | Свердловская область, Екатеринбург, переулок Некрасовский, 44<br>Голубева Светлана Владиславовна   | Ростовская область, Ростов-на-Дону, улица Ленина, 44<br>Виноградова Екатерина Владиславовна | Москва, бульвар Победы, 85<br>Богданов Евгений Вячеславович   | Санкт-Петербург, проспект Революции, 3<br>Воробьёв Виктор Геннадиевич&nbsp;&nbsp; | Ростовская область, Ростов-на-Дону, улица Дзержинского, 20<br>Фёдорова Анастасия Георгиевна   | Рязанская область, Рязань, улица Победы, 55<br>Михайлов Юрий Григорьевич&nbsp;&nbsp; | Москва, переулок Лермонтовский, 45<br>Беляева Юлия Валентиновна&nbsp;&nbsp; | Рязанская область, Рязань, бульвар Гагарина, 50<br>Тарасова Валентина Денисовна&nbsp;&nbsp;| Москва, улица Ленина, 54<br>Белова Галина Валентиновна&nbsp;&nbsp; | Санкт-Петербург, проспект Невский, 30<br>Комарова Людмила Евгеньевна&nbsp;&nbsp; | Рязанская область, Рязань, улица Ленина, 15<br>Орлов Василий Егорович&nbsp;&nbsp;   | Ростовская область, Ростов-на-Дону, бульвар Дзержинского, 19<br>Киселёв Игорь Ефимович&nbsp;&nbsp;   | Москва, проспект Красный, 10<br>Макаров Анатолий Иванович&nbsp;&nbsp; | Санкт-Петербург, улица Ленина, 27<br>Андреев Олег Иваныч&nbsp;&nbsp;&nbsp;&nbsp;| Москва, переулок Тургеневский, 79<br>(30 строк)<br><strong>Task:</strong><br>Выведите для каждого клиента из таблицы purchases его фамилию и инициалы, номер телефона, а также его категорию: если вторая цифра телефона = 9, то телефон мобильный, иначе городской;<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter-# select<br>surname || ' ' || substr(name, 1, 1) || '. ' || substr(second_name, 1, 1) as client,<br>phone_number,<br>case<br>when phone_number like '_9%'<br>then 'мобильный'<br>when phone_number not like '_9%'<br>then 'городской'<br>when phone_number is NULL<br>then 'значение не задано'<br>end as type<br>from purchases;<br>client phone_number  type<br>Смирнов А. А  74950054758 городской<br>Иванов С. А 79061793723 мобильный<br>Кузнецов В. А 79036038662 мобильный<br>Соколова Е. А 74951752838 городской<br>Попова Т. А 79209217902 мобильный<br>Лебедев А. А  74999545208 городской<br>Козлов А. А 74999545205 городской<br>Новикова О. А 74999545202 городской<br>Морозов Н. Б  NULL  значение не задано<br>Петров Н. А 74999937334 городской<br>Волкова А. В  74950692731 городской<br>Соловьёв И. В 77767813970 городской<br>Васильев Д. В 74951662623 городской<br>Зайцева И. В  79093871696 мобильный<br>Павлова М. В  74953740142 городской<br>Семёнов М. В  NULL  значение не задано<br>Голубева С. В 74995861301 городской<br>Виноградова Е. В  74995860591 городской<br>Богданов Е. В 74995861296 городской<br>Воробьёв В. Г 74953741652 городской<br>Фёдорова А. Г 74950097648 городской<br>Михайлов Ю. Г 74992166013 городской<br>Беляева Ю. В  78002220480 городской<br>Тарасова В. Д 73432203735 городской<br>Белова Г. В 73432203718 городской<br>Комарова Л. Е 74993506931 городской<br>Орлов В. Е 79031193345 мобильный<br>Киселёв И. Е  74996382013 городской<br>Макаров А. И  79253628473 мобильный<br>Андреев О. И  74951203035 городской<br><strong>Task:</strong><br>Выведите для каждого клиента из таблицы purchases его фамилию и инициалы, а также его email и домен электронной почты:<br>  ya.ru или yandex.ru -&gt; яндекс<br>  mail.com -&gt; мейл<br>  gmail.com -&gt; гугл<br>  yahoo.com -&gt; яху<br># Написание Sql запросов.<br><strong>Decision:</strong><br>starter=# SELECT TRIM(surname) ||' '|| SUBSTR(LTRIM(name), 1, 1) ||'. '|| SUBSTR(LTRIM(second_name), 1, 1) ||'. ' AS full_name, email,<br>starter-# CASE<br>starter-#   WHEN TRIM(LOWER(email)) LIKE '%@ya.ru' OR TRIM(LOWER(email)) LIKE '%@yandex.ru' THEN 'яндекс'<br>starter-#&nbsp;&nbsp; WHEN TRIM(LOWER(email)) LIKE '%@mail.com' THEN 'мейл'<br>starter-#&nbsp;&nbsp; WHEN TRIM(LOWER(email)) LIKE '%@gmail.com' THEN 'гугл'<br>starter-#&nbsp;&nbsp; WHEN TRIM(LOWER(email)) LIKE '%@yahoo.com' THEN 'яху'<br>starter-#&nbsp;&nbsp; WHEN email IS NULL OR email = 'NULL' THEN 'пусто'<br>starter-#&nbsp;&nbsp; ELSE 'не известный'<br>starter-#  END AS domen<br>starter-# FROM purchases;<br>full_name   |&nbsp;&nbsp;email&nbsp;&nbsp;| domen<br>--------------------+---------------------+--------<br>Смирнов А. А.   | smirnov@ya.ru   | яндекс<br>Иванов С. А.   | ivanov@gmail.com  | гугл<br>Кузнецов В. А.   | kuznecov@yandex.ru | яндекс<br>Соколова Е. А.   | sokolova@mail.com | мейл<br>Попова Т. А.   | popova@yahoo.com  | яху<br>Лебедев А. А.   | lebedev@yahoo.com | яху<br>Козлов А. А.   | kozlov@ya.ru&nbsp;&nbsp;| яндекс<br>Новикова О. А.   | novikova@yandex.ru | яндекс<br>Морозов Н. Б.   | morozov@gmail.com | гугл<br>Петров Н. А.   | PETROV@GMAIL.COM  | гугл<br>Волкова А. В.   | volkova@gmail.com | гугл<br>Соловьёв И. В.   | soloviyev@gmail.com | гугл<br>Васильев Д. В.   | vasiliyev@mail.com | мейл<br>Зайцева И. В.   | zayceva@ya.ru   | яндекс<br>Павлова М. В.   | PAVLOVA@GMAIL.COM | гугл<br>Семёнов М. В.   | semenov@mail.com  | мейл<br>Голубева С. В.   | golubeva@gmail.com | гугл<br>Виноградова Е. В. | vinogradova@ya.ru | яндекс<br>Богданов Е. В.   | BOGDANOV@gmail.com | гугл<br>Воробьёв В. Г.   | vorobiyev@gmail.com | гугл<br>Фёдорова А. Г.   | NULL&nbsp;&nbsp;&nbsp;&nbsp;| пусто<br>Михайлов Ю. Г.   | mikhaylov@mail.com | мейл<br>Беляева Ю. В.   | NULL&nbsp;&nbsp;&nbsp;&nbsp;| пусто<br>Тарасова В. Д.   | belova@gmail.com  | гугл<br>Белова Г. В.   | NULL&nbsp;&nbsp;&nbsp;&nbsp;| пусто<br>Комарова Л. Е.   | KOMAROVA@MAIL.COM | мейл<br>Орлов В. Е.&nbsp;&nbsp;| orlov@gmail.com   | гугл<br>Киселёв И. Е.   | NULL&nbsp;&nbsp;&nbsp;&nbsp;| пусто<br>Макаров А. И.   | makarov@mail.com  | мейл<br>Андреев О. И.   | andreev@gmail.com | гугл<br>(30 строк)<br><strong>Task:</strong><br>Из таблицы purchases отобрать только тех клиентов, которые:<br>  совершили покупку в ноябре 2021 года;<br>  на суммы свыше 5 тысяч рублей (с учетом текущей скидки)<br>  известен полный адрес и номер телефона<br>Вывести   фамилию, имя и отчество,<br>  номер телефона,<br>  текста sms-сообщения:<br>“Уважаемый/ая (имя клиента), рады сообщить, что в нашем магазине начинается   распродажа товаров. Ждем Вас каждый день с 9.00 до 20.00!”<br># Написание Sql запросов.<br><strong>Decision:</strong><br>select<br>surname || ' ' || substr(name, 1, 1) || '. ' || substr(second_name, 1, 1) as client,<br>phone_number,<br>'Уважаемый/ая ' ||surname || ' ' || substr(name, 1, 1) || '. ' || substr(second_name, 1, 1)||',<br>рады сообщить, что в нашем магазине начинается<br>распродажа товаров. Ждем Вас каждый день с 9.00 до 20.00!' as sms<br>--purchase_amt_rub*(1-current_discount)<br>from purchases<br>where<br>purchase_dt like '%11.2021'<br>and region is not NULL<br>and city is not NULL<br>and street_type is not NULL<br>and street_nm is not NULL<br>and house_num is not NULL<br>and phone_number is not NULL<br>and<br>(case currency_nm<br>  when 'US'<br>&nbsp;&nbsp;then 60.5<br>  when 'EUR'<br>&nbsp;&nbsp;then 60.6<br>  when 'CNY'<br>&nbsp;&nbsp;then 8.7<br>  else 1<br>end *purchase_amt)*(1-<br>replace(coalesce(case current_discount<br>   when 'NULL'<br>&nbsp;&nbsp; then 0<br>   else current_discount<br>end,0),'%','')*0.01) &gt; 5000<br>client phone_number  sms<br>Смирнов А. А  74950054758 Уважаемый/ая Смирнов А. А, рады сообщить, что в нашем магазине начинается распродажа товаров. Ждем Вас каждый день с 9.00 до 20.00!<br>Иванов С. А 79061793723 Уважаемый/ая Иванов С. А, рады сообщить, что в нашем магазине начинается распродажа товаров. Ждем Вас каждый день с 9.00 до 20.00!<br>Кузнецов В. А 79036038662 Уважаемый/ая Кузнецов В. А, рады сообщить, что в нашем магазине начинается распродажа товаров. Ждем Вас каждый день с 9.00 до 20.00!<br>Волкова А. В  74950692731 Уважаемый/ая Волкова А. В, рады сообщить, что в нашем магазине начинается распродажа товаров. Ждем Вас каждый день с 9.00 до 20.00!<br>Васильев Д. В 74951662623 Уважаемый/ая Васильев Д. В, рады сообщить, что в нашем магазине начинается распродажа товаров. Ждем Вас каждый день с 9.00 до 20.00!<br>Виноградова Е. В  74995860591 Уважаемый/ая Виноградова Е. В, рады сообщить, что в нашем магазине начинается распродажа товаров. Ждем Вас каждый день с 9.00 до 20.00!<br>Богданов Е. В 74995861296 Уважаемый/ая Богданов Е. В, рады сообщить, что в нашем магазине начинается распродажа товаров. Ждем Вас каждый день с 9.00 до 20.00!<br>Орлов В. Е 79031193345 Уважаемый/ая Орлов В. Е, рады сообщить, что в нашем магазине начинается распродажа товаров. Ждем Вас каждый день с 9.00 до 20.00!<br>Макаров А. И  79253628473 Уважаемый/ая Макаров А. И, рады сообщить, что в нашем магазине начинается распродажа товаров. Ждем Вас каждый день с 9.00 до 20.00!<br>select<br>first_name,<br>last_name,<br>department_id,<br>(select<br>  distinct department_name<br>from departments<br>where departments.department_id=employees.department_id) as department_name<br>from employees<br><strong>Task:</strong><br>Таблица Командировки.<br>Создать таблицу командировки, в которой представлена информация о командировках сотрудников какой-либо организации (фамилия сотрудника, город, куда он ездил, размер суточных, даты первого и последнего дня командировки)<br># Разработка баз данных.<br><strong>Decision:</strong><br>mysql&gt; CREATE TABLE trip (<br>trip_id INT PRIMARY KEY AUTO_INCREMENT,<br>name VARCHAR(30),<br>city VARCHAR(25),<br>per_diem DECIMAL(8, 2),<br>date_first DATE,<br>date_last DATE<br>);<br>Query OK, 0 rows affected (0.26 sec)<br>mysql&gt; INSERT INTO trip VALUES<br>("1", "Баранов П.Е.", "Москва", "700", "2020-01-12", "2020-01-17"),<br>("2", "Абрамова К.А.", "Владивосток", "450", "2020-01-14", "2020-01-27"),<br>("3", "Семенов И.В.", "Москва", "700", "2020-01-23", "2020-01-31"),<br>("4", "Ильиных Г.Р.", "Владивосток", "450", "2020-01-12", "2020-02-02"),<br>("5", "Колесов С.П.", "Москва", "700", "2020-02-01", "2020-02-06"),<br>("6", "Баранов П.Е.", "Москва", "700", "2020-02-14", "2020-02-22"),<br>("7", "Абрамова К.А.", "Москва", "700", "2020-02-23", "2020-03-01"),<br>("8", "Лебедев Т.К.", "Москва", "700", "2020-03-03", "2020-03-06"),<br>("9", "Колесов С.П.", "Новосибирск", "450", "2020-02-27", "2020-03-12"),<br>("10", "Семенов И.В.", "Санкт-Петербург", "700", "2020-03-29", "2020-04-05"),<br>("11", "Абрамова К.А.", "Москва", "700", "2020-04-06", "2020-04-14"),<br>("12", "Баранов П.Е.", "Новосибирск", "450", "2020-04-18", "2020-05-04"),<br>("13", "Лебедев Т.К.", "Томск", "450", "2020-05-20", "2020-05-31"),<br>("14", "Семенов И.В.", "Санкт-Петербург", "700", "2020-06-01", "2020-06-03"),<br>("15", "Абрамова К.А.", "Санкт-Петербург", "700", "2020-05-28", "2020-06-04"),<br>("16", "Федорова А.Ю.", "Новосибирск", "450", "2020-05-25", "2020-06-04"),<br>("17", "Колесов С.П.", "Новосибирск", "450", "2020-06-03", "2020-06-12"),<br>("18", "Федорова А.Ю.", "Томск", "450", "2020-06-20", "2020-06-26"),<br>("19", "Абрамова К.А.", "Владивосток", "450", "2020-07-02", "2020-07-13"),<br>("20", "Баранов П.Е.", "Воронеж", "450", "2020-07-19", "2020-07-25");<br>mysql&gt; SELECT * FROM trip;<br>+---------+-------------------------+-------------------------------+----------+------------+------------+<br>| trip_id | name&nbsp;&nbsp;&nbsp;&nbsp;  | city&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | per_diem | date_first | date_last |<br>+---------+-------------------------+-------------------------------+----------+------------+------------+<br>|   1 | Баранов П.Е.&nbsp;&nbsp;  | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 700.00 | 2020-01-12 | 2020-01-17 |<br>|   2 | Абрамова К.А.&nbsp;&nbsp; | Владивосток&nbsp;&nbsp;&nbsp;&nbsp; | 450.00 | 2020-01-14 | 2020-01-27 |<br>|   3 | Семенов И.В.&nbsp;&nbsp;  | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 700.00 | 2020-01-23 | 2020-01-31 |<br>|   4 | Ильиных Г.Р.&nbsp;&nbsp;  | Владивосток&nbsp;&nbsp;&nbsp;&nbsp; | 450.00 | 2020-01-12 | 2020-02-02 |<br>|   5 | Колесов С.П.&nbsp;&nbsp;  | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 700.00 | 2020-02-01 | 2020-02-06 |<br>|   6 | Баранов П.Е.&nbsp;&nbsp;  | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 700.00 | 2020-02-14 | 2020-02-22 |<br>|   7 | Абрамова К.А.&nbsp;&nbsp; | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 700.00 | 2020-02-23 | 2020-03-01 |<br>|   8 | Лебедев Т.К.&nbsp;&nbsp;  | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 700.00 | 2020-03-03 | 2020-03-06 |<br>|   9 | Колесов С.П.&nbsp;&nbsp;  | Новосибирск&nbsp;&nbsp;&nbsp;&nbsp; | 450.00 | 2020-02-27 | 2020-03-12 |<br>|   10 | Семенов И.В.&nbsp;&nbsp;  | Санкт-Петербург&nbsp;&nbsp;   | 700.00 | 2020-03-29 | 2020-04-05 |<br>|   11 | Абрамова К.А.&nbsp;&nbsp; | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 700.00 | 2020-04-06 | 2020-04-14 |<br>|   12 | Баранов П.Е.&nbsp;&nbsp;  | Новосибирск&nbsp;&nbsp;&nbsp;&nbsp; | 450.00 | 2020-04-18 | 2020-05-04 |<br>|   13 | Лебедев Т.К.&nbsp;&nbsp;  | Томск&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 450.00 | 2020-05-20 | 2020-05-31 |<br>|   14 | Семенов И.В.&nbsp;&nbsp;  | Санкт-Петербург&nbsp;&nbsp;   | 700.00 | 2020-06-01 | 2020-06-03 |<br>|   15 | Абрамова К.А.&nbsp;&nbsp; | Санкт-Петербург&nbsp;&nbsp;   | 700.00 | 2020-05-28 | 2020-06-04 |<br>|   16 | Федорова А.Ю.&nbsp;&nbsp; | Новосибирск&nbsp;&nbsp;&nbsp;&nbsp; | 450.00 | 2020-05-25 | 2020-06-04 |<br>|   17 | Колесов С.П.&nbsp;&nbsp;  | Новосибирск&nbsp;&nbsp;&nbsp;&nbsp; | 450.00 | 2020-06-03 | 2020-06-12 |<br>|   18 | Федорова А.Ю.&nbsp;&nbsp; | Томск&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 450.00 | 2020-06-20 | 2020-06-26 |<br>|   19 | Абрамова К.А.&nbsp;&nbsp; | Владивосток&nbsp;&nbsp;&nbsp;&nbsp; | 450.00 | 2020-07-02 | 2020-07-13 |<br>|   20 | Баранов П.Е.&nbsp;&nbsp;  | Воронеж&nbsp;&nbsp;&nbsp;&nbsp;   | 450.00 | 2020-07-19 | 2020-07-25 |<br>+---------+-------------------------+-------------------------------+----------+------------+------------+<br>20 rows in set (0.00 sec)<br><strong>Task:</strong><br>Вывести из таблицы trip информацию о командировках тех сотрудников, фамилия которых заканчивается на букву «а», в отсортированном по убыванию даты последнего дня командировки виде. В результат включить столбцы name, city, per_diem, date_first, date_last.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>mysql&gt; SELECT name, city, per_diem, date_first, date_last<br>FROM trip<br>WHERE name LtuserE '%а %'<br>ORDER BY date_last DESC;<br>+-------------------------+-------------------------------+----------+------------+------------+<br>| name&nbsp;&nbsp;&nbsp;&nbsp;  | city&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | per_diem | date_first | date_last |<br>+-------------------------+-------------------------------+----------+------------+------------+<br>| Абрамова К.А.&nbsp;&nbsp; | Владивосток&nbsp;&nbsp;&nbsp;&nbsp; | 450.00 | 2020-07-02 | 2020-07-13 |<br>| Федорова А.Ю.&nbsp;&nbsp; | Томск&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 450.00 | 2020-06-20 | 2020-06-26 |<br>| Абрамова К.А.&nbsp;&nbsp; | Санкт-Петербург&nbsp;&nbsp;   | 700.00 | 2020-05-28 | 2020-06-04 |<br>| Федорова А.Ю.&nbsp;&nbsp; | Новосибирск&nbsp;&nbsp;&nbsp;&nbsp; | 450.00 | 2020-05-25 | 2020-06-04 |<br>| Абрамова К.А.&nbsp;&nbsp; | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 700.00 | 2020-04-06 | 2020-04-14 |<br>| Абрамова К.А.&nbsp;&nbsp; | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 700.00 | 2020-02-23 | 2020-03-01 |<br>| Абрамова К.А.&nbsp;&nbsp; | Владивосток&nbsp;&nbsp;&nbsp;&nbsp; | 450.00 | 2020-01-14 | 2020-01-27 |<br>+-------------------------+-------------------------------+----------+------------+------------+<br>7 rows in set (0.01 sec)<br><strong>Task:</strong><br>Вывести в алфавитном порядке фамилии и инициалы тех сотрудников, которые были в командировке в Москве.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>mysql&gt; SELECT DISTINCT name<br>FROM trip<br>WHERE city = 'Москва'<br>ORDER BY name ASC;<br>+-------------------------+<br>| name&nbsp;&nbsp;&nbsp;&nbsp;  |<br>+-------------------------+<br>| Абрамова К.А.&nbsp;&nbsp; |<br>| Баранов П.Е.&nbsp;&nbsp;  |<br>| Колесов С.П.&nbsp;&nbsp;  |<br>| Лебедев Т.К.&nbsp;&nbsp;  |<br>| Семенов И.В.&nbsp;&nbsp;  |<br>+-------------------------+<br>5 rows in set (0.00 sec)<br><strong>Task:</strong><br>Для каждого города посчитать, сколько раз сотрудники в нем были. Информацию вывести в отсортированном в алфавитном порядке по названию городов. Вычисляемый столбец назвать Количество.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>mysql&gt; SELECT city, COUNT(name) AS Количество<br>FROM trip<br>GROUP BY city<br>ORDER BY city ASC;<br>+-------------------------------+----------------------+<br>| city&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Количество&nbsp;&nbsp; |<br>+-------------------------------+----------------------+<br>| Владивосток&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;  3 |<br>| Воронеж&nbsp;&nbsp;&nbsp;&nbsp;   |&nbsp;&nbsp;&nbsp;&nbsp;  1 |<br>| Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;  7 |<br>| Новосибирск&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;  4 |<br>| Санкт-Петербург&nbsp;&nbsp;   |&nbsp;&nbsp;&nbsp;&nbsp;  3 |<br>| Томск&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;  2 |<br>+-------------------------------+----------------------+<br>6 rows in set (0.01 sec)<br><strong>Task:</strong><br>Вывести два города, в которых чаще всего были в командировках сотрудники. Вычисляемый столбец назвать Количество.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>mysql&gt; SELECT city, COUNT(name) AS Количество<br>FROM trip<br>GROUP BY city<br>ORDER BY Количество DESC<br>LIMIT 2;<br>+------------------------+----------------------+<br>| city&nbsp;&nbsp;&nbsp;&nbsp; | Количество&nbsp;&nbsp; |<br>+------------------------+----------------------+<br>| Москва&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;  7 |<br>| Новосибирск&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;  4 |<br>+------------------------+----------------------+<br>2 rows in set (0.01 sec)<br><strong>Task:</strong><br>Вывести информацию о командировках во все города кроме Москвы и Санкт-Петербурга (фамилии и инициалы сотрудников, город , длительность командировки в днях, при этом первый и последний день относится к периоду командировки). Последний столбец назвать Длительность. Информацию вывести в упорядоченном по убыванию длительности поездки, а потом по убыванию названий городов (в обратном алфавитном порядке).<br># Написание Sql запросов.<br><strong>Decision:</strong><br>mysql&gt; SELECT name, city, (DATEDIFF(date_last, date_first)+1) AS Длительность<br>FROM trip<br>WHERE city &lt;&gt; 'Москва' AND city &lt;&gt; 'Санкт-Петербург'<br>ORDER BY Длительность DESC;<br>+-------------------------+------------------------+--------------------------+<br>| name&nbsp;&nbsp;&nbsp;&nbsp;  | city&nbsp;&nbsp;&nbsp;&nbsp; | Длительность&nbsp;&nbsp;   |<br>+-------------------------+------------------------+--------------------------+<br>| Ильиных Г.Р.&nbsp;&nbsp;  | Владивосток&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;   22 |<br>| Баранов П.Е.&nbsp;&nbsp;  | Новосибирск&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;   17 |<br>| Колесов С.П.&nbsp;&nbsp;  | Новосибирск&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;   15 |<br>| Абрамова К.А.&nbsp;&nbsp; | Владивосток&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;   14 |<br>| Абрамова К.А.&nbsp;&nbsp; | Владивосток&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;   12 |<br>| Лебедев Т.К.&nbsp;&nbsp;  | Томск&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;   12 |<br>| Федорова А.Ю.&nbsp;&nbsp; | Новосибирск&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;   11 |<br>| Колесов С.П.&nbsp;&nbsp;  | Новосибирск&nbsp;&nbsp;  |&nbsp;&nbsp;&nbsp;&nbsp;   10 |<br>| Баранов П.Е.&nbsp;&nbsp;  | Воронеж&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7 |<br>| Федорова А.Ю.&nbsp;&nbsp; | Томск&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7 |<br>+-------------------------+------------------------+--------------------------+<br>10 rows in set (0.00 sec)<br><strong>Task:</strong><br>Вывести информацию о командировках сотрудника(ов), которые были самыми короткими по времени. В результат включить столбцы name, city, date_first, date_last.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>mysql&gt; SELECT name, city, date_first, date_last<br>FROM trip<br>WHERE DATEDIFF(date_last,date_first)=(<br>SELECT MIN(DATEDIFF(date_last,date_first))<br>FROM trip);<br>+-----------------------+-------------------------------+------------+------------+<br>| name&nbsp;&nbsp;&nbsp;&nbsp; | city&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | date_first | date_last |<br>+-----------------------+-------------------------------+------------+------------+<br>| Семенов И.В.&nbsp;&nbsp; | Санкт-Петербург&nbsp;&nbsp;   | 2020-06-01 | 2020-06-03 |<br>+-----------------------+-------------------------------+------------+------------+<br>1 row in set (0.03 sec)<br><strong>Task:</strong><br>Вывести информацию о командировках, начало и конец которых относятся к одному месяцу (год может быть любой). В результат включить столбцы name, city, date_first, date_last. Строки отсортировать сначала в алфавитном порядке по названию города, а затем по фамилии сотрудника .<br># Написание Sql запросов.<br><strong>Decision:</strong><br>mysql&gt; SELECT name, city, date_first, date_last<br>FROM trip<br>WHERE MONTH(date_first)=MONTH(date_last)<br>ORDER BY city, name ASC;<br>+-------------------------+-------------------------------+------------+------------+<br>| name&nbsp;&nbsp;&nbsp;&nbsp;  | city&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | date_first | date_last |<br>+-------------------------+-------------------------------+------------+------------+<br>| Абрамова К.А.&nbsp;&nbsp; | Владивосток&nbsp;&nbsp;&nbsp;&nbsp; | 2020-01-14 | 2020-01-27 |<br>| Абрамова К.А.&nbsp;&nbsp; | Владивосток&nbsp;&nbsp;&nbsp;&nbsp; | 2020-07-02 | 2020-07-13 |<br>| Баранов П.Е.&nbsp;&nbsp;  | Воронеж&nbsp;&nbsp;&nbsp;&nbsp;   | 2020-07-19 | 2020-07-25 |<br>| Абрамова К.А.&nbsp;&nbsp; | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2020-04-06 | 2020-04-14 |<br>| Баранов П.Е.&nbsp;&nbsp;  | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2020-01-12 | 2020-01-17 |<br>| Баранов П.Е.&nbsp;&nbsp;  | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2020-02-14 | 2020-02-22 |<br>| Колесов С.П.&nbsp;&nbsp;  | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2020-02-01 | 2020-02-06 |<br>| Лебедев Т.К.&nbsp;&nbsp;  | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2020-03-03 | 2020-03-06 |<br>| Семенов И.В.&nbsp;&nbsp;  | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2020-01-23 | 2020-01-31 |<br>| Колесов С.П.&nbsp;&nbsp;  | Новосибирск&nbsp;&nbsp;&nbsp;&nbsp; | 2020-06-03 | 2020-06-12 |<br>| Семенов И.В.&nbsp;&nbsp;  | Санкт-Петербург&nbsp;&nbsp;   | 2020-06-01 | 2020-06-03 |<br>| Лебедев Т.К.&nbsp;&nbsp;  | Томск&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2020-05-20 | 2020-05-31 |<br>| Федорова А.Ю.&nbsp;&nbsp; | Томск&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 2020-06-20 | 2020-06-26 |<br>+-------------------------+-------------------------------+------------+------------+<br>13 rows in set (0.00 sec)<br><strong>Task:</strong><br>Вывести название месяца и количество командировок для каждого месяца. Считаем, что командировка относится к некоторому месяцу, если она началась в этом месяце. Информацию вывести сначала в отсортированном по убыванию количества, а потом в алфавитном порядке по названию месяца виде. Название столбцов – Месяц и Количество.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>mysql&gt; SELECT MONTHNAME(date_first) AS Месяц, COUNT(name) AS Количество<br>FROM trip<br>GROUP BY Месяц<br>ORDER BY Количество DESC, Месяц ASC;<br>+------------+----------------------+<br>| Месяц   | Количество&nbsp;&nbsp; |<br>+------------+----------------------+<br>| February |&nbsp;&nbsp;&nbsp;&nbsp;  4 |<br>| January  |&nbsp;&nbsp;&nbsp;&nbsp;  4 |<br>| June   |&nbsp;&nbsp;&nbsp;&nbsp;  3 |<br>| May&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;  3 |<br>| April   |&nbsp;&nbsp;&nbsp;&nbsp;  2 |<br>| July   |&nbsp;&nbsp;&nbsp;&nbsp;  2 |<br>| March   |&nbsp;&nbsp;&nbsp;&nbsp;  2 |<br>+------------+----------------------+<br>7 rows in set (0.01 sec)<br><strong>Task:</strong><br>Вывести сумму суточных (произведение количества дней командировки и размера суточных) для командировок, первый день которых пришелся на февраль или март 2020 года. Значение суточных для каждой командировки занесено в столбец per_diem. Вывести фамилию и инициалы сотрудника, город, первый день командировки и сумму суточных. Последний столбец назвать Сумма. Информацию отсортировать сначала в алфавитном порядке по фамилиям сотрудников, а затем по убыванию суммы суточных.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>mysql&gt; SELECT name, city, date_first, (DATEDIFF(date_last, date_first)+1)*per_diem AS Сумма<br>FROM trip<br>WHERE YEAR(date_first)=2020 AND MONTH(date_first)=3 OR MONTH(date_first)=2<br>ORDER BY name,Сумма DESC;<br>+-------------------------+-------------------------------+------------+------------+<br>| name&nbsp;&nbsp;&nbsp;&nbsp;  | city&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | date_first | Сумма   |<br>+-------------------------+-------------------------------+------------+------------+<br>| Абрамова К.А.&nbsp;&nbsp; | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2020-02-23 |  5600.00 |<br>| Баранов П.Е.&nbsp;&nbsp;  | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2020-02-14 |  6300.00 |<br>| Колесов С.П.&nbsp;&nbsp;  | Новосибирск&nbsp;&nbsp;&nbsp;&nbsp; | 2020-02-27 |  6750.00 |<br>| Колесов С.П.&nbsp;&nbsp;  | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2020-02-01 |  4200.00 |<br>| Лебедев Т.К.&nbsp;&nbsp;  | Москва&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2020-03-03 |  2800.00 |<br>| Семенов И.В.&nbsp;&nbsp;  | Санкт-Петербург&nbsp;&nbsp;   | 2020-03-29 |  5600.00 |<br>+-------------------------+-------------------------------+------------+------------+<br>6 rows in set (0.01 sec)<br><strong>Task:</strong><br>Вывести фамилию с инициалами и общую сумму суточных, полученных за все командировки для тех сотрудников, которые были в командировках больше чем 3 раза, в отсортированном по убыванию сумм суточных виде. Последний столбец назвать Сумма.<br># Написание Sql запросов.<br><strong>Decision:</strong><br>mysql&gt; SELECT name, SUM((DATEDIFF(date_last, date_first)+1)*per_diem) AS Сумма<br>FROM trip<br>GROUP BY name<br>HAVING COUNT(name)&gt;3<br>ORDER BY Сумма DESC;<br>+-------------------------+------------+<br>| name&nbsp;&nbsp;&nbsp;&nbsp;  | Сумма   |<br>+-------------------------+------------+<br>| Абрамова К.А.&nbsp;&nbsp; | 29200.00 |<br>| Баранов П.Е.&nbsp;&nbsp;  | 21300.00 |<br>+-------------------------+------------+<br>2 rows in set (0.00 sec)</p>