Task:
Таблица Нарушения правил дорожного движения.
Создать таблицу штрафов содержит информацию о штрафах, начисленных водителям за нарушения правил дорожного движения (имя водителя, номер автомобиля, описание нарушения, сумма штрафа, дата нарушения и дата оплаты штрафа).
Создать таблицу fine следующей структуры:
fine_id - ключевой столбец целого типа с автоматическим увеличением значения ключа на 1
name - строка длиной 30
number_plate - строка длиной 6
violation - строка длиной 50
sum_fine - вещественное число, максимальная длина 8, количество знаков после запятой 2
date_violation - дата
date_payment - дата
# Разработка баз данных.
Decision:
mysql> CREATE TABLE fine(fine_id INT PRIMARY KEY AUTO_INCREMENT, name VARCHAR(30), number_plate VARCHAR(6), violation VARCHAR(50), sum_fine DECIMAL(8,2), date_violation DATE, date_payment DATE);
Task:
В таблицу fine первые 5 строк уже занесены. Добавить в таблицу записи с ключевыми значениями 6, 7, 8.
fine_id   name  number_plate  violation sum_fine  date_violation date_payment
1 Баранов П.Е.  Р523ВТ Превышение скорости (от 40 до 60) 500.00 2020-01-12 2020-01-17
2 Абрамова К.А. О111АВ Проезд на запрещающий сигнал 1000.00   2020-01-14 2020-02-27
3 Яковлев Г.Р.  Т330ТТ Превышение скорости (от 20 до 40) 500.00 2020-01-23 2020-02-23
4 Яковлев Г.Р.  М701АА Превышение скорости (от 20 до 40)   2020-01-12
5 Колесов С.П.  К892АХ Превышение скорости (от 20 до 40)   2020-02-01
6 Баранов П.Е.  Р523ВТ Превышение скорости (от 40 до 60)   2020-02-14
7 Абрамова К.А. О111АВ Проезд на запрещающий сигнал   2020-02-23
8 Яковлев Г.Р.  Т330ТТ Проезд на запрещающий сигнал   2020-03-03
# Написание Sql запросов.
Decision:
mysql> INSERT INTO fine (name, number_plate, violation, sum_fine, date_violation, date_payment) VALUES
('Баранов П.Е.', 'Р523ВТ', 'Превышение скорости(от 40 до 60)', 500.00, '2020-01-12', '2020-01-17'),
('Абрамова К.А.', 'О111АВ', 'Проезд на запрещающий сигнал', 1000.00, '2020-01-14', '2020-02-27'),
('Яковлев Г.Р.', 'Т330ТТ', 'Превышение скорости(от 20 до 40)', 500.00, '2020-01-23', '2020-02-23'),
('Яковлев Г.Р.', 'М701АА', 'Превышение скорости(от 20 до 40)', Null, '2020-01-12', Null),
('Колесов С.П.', 'К892АХ', 'Превышение скорости(от 20 до 40)', Null, '2020-02-01', Null);
Query OK, 5 rows affected (0.19 sec)
Records: 5 Duplicates: 0 Warnings: 0
mysql> SELECT * FROM fine;
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
| fine_id | name          | number_plate | violation                       | sum_fine | date_violation | date_payment |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
|   1 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 500.00 | 2020-01-12   | 2020-01-17 |
|   2 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-01-14   | 2020-02-27 |
|   3 | Яковлев Г.Р.      | Т330ТТ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-23   | 2020-02-23 |
|   4 | Яковлев Г.Р.      | М701АА   | Превышение скорости(от 20 до 40)           |   NULL | 2020-01-12   | NULL     |
|   5 | Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           |   NULL | 2020-02-01   | NULL     |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
5 rows in set (0.00 sec)
mysql> INSERT INTO fine (name, number_plate, violation, sum_fine, date_violation, date_payment) VALUES
('Баранов П.Е.', 'Р523ВТ', 'Превышение скорости(от 40 до 60)', Null, '2020-02-14', Null),
('Абрамова К.А.', 'О111АВ', 'Проезд на запрещающий сигнал', Null, '2020-02-23', Null),
('Яковлев Г.Р.', 'Т330ТТ', 'Проезд на запрещающий сигнал', Null, '2020-03-03', Null);
Query OK, 3 rows affected (0.03 sec)
Records: 3 Duplicates: 0 Warnings: 0
mysql> SELECT * FROM fine;
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
| fine_id | name          | number_plate | violation                       | sum_fine | date_violation | date_payment |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
|   1 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 500.00 | 2020-01-12   | 2020-01-17 |
|   2 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-01-14   | 2020-02-27 |
|   3 | Яковлев Г.Р.      | Т330ТТ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-23   | 2020-02-23 |
|   4 | Яковлев Г.Р.      | М701АА   | Превышение скорости(от 20 до 40)           |   NULL | 2020-01-12   | NULL     |
|   5 | Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           |   NULL | 2020-02-01   | NULL     |
|   6 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           |   NULL | 2020-02-14   | NULL     |
|   7 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             |   NULL | 2020-02-23   | NULL     |
|   8 | Яковлев Г.Р.      | Т330ТТ   | Проезд на запрещающий сигнал             |   NULL | 2020-03-03   | NULL     |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
8 rows in set (0.00 sec)
Task:
Занести в таблицу fine суммы штрафов, которые должен оплатить водитель, в соответствии с данными из таблицы traffic_violation. При этом суммы заносить только в пустые поля столбца sum_fine.
Таблица traffic_violationсоздана и заполнена.
Важно! Сравнение значения столбца с пустым значением осуществляется с помощью оператора IS NULL.
# Написание Sql запросов.
Decision:
mysql> CREATE TABLE traffic_violation(violation_id INT PRIMARY KEY AUTO_INCREMENT, violation VARCHAR(50), sum_fine DECIMAL(8,2));
Query OK, 0 rows affected (0.20 sec)
mysql> INSERT INTO traffic_violation (violation, sum_fine) VALUES ('Превышение скорости(от 20 до 40)', 500.00 ), ('Превышение скорости(от 40 до 60)', 1000.00), ('Проезд на запрещающий сигнал', 1000.00);
Query OK, 3 rows affected (0.12 sec)
Records: 3 Duplicates: 0 Warnings: 0
mysql> SELECT * FROM traffic_violation;
+--------------+--------------------------------------------------------+----------+
| violation_id | violation                       | sum_fine |
+--------------+--------------------------------------------------------+----------+
|      1 | Превышение скорости(от 20 до 40)           | 500.00 |
|      2 | Превышение скорости(от 40 до 60)           | 1000.00 |
|      3 | Проезд на запрещающий сигнал             | 1000.00 |
+--------------+--------------------------------------------------------+----------+
3 rows in set (0.00 sec)
mysql> SELECT * FROM fine;
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
| fine_id | name          | number_plate | violation                       | sum_fine | date_violation | date_payment |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
|   1 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 500.00 | 2020-01-12   | 2020-01-17 |
|   2 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-01-14   | 2020-02-27 |
|   3 | Яковлев Г.Р.      | Т330ТТ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-23   | 2020-02-23 |
|   4 | Яковлев Г.Р.      | М701АА   | Превышение скорости(от 20 до 40)           |   NULL | 2020-01-12   | NULL     |
|   5 | Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           |   NULL | 2020-02-01   | NULL     |
|   6 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           |   NULL | 2020-02-14   | NULL     |
|   7 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             |   NULL | 2020-02-23   | NULL     |
|   8 | Яковлев Г.Р.      | Т330ТТ   | Проезд на запрещающий сигнал             |   NULL | 2020-03-03   | NULL     |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
8 rows in set (0.00 sec)
mysql> UPDATE fine, traffic_violation
SET fine.sum_fine=traffic_violation.sum_fine
WHERE (fine.sum_fine IS NULL) AND (fine.violation=traffic_violation.violation);
Query OK, 5 rows affected (0.02 sec)
Rows matched: 5 Changed: 5 Warnings: 0
mysql> SELECT * FROM fine;
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
| fine_id | name          | number_plate | violation                       | sum_fine | date_violation | date_payment |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
|   1 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 500.00 | 2020-01-12   | 2020-01-17 |
|   2 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-01-14   | 2020-02-27 |
|   3 | Яковлев Г.Р.      | Т330ТТ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-23   | 2020-02-23 |
|   4 | Яковлев Г.Р.      | М701АА   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-12   | NULL     |
|   5 | Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-02-01   | NULL     |
|   6 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 1000.00 | 2020-02-14   | NULL     |
|   7 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-02-23   | NULL     |
|   8 | Яковлев Г.Р.      | Т330ТТ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-03-03   | NULL     |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
8 rows in set (0.01 sec)
Task:
Вывести фамилию, номер машины и нарушение только для тех водителей, которые на одной машине нарушили одно и то же правило два и более раз. При этом учитывать все нарушения, независимо от того оплачены они или нет. Информацию отсортировать в алфавитном порядке, сначала по фамилии водителя, потом по номеру машины и, наконец, по нарушению.
# Написание Sql запросов.
Decision:
mysql> SELECT * FROM fine;
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
| fine_id | name          | number_plate | violation                       | sum_fine | date_violation | date_payment |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
|   1 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 500.00 | 2020-01-12   | 2020-01-17 |
|   2 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-01-14   | 2020-02-27 |
|   3 | Яковлев Г.Р.      | Т330ТТ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-23   | 2020-02-23 |
|   4 | Яковлев Г.Р.      | М701АА   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-12   | NULL     |
|   5 | Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-02-01   | NULL     |
|   6 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 1000.00 | 2020-02-14   | NULL     |
|   7 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-02-23   | NULL     |
|   8 | Яковлев Г.Р.      | Т330ТТ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-03-03   | NULL     |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
8 rows in set (0.01 sec)
mysql> SELECT name, number_plate, violation, count(*)
FROM fine
GROUP BY name, number_plate, violation;
+-------------------------+--------------+--------------------------------------------------------+----------+
| name          | number_plate | violation                       | count(*) |
+-------------------------+--------------+--------------------------------------------------------+----------+
| Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           |    2 |
| Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             |    2 |
| Яковлев Г.Р.      | Т330ТТ   | Превышение скорости(от 20 до 40)           |    1 |
| Яковлев Г.Р.      | М701АА   | Превышение скорости(от 20 до 40)           |    1 |
| Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           |    1 |
| Яковлев Г.Р.      | Т330ТТ   | Проезд на запрещающий сигнал             |    1 |
+-------------------------+--------------+--------------------------------------------------------+----------+
6 rows in set (0.00 sec)
mysql> SELECT name, number_plate, violation, count(*)
FROM fine
GROUP BY name, number_plate, violation
HAVING count(*) >= 2;
+-------------------------+--------------+--------------------------------------------------------+----------+
| name          | number_plate | violation                       | count(*) |
+-------------------------+--------------+--------------------------------------------------------+----------+
| Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           |    2 |
| Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             |    2 |
+-------------------------+--------------+--------------------------------------------------------+----------+
2 rows in set (0.00 sec)
mysql> SELECT name, number_plate, violation
FROM fine
GROUP BY name, number_plate, violation
HAVING count(violation)>1
ORDER BY name,violation,number_plate desc;
+-------------------------+--------------+--------------------------------------------------------+----------+
| name          | number_plate | violation                       | count(*) |
+-------------------------+--------------+--------------------------------------------------------+----------+
| Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             |    2 |
| Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           |    2 |
+-------------------------+--------------+--------------------------------------------------------+----------+
2 rows in set (0.00 sec)
Task:
В таблице fine увеличить в два раза сумму неоплаченных штрафов для отобранных на предыдущем шаге записей.
Для всех нарушений, по которым штраф еще не оплачен, (тех, у которых date_payment имеет пустое значение Null), необходимо проверить, является ли данное нарушение для водителя и машины повторным, если да – увеличить штраф в два раза.
Если водитель совершил нарушение на другой машине, ему увеличивать штраф не нужно.
Если несколько повторных нарушений не оплачены, то штраф увеличить для всех.
# Написание Sql запросов.
Decision:
mysql> SELECT * FROM fine;
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
| fine_id | name          | number_plate | violation                       | sum_fine | date_violation | date_payment |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
|   1 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 500.00 | 2020-01-12   | 2020-01-17 |
|   2 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-01-14   | 2020-02-27 |
|   3 | Яковлев Г.Р.      | Т330ТТ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-23   | 2020-02-23 |
|   4 | Яковлев Г.Р.      | М701АА   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-12   | NULL     |
|   5 | Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-02-01   | NULL     |
|   6 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 1000.00 | 2020-02-14   | NULL     |
|   7 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-02-23   | NULL     |
|   8 | Яковлев Г.Р.      | Т330ТТ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-03-03   | NULL     |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
8 rows in set (0.01 sec)
mysql> UPDATE fine, (
SELECT name, number_plate, violation
FROM fine
GROUP BY name, number_plate, violation
HAVING count(violation)>1
ORDER BY name,violation,number_plate desc) AS query_in
SET sum_fine = IF(date_payment IS NULL,sum_fine*2,sum_fine)
WHERE fine.name = query_in.name;
Query OK, 2 rows affected (0.02 sec)
Rows matched: 4 Changed: 2 Warnings: 0
mysql> SElECT * FROM fine;
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
| fine_id | name          | number_plate | violation                       | sum_fine | date_violation | date_payment |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
|   1 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 500.00 | 2020-01-12   | 2020-01-17 |
|   2 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-01-14   | 2020-02-27 |
|   3 | Яковлев Г.Р.      | Т330ТТ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-23   | 2020-02-23 |
|   4 | Яковлев Г.Р.      | М701АА   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-12   | NULL     |
|   5 | Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-02-01   | NULL     |
|   6 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 2000.00 | 2020-02-14   | NULL     |
|   7 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 2000.00 | 2020-02-23   | NULL     |
|   8 | Яковлев Г.Р.      | Т330ТТ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-03-03   | NULL     |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
8 rows in set (0.01 sec)
Task:
Водители оплачивают свои штрафы. В таблице payment занесены даты их оплаты:
payment_id name  number_plate  violation date_violation date_payment
1 Яковлев Г.Р.  М701АА Превышение скорости(от 20 до 40) 2020-01-12 2020-01-22
2 Баранов П.Е.  Р523ВТ Превышение скорости(от 40 до 60) 2020-02-14 2020-03-06
3 Яковлев Г.Р.  Т330ТТ Проезд на запрещающий сигнал 2020-03-03 2020-03-23
Необходимо:
в таблицу fine занести дату оплаты соответствующего штрафа из таблицы payment;
уменьшить начисленный штраф в таблице fine в два раза (только для тех штрафов, информация о которых занесена в таблицу payment) , если оплата произведена не позднее 20 дней со дня нарушения.
# Написание Sql запросов.
Decision:
mysql> CREATE TABLE payment(payment_id INT PRIMARY KEY AUTO_INCREMENT, name VARCHAR(30), number_plate VARCHAR(6), violation VARCHAR(50), date_violation DATE, date_payment DATE);
Query OK, 0 rows affected (0.24 sec)
mysql> INSERT INTO fine (name, number_plate, violation, date_violation, date_payment) VALUES
('Яковлев Г.Р.', 'М701АА', 'Превышение скорости(от 20 до 40)', '2020-01-12', '2020-01-22'),
('Баранов П.Е.', 'Р523ВТ', 'Превышение скорости(от 40 до 60)', '2020-02-14', '2020-03-06'),
('Яковлев Г.Р.', 'Т330ТТ', 'Проезд на запрещающий сигнал', '2020-03-03', '2020-03-23');
Query OK, 3 rows affected (0.03 sec)
Records: 3 Duplicates: 0 Warnings: 0
mysql> SELECT * FROM payment;
Empty set (0.00 sec)
mysql> INSERT INTO payment (name, number_plate, violation, date_violation, date_payment) VALUES ('Яковлев Г.Р.', 'М701АА', 'Превышение скорости(от 20 до 40)', '2020-01-
12', '2020-01-22'), ('Баранов П.Е.', 'Р523ВТ', 'Превышение скорости(от 40 до 60)', '2020-02-14', '2020-03-06'), ('Яковлев Г.Р.', 'Т330ТТ', 'Проезд на запрещающий сигнал
', '2020-03-03', '2020-03-23');
Query OK, 3 rows affected (0.11 sec)
Records: 3 Duplicates: 0 Warnings: 0
mysql> SELECT * FROM payment;
+------------+-----------------------+--------------+--------------------------------------------------------+----------------+--------------+
| payment_id | name         | number_plate | violation                       | date_violation | date_payment |
+------------+-----------------------+--------------+--------------------------------------------------------+----------------+--------------+
|     1 | Яковлев Г.Р.     | М701АА   | Превышение скорости(от 20 до 40)           | 2020-01-12   | 2020-01-22 |
|     2 | Баранов П.Е.     | Р523ВТ   | Превышение скорости(от 40 до 60)           | 2020-02-14   | 2020-03-06 |
|     3 | Яковлев Г.Р.     | Т330ТТ   | Проезд на запрещающий сигнал             | 2020-03-03   | 2020-03-23 |
+------------+-----------------------+--------------+--------------------------------------------------------+----------------+--------------+
3 rows in set (0.00 sec)
mysql> SELECT * FROM fine;
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
| fine_id | name          | number_plate | violation                       | sum_fine | date_violation | date_payment |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
|   1 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 500.00 | 2020-01-12   | 2020-01-17 |
|   2 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-01-14   | 2020-02-27 |
|   3 | Яковлев Г.Р.      | Т330ТТ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-23   | 2020-02-23 |
|   4 | Яковлев Г.Р.      | М701АА   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-12   | NULL     |
|   5 | Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-02-01   | NULL     |
|   6 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 2000.00 | 2020-02-14   | NULL     |
|   7 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 2000.00 | 2020-02-23   | NULL     |
|   8 | Яковлев Г.Р.      | Т330ТТ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-03-03   | NULL     |
|   9 | Яковлев Г.Р.      | М701АА   | Превышение скорости(от 20 до 40)           |   NULL | 2020-01-12   | 2020-01-22 |
|   10 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           |   NULL | 2020-02-14   | 2020-03-06 |
|   11 | Яковлев Г.Р.      | Т330ТТ   | Проезд на запрещающий сигнал             |   NULL | 2020-03-03   | 2020-03-23 |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
11 rows in set (0.00 sec)
mysql> DELETE FROM fine WHERE sum_fine IS Null;
Query OK, 3 rows affected (0.03 sec)
mysql> SELECT * FROM fine;
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
| fine_id | name          | number_plate | violation                       | sum_fine | date_violation | date_payment |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
|   1 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 500.00 | 2020-01-12   | 2020-01-17 |
|   2 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-01-14   | 2020-02-27 |
|   3 | Яковлев Г.Р.      | Т330ТТ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-23   | 2020-02-23 |
|   4 | Яковлев Г.Р.      | М701АА   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-12   | NULL     |
|   5 | Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-02-01   | NULL     |
|   6 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 2000.00 | 2020-02-14   | NULL     |
|   7 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 2000.00 | 2020-02-23   | NULL     |
|   8 | Яковлев Г.Р.      | Т330ТТ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-03-03   | NULL     |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
8 rows in set (0.01 sec)
Query OK, 3 rows affected (0.07 sec)
Rows matched: 3 Changed: 3 Warnings: 0
mysql> SELECT * FROM fine;
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
| fine_id | name          | number_plate | violation                       | sum_fine | date_violation | date_payment |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
|   1 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 500.00 | 2020-01-12   | 2020-01-17 |
|   2 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-01-14   | 2020-02-27 |
|   3 | Яковлев Г.Р.      | Т330ТТ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-23   | 2020-02-23 |
|   4 | Яковлев Г.Р.      | М701АА   | Превышение скорости(от 20 до 40)           | 250.00 | 2020-01-12   | 2020-01-22 |
|   5 | Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-02-01   | NULL     |
|   6 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 2000.00 | 2020-02-14   | 2020-03-06 |
|   7 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 2000.00 | 2020-02-23   | NULL     |
|   8 | Яковлев Г.Р.      | Т330ТТ   | Проезд на запрещающий сигнал             | 500.00 | 2020-03-03   | 2020-03-23 |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
8 rows in set (0.00 sec)
Task:
Создать новую таблицу back_payment, куда внести информацию о неоплаченных штрафах (Фамилию и инициалы водителя, номер машины, нарушение, сумму штрафа и дату нарушения) из таблицы fine.
# Написание Sql запросов.
Decision:
mysql> CREATE TABLE back_payment AS
SELECT name, number_plate, violation, sum_fine, date_violation
FROM fine
WHERE date_payment IS NULL;
Query OK, 2 rows affected (0.43 sec)
Records: 2 Duplicates: 0 Warnings: 0
mysql> SELECT * FROM back_payment;
+-------------------------+--------------+--------------------------------------------------------+----------+----------------+
| name          | number_plate | violation                       | sum_fine | date_violation |
+-------------------------+--------------+--------------------------------------------------------+----------+----------------+
| Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-02-01   |
| Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 2000.00 | 2020-02-23   |
+-------------------------+--------------+--------------------------------------------------------+----------+----------------+
2 rows in set (0.00 sec)
Task:
Удалить из таблицы fine информацию о нарушениях, совершенных раньше 1 февраля 2020 года.
# Написание Sql запросов.
Decision:
mysql> SELECT * FROM fine;
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
| fine_id | name          | number_plate | violation                       | sum_fine | date_violation | date_payment |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
|   1 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 500.00 | 2020-01-12   | 2020-01-17 |
|   2 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 1000.00 | 2020-01-14   | 2020-02-27 |
|   3 | Яковлев Г.Р.      | Т330ТТ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-01-23   | 2020-02-23 |
|   4 | Яковлев Г.Р.      | М701АА   | Превышение скорости(от 20 до 40)           | 250.00 | 2020-01-12   | 2020-01-22 |
|   5 | Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-02-01   | NULL     |
|   6 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 2000.00 | 2020-02-14   | 2020-03-06 |
|   7 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 2000.00 | 2020-02-23   | NULL     |
|   8 | Яковлев Г.Р.      | Т330ТТ   | Проезд на запрещающий сигнал             | 500.00 | 2020-03-03   | 2020-03-23 |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
8 rows in set (0.00 sec)
mysql> DELETE FROM fine
WHERE date_violation < '2020-02-01';
Query OK, 4 rows affected (0.13 sec)
mysql> SELECT * FROM fine;
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
| fine_id | name          | number_plate | violation                       | sum_fine | date_violation | date_payment |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
|   5 | Колесов С.П.      | К892АХ   | Превышение скорости(от 20 до 40)           | 500.00 | 2020-02-01   | NULL     |
|   6 | Баранов П.Е.      | Р523ВТ   | Превышение скорости(от 40 до 60)           | 2000.00 | 2020-02-14   | 2020-03-06 |
|   7 | Абрамова К.А.     | О111АВ   | Проезд на запрещающий сигнал             | 2000.00 | 2020-02-23   | NULL     |
|   8 | Яковлев Г.Р.      | Т330ТТ   | Проезд на запрещающий сигнал             | 500.00 | 2020-03-03   | 2020-03-23 |
+---------+-------------------------+--------------+--------------------------------------------------------+----------+----------------+--------------+
4 rows in set (0.00 sec)
